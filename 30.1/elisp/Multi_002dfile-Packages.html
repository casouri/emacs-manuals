<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 30.1.

Copyright Â© 1990-1996, 1998-2025 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Multi-file Packages (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Multi-file Packages (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Multi-file Packages (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Packaging.html" rel="up" title="Packaging">
<link href="Package-Archives.html" rel="next" title="Package Archives">
<link href="Simple-Packages.html" rel="prev" title="Simple Packages">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Multi_002dfile-Packages">
<div class="nav-panel">
<p>
Next: <a href="Package-Archives.html" accesskey="n" rel="next">Creating and Maintaining Package Archives</a>, Previous: <a href="Simple-Packages.html" accesskey="p" rel="prev">Simple Packages</a>, Up: <a href="Packaging.html" accesskey="u" rel="up">Preparing Lisp code for distribution</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Multi_002dfile-Packages-1"><span>44.3 Multi-file Packages<a class="copiable-link" href="#Multi_002dfile-Packages-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-multi_002dfile-package"></a>

<p>A multi-file package is less convenient to create than a single-file
package, but it offers more features: it can include multiple Emacs
Lisp files, an Info manual, and other file types (such as images).
</p>
<p>Prior to installation, a multi-file package is stored in a package
archive as a tar file.  The tar file must be named
<samp class="file"><var class="var">name</var>-<var class="var">version</var>.tar</samp>, where <var class="var">name</var> is the package
name and <var class="var">version</var> is the version number.  Its contents, once
extracted, must all appear in a directory named
<samp class="file"><var class="var">name</var>-<var class="var">version</var></samp>, the <em class="dfn">content directory</em>
(see <a class="pxref" href="Packaging-Basics.html">Packaging Basics</a>).  Files may also extract into
subdirectories of the content directory.
</p>
<p>One of the files in the content directory must be named
<samp class="file"><var class="var">name</var>-pkg.el</samp>.  It must contain a single Lisp form,
consisting of a call to the function <code class="code">define-package</code>, described
below.  This defines the package&rsquo;s attributes: version, brief
description, and requirements.
</p>
<p>For example, if we distribute version 1.3 of the superfrobnicator as
a multi-file package, the tar file would be
<samp class="file">superfrobnicator-1.3.tar</samp>.  Its contents would extract into the
directory <samp class="file">superfrobnicator-1.3</samp>, and one of these would be the
file <samp class="file">superfrobnicator-pkg.el</samp>.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-define_002dpackage"><span class="category-def">Function: </span><span><strong class="def-name">define-package</strong> <var class="def-var-arguments">name version &amp;optional docstring requirements</var><a class="copiable-link" href="#index-define_002dpackage"> &para;</a></span></dt>
<dd><p>This function defines a package.  <var class="var">name</var> is the package name, a
string.  <var class="var">version</var> is the version, as a string of a form that can
be understood by the function <code class="code">version-to-list</code>.  <var class="var">docstring</var>
is the brief description.
</p>
<p><var class="var">requirements</var> is a list of required packages and their versions.
Each element in this list should have the form <code class="code">(<var class="var">dep-name</var>
<var class="var">dep-version</var>)</code>, where <var class="var">dep-name</var> is a symbol whose name is the
dependency&rsquo;s package name, and <var class="var">dep-version</var> is the dependency&rsquo;s
version (a string).  The special value &lsquo;<samp class="samp">emacs</samp>&rsquo; means that the
package depends on the given version of Emacs.
</p></dd></dl>

<p>If the content directory contains a file named <samp class="file">README</samp>, this
file is used as the long description (overriding any &lsquo;<samp class="samp">;;;
Commentary:</samp>&rsquo; section).
</p>
<p>If the content directory contains a file named <samp class="file">dir</samp>, this is
assumed to be an Info directory file made with <code class="command">install-info</code>.
See <a data-manual="texinfo" href="https://www.gnu.org/software/texinfo/manual/texinfo/html_node/Invoking-install_002dinfo.html#Invoking-install_002dinfo">Invoking
install-info</a> in <cite class="cite">Texinfo</cite>.  The relevant Info files should also
be present in the content directory.  In this case, Emacs will
automatically add the content directory to <code class="code">Info-directory-list</code>
when the package is activated.
</p>
<p>Do not include any <samp class="file">.elc</samp> files in the package.  Those are
created when the package is installed.  Note that there is no way to
control the order in which files are byte-compiled.
</p>
<p>Do not include any file named <samp class="file"><var class="var">name</var>-autoloads.el</samp>.  This
file is reserved for the package&rsquo;s autoload definitions
(see <a class="pxref" href="Packaging-Basics.html">Packaging Basics</a>).  It is created automatically when the
package is installed, by searching all the Lisp files in the package
for autoload magic comments.
</p>
<p>If the multi-file package contains auxiliary data files (such as
images), the package&rsquo;s Lisp code can refer to these files via the
variable <code class="code">load-file-name</code> (see <a class="pxref" href="Loading.html">Loading</a>).  Here is an example:
</p>
<div class="example smallexample">
<pre class="example-preformatted">(defconst superfrobnicator-base (file-name-directory load-file-name))

(defun superfrobnicator-fetch-image (file)
  (expand-file-name file superfrobnicator-base))
</pre></div>

<a class="index-entry-id" id="index-_002eelpaignore-file"></a>
<p>If your package contains files that you don&rsquo;t wish to distribute to
users (e.g. regression tests), you can add them to an
<samp class="file">.elpaignore</samp> file.  In this file, each line lists a file or a
wildcard matching files; those files should be ignored when producing
your package&rsquo;s tarball on ELPA (see <a class="pxref" href="Package-Archives.html">Creating and Maintaining Package Archives</a>).  (ELPA
will pass this file to the <code class="command">tar</code> command via the <samp class="option">-X</samp>
command-line option, when it prepares the package for download.)
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Package-Archives.html">Creating and Maintaining Package Archives</a>, Previous: <a href="Simple-Packages.html">Simple Packages</a>, Up: <a href="Packaging.html">Preparing Lisp code for distribution</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
