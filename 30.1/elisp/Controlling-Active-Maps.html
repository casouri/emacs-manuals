<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 30.1.

Copyright Â© 1990-1996, 1998-2025 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Controlling Active Maps (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Controlling Active Maps (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Controlling Active Maps (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Keymaps.html" rel="up" title="Keymaps">
<link href="Key-Lookup.html" rel="next" title="Key Lookup">
<link href="Searching-Keymaps.html" rel="prev" title="Searching Keymaps">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Controlling-Active-Maps">
<div class="nav-panel">
<p>
Next: <a href="Key-Lookup.html" accesskey="n" rel="next">Key Lookup</a>, Previous: <a href="Searching-Keymaps.html" accesskey="p" rel="prev">Searching the Active Keymaps</a>, Up: <a href="Keymaps.html" accesskey="u" rel="up">Keymaps</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Controlling-the-Active-Keymaps"><span>23.9 Controlling the Active Keymaps<a class="copiable-link" href="#Controlling-the-Active-Keymaps"> &para;</a></span></h3>
<a class="index-entry-id" id="index-active-keymap_002c-controlling"></a>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-global_002dmap"><span class="category-def">Variable: </span><span><strong class="def-name">global-map</strong><a class="copiable-link" href="#index-global_002dmap"> &para;</a></span></dt>
<dd><p>This variable contains the default global keymap that maps Emacs
keyboard input to commands.  The global keymap is normally this
keymap.  The default global keymap is a full keymap that binds
<code class="code">self-insert-command</code> to all of the printing characters.
</p>
<p>It is normal practice to change the bindings in the global keymap, but you
should not assign this variable any value other than the keymap it starts
out with.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-current_002dglobal_002dmap"><span class="category-def">Function: </span><span><strong class="def-name">current-global-map</strong><a class="copiable-link" href="#index-current_002dglobal_002dmap"> &para;</a></span></dt>
<dd><p>This function returns the current global keymap.  This is the same as
the value of <code class="code">global-map</code> unless you change one or the other.
The return value is a reference, not a copy; if you use
<code class="code">keymap-set</code> or other functions on it you will alter global
bindings.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(current-global-map)
&rArr; (keymap [set-mark-command beginning-of-line ...
            delete-backward-char])
</pre></div></div>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-current_002dlocal_002dmap"><span class="category-def">Function: </span><span><strong class="def-name">current-local-map</strong><a class="copiable-link" href="#index-current_002dlocal_002dmap"> &para;</a></span></dt>
<dd><p>This function returns the current buffer&rsquo;s local keymap, or <code class="code">nil</code>
if it has none.  In the following example, the keymap for the
<samp class="file">*scratch*</samp> buffer (using Lisp Interaction mode) is a sparse keymap
in which the entry for <kbd class="key">ESC</kbd>, <abbr class="acronym">ASCII</abbr> code 27, is another sparse
keymap.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(current-local-map)
&rArr; (keymap
    (10 . eval-print-last-sexp)
    (9 . lisp-indent-line)
    (127 . backward-delete-char-untabify)
</pre></div><div class="group"><pre class="example-preformatted">    (27 keymap
        (24 . eval-defun)
        (17 . indent-sexp)))
</pre></div></div>
</dd></dl>

<p><code class="code">current-local-map</code> returns a reference to the local keymap, not
a copy of it; if you use <code class="code">keymap-set</code> or other functions on it
you will alter local bindings.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-current_002dminor_002dmode_002dmaps"><span class="category-def">Function: </span><span><strong class="def-name">current-minor-mode-maps</strong><a class="copiable-link" href="#index-current_002dminor_002dmode_002dmaps"> &para;</a></span></dt>
<dd><p>This function returns a list of the keymaps of currently enabled minor modes.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-use_002dglobal_002dmap"><span class="category-def">Function: </span><span><strong class="def-name">use-global-map</strong> <var class="def-var-arguments">keymap</var><a class="copiable-link" href="#index-use_002dglobal_002dmap"> &para;</a></span></dt>
<dd><p>This function makes <var class="var">keymap</var> the new current global keymap.  It
returns <code class="code">nil</code>.
</p>
<p>It is very unusual to change the global keymap.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-use_002dlocal_002dmap"><span class="category-def">Function: </span><span><strong class="def-name">use-local-map</strong> <var class="def-var-arguments">keymap</var><a class="copiable-link" href="#index-use_002dlocal_002dmap"> &para;</a></span></dt>
<dd><p>This function makes <var class="var">keymap</var> the new local keymap of the current
buffer.  If <var class="var">keymap</var> is <code class="code">nil</code>, then the buffer has no local
keymap.  <code class="code">use-local-map</code> returns <code class="code">nil</code>.  Most major mode
commands use this function.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-minor_002dmode_002dmap_002dalist"><span class="category-def">Variable: </span><span><strong class="def-name">minor-mode-map-alist</strong><a class="copiable-link" href="#index-minor_002dmode_002dmap_002dalist"> &para;</a></span></dt>
<dd><a class="anchor" id="Definition-of-minor_002dmode_002dmap_002dalist"></a><p>This variable is an alist describing keymaps that may or may not be
active according to the values of certain variables.  Its elements look
like this:
</p>
<div class="example">
<pre class="example-preformatted">(<var class="var">variable</var> . <var class="var">keymap</var>)
</pre></div>

<p>The keymap <var class="var">keymap</var> is active whenever <var class="var">variable</var> has a
non-<code class="code">nil</code> value.  Typically <var class="var">variable</var> is the variable that
enables or disables a minor mode.  See <a class="xref" href="Keymaps-and-Minor-Modes.html">Keymaps and Minor Modes</a>.
</p>
<p>Note that elements of <code class="code">minor-mode-map-alist</code> do not have the same
structure as elements of <code class="code">minor-mode-alist</code>.  The map must be the
<small class="sc">CDR</small> of the element; a list with the map as the second element will
not do.  The <small class="sc">CDR</small> can be either a keymap (a list) or a symbol whose
function definition is a keymap.
</p>
<p>When more than one minor mode keymap is active, the earlier one in
<code class="code">minor-mode-map-alist</code> takes priority.  But you should design
minor modes so that they don&rsquo;t interfere with each other.  If you do
this properly, the order will not matter.
</p>
<p>See <a class="ref" href="Keymaps-and-Minor-Modes.html">Keymaps and Minor Modes</a>, for more information about minor
modes.  See also <code class="code">minor-mode-key-binding</code> (see <a class="pxref" href="Functions-for-Key-Lookup.html">Functions for Key Lookup</a>).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-minor_002dmode_002doverriding_002dmap_002dalist"><span class="category-def">Variable: </span><span><strong class="def-name">minor-mode-overriding-map-alist</strong><a class="copiable-link" href="#index-minor_002dmode_002doverriding_002dmap_002dalist"> &para;</a></span></dt>
<dd><p>This variable allows major modes to override the key bindings for
particular minor modes.  The elements of this alist look like the
elements of <code class="code">minor-mode-map-alist</code>: <code class="code">(<var class="var">variable</var>
. <var class="var">keymap</var>)</code>.
</p>
<p>If a variable appears as an element of
<code class="code">minor-mode-overriding-map-alist</code>, the map specified by that
element totally replaces any map specified for the same variable in
<code class="code">minor-mode-map-alist</code>.
</p>
<p><code class="code">minor-mode-overriding-map-alist</code> is automatically buffer-local in
all buffers.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-overriding_002dlocal_002dmap"><span class="category-def">Variable: </span><span><strong class="def-name">overriding-local-map</strong><a class="copiable-link" href="#index-overriding_002dlocal_002dmap"> &para;</a></span></dt>
<dd><p>If non-<code class="code">nil</code>, this variable holds a keymap to use instead of the
buffer&rsquo;s local keymap, any text property or overlay keymaps, and any
minor mode keymaps.  This keymap, if specified, overrides all other
maps that would have been active, except for the current global map.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-overriding_002dterminal_002dlocal_002dmap"><span class="category-def">Variable: </span><span><strong class="def-name">overriding-terminal-local-map</strong><a class="copiable-link" href="#index-overriding_002dterminal_002dlocal_002dmap"> &para;</a></span></dt>
<dd><p>If non-<code class="code">nil</code>, this variable holds a keymap to use instead of
<code class="code">overriding-local-map</code>, the buffer&rsquo;s local keymap, text property
or overlay keymaps, and all the minor mode keymaps.
</p>
<p>This variable is always local to the current terminal and cannot be
buffer-local.  See <a class="xref" href="Multiple-Terminals.html">Multiple Terminals</a>.  It is used to implement
incremental search mode.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-overriding_002dlocal_002dmap_002dmenu_002dflag"><span class="category-def">Variable: </span><span><strong class="def-name">overriding-local-map-menu-flag</strong><a class="copiable-link" href="#index-overriding_002dlocal_002dmap_002dmenu_002dflag"> &para;</a></span></dt>
<dd><p>If this variable is non-<code class="code">nil</code>, the value of
<code class="code">overriding-local-map</code> or <code class="code">overriding-terminal-local-map</code> can
affect the display of the menu bar.  The default value is <code class="code">nil</code>, so
those map variables have no effect on the menu bar.
</p>
<p>Note that these two map variables do affect the execution of key
sequences entered using the menu bar, even if they do not affect the
menu bar display.  So if a menu bar key sequence comes in, you should
clear the variables before looking up and executing that key sequence.
Modes that use the variables would typically do this anyway; normally
they respond to events that they do not handle by &ldquo;unreading&rdquo; them and
exiting.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-special_002devent_002dmap"><span class="category-def">Variable: </span><span><strong class="def-name">special-event-map</strong><a class="copiable-link" href="#index-special_002devent_002dmap"> &para;</a></span></dt>
<dd><p>This variable holds a keymap for special events.  If an event type has a
binding in this keymap, then it is special, and the binding for the
event is run directly by <code class="code">read-event</code>.  See <a class="xref" href="Special-Events.html">Special Events</a>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-emulation_002dmode_002dmap_002dalists"><span class="category-def">Variable: </span><span><strong class="def-name">emulation-mode-map-alists</strong><a class="copiable-link" href="#index-emulation_002dmode_002dmap_002dalists"> &para;</a></span></dt>
<dd><p>This variable holds a list of keymap alists to use for emulation
modes.  It is intended for modes or packages using multiple minor-mode
keymaps.  Each element is a keymap alist which has the same format and
meaning as <code class="code">minor-mode-map-alist</code>, or a symbol with a variable
binding which is such an alist.  The active keymaps in each alist
are used before <code class="code">minor-mode-map-alist</code> and
<code class="code">minor-mode-overriding-map-alist</code>.
</p></dd></dl>

<a class="index-entry-id" id="index-transient-keymap"></a>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-set_002dtransient_002dmap"><span class="category-def">Function: </span><span><strong class="def-name">set-transient-map</strong> <var class="def-var-arguments">keymap &amp;optional keep-pred on-exit message timeout</var><a class="copiable-link" href="#index-set_002dtransient_002dmap"> &para;</a></span></dt>
<dd><p>This function adds <var class="var">keymap</var> as a <em class="dfn">transient</em> keymap, which
takes precedence over other keymaps for one (or more) subsequent keys.
</p>
<p>Normally, <var class="var">keymap</var> is used just once, to look up the very next key.
If the optional argument <var class="var">keep-pred</var> is <code class="code">t</code>, the map stays
active as long as the user types keys defined in <var class="var">keymap</var>; when the
user types a key that is not in <var class="var">keymap</var>, the transient keymap is
deactivated and normal key lookup continues for that key.
</p>
<p>The <var class="var">keep-pred</var> argument can also be a function.  In that case, the
function is called with no arguments, prior to running each command,
while <var class="var">keymap</var> is active; it should return non-<code class="code">nil</code> if
<var class="var">keymap</var> should stay active.
</p>
<p>The optional argument <var class="var">on-exit</var>, if non-<code class="code">nil</code>, specifies a
function that is called, with no arguments, after <var class="var">keymap</var> is
deactivated.
</p>
<p>The optional argument <var class="var">message</var> specifies the message to display
after activating the transient map.  If <var class="var">message</var> is a string, it
is the format string for the message, and any &lsquo;<samp class="samp">%k</samp>&rsquo; specifier in
that string is replaced with the list of keys from the transient map.
Any other non-<code class="code">nil</code> value of <var class="var">message</var> stands for the default
message format &lsquo;<samp class="samp">Repeat with %k</samp>&rsquo;.
</p>
<a class="index-entry-id" id="index-set_002dtransient_002dmap_002dtimeout"></a>
<p>If the optional argument <var class="var">timeout</var> is non-<code class="code">nil</code>, it should be
a number that specifies how many seconds of idle time to wait before
deactivating <var class="var">keymap</var>.  The value of the variable
<code class="code">set-transient-map-timeout</code>, if non-<code class="code">nil</code>, overrides the
value of this argument.
</p>
<p>This function works by adding and removing <var class="var">keymap</var> from the
variable <code class="code">overriding-terminal-local-map</code>, which takes precedence
over all other active keymaps (see <a class="pxref" href="Searching-Keymaps.html">Searching the Active Keymaps</a>).
</p></dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Key-Lookup.html">Key Lookup</a>, Previous: <a href="Searching-Keymaps.html">Searching the Active Keymaps</a>, Up: <a href="Keymaps.html">Keymaps</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
