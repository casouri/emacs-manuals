<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 29.3.

Copyright Â© 1990-1996, 1998-2024 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>JSONRPC Overview (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="JSONRPC Overview (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="JSONRPC Overview (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="JSONRPC.html" rel="up" title="JSONRPC">
<link href="Process_002dbased-JSONRPC-connections.html" rel="next" title="Process-based JSONRPC connections">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="JSONRPC-Overview">
<div class="nav-panel">
<p>
Next: <a href="Process_002dbased-JSONRPC-connections.html" accesskey="n" rel="next">Process-based JSONRPC connections</a>, Up: <a href="JSONRPC.html" accesskey="u" rel="up">JSONRPC communication</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Overview-1"><span>33.32.1 Overview<a class="copiable-link" href="#Overview-1"> &para;</a></span></h4>

<p>Quoting from the <a class="uref" href="https://www.jsonrpc.org/">spec</a>, JSONRPC &quot;is
transport agnostic in that the concepts can be used within the same
process, over sockets, over http, or in many various message passing
environments.&quot;
</p>
<a class="index-entry-id" id="index-jsonrpc_002dconnection"></a>
<p>To model this agnosticism, the <code class="code">jsonrpc</code> library uses objects of
a <code class="code">jsonrpc-connection</code> class, which represent a connection to a
remote JSON endpoint (for details on Emacs&rsquo;s object system,
see <a data-manual="eieio" href="https://www.gnu.org/software/emacs/manual/html_node/eieio/index.html#Top">EIEIO</a> in <cite class="cite">EIEIO</cite>).  In modern object-oriented parlance,
this class is &ldquo;abstract&rdquo;, i.e. the actual class of a useful
connection object is always a subclass of <code class="code">jsonrpc-connection</code>.
Nevertheless, we can define two distinct APIs around the
<code class="code">jsonrpc-connection</code> class:
</p>
<a class="index-entry-id" id="index-JSONRPC-application-interfaces"></a>
<ol class="enumerate">
<li> A user interface for building JSONRPC applications

<a class="index-entry-id" id="index-_003arequest_002ddispatcher"></a>
<a class="index-entry-id" id="index-_003anotification_002ddispatcher"></a>
<a class="index-entry-id" id="index-jsonrpc_002dnotify"></a>
<a class="index-entry-id" id="index-jsonrpc_002drequest"></a>
<a class="index-entry-id" id="index-jsonrpc_002dasync_002drequest"></a>
<p>In this scenario, the JSONRPC application selects a concrete subclass
of <code class="code">jsonrpc-connection</code>, and proceeds to create objects of that
subclass using <code class="code">make-instance</code>.  To initiate a contact to the
remote endpoint, the JSONRPC application passes this object to the
functions <code class="code">jsonrpc-notify</code>, <code class="code">jsonrpc-request</code>, and/or
<code class="code">jsonrpc-async-request</code>.  For handling remotely initiated
contacts, which generally come in asynchronously, the instantiation
should include <code class="code">:request-dispatcher</code> and
<code class="code">:notification-dispatcher</code> initargs, which are both functions of
3 arguments: the connection object; a symbol naming the JSONRPC method
invoked remotely; and a JSONRPC <code class="code">params</code> object.
</p>
<a class="index-entry-id" id="index-jsonrpc_002derror"></a>
<p>The function passed as <code class="code">:request-dispatcher</code> is responsible for
handling the remote endpoint&rsquo;s requests, which expect a reply from the
local endpoint (in this case, the program you&rsquo;re building).  Inside
that function, you may either return locally (a normal return) or
non-locally (an error return).  A local return value must be a Lisp
object that can be serialized as JSON (see <a class="pxref" href="Parsing-JSON.html">Parsing and generating JSON values</a>).  This
determines a success response, and the object is forwarded to the
server as the JSONRPC <code class="code">result</code> object.  A non-local return,
achieved by calling the function <code class="code">jsonrpc-error</code>, causes an error
response to be sent to the server.  The details of the accompanying
JSONRPC <code class="code">error</code> are filled out with whatever was passed to
<code class="code">jsonrpc-error</code>.  A non-local return triggered by an unexpected
error of any other type also causes an error response to be sent
(unless you have set <code class="code">debug-on-error</code>, in which case this calls
the Lisp debugger, see <a class="pxref" href="Error-Debugging.html">Entering the Debugger on an Error</a>).
</p>
</li><li> A inheritance interface for building JSONRPC transport implementations

<p>In this scenario, <code class="code">jsonrpc-connection</code> is subclassed to implement
a different underlying transport strategy (for details on how to
subclass, see <a data-manual="eieio" href="https://www.gnu.org/software/emacs/manual/html_node/eieio/Inheritance.html#Inheritance">Inheritance</a>.).  Users of the
application-building interface can then instantiate objects of this
concrete class (using the <code class="code">make-instance</code> function) and connect
to JSONRPC endpoints using that strategy.
</p>
<p>This API has mandatory and optional parts.
</p>
<a class="index-entry-id" id="index-jsonrpc_002dconnection_002dsend"></a>
<p>To allow its users to initiate JSONRPC contacts (notifications or
requests) or reply to endpoint requests, the subclass must have an
implementation of the <code class="code">jsonrpc-connection-send</code> method.
</p>
<a class="index-entry-id" id="index-jsonrpc_002dconnection_002dreceive"></a>
<p>Likewise, for handling the three types of remote contacts (requests,
notifications, and responses to local requests), the transport
implementation must arrange for the function
<code class="code">jsonrpc-connection-receive</code> to be called after noticing a new
JSONRPC message on the wire (whatever that &quot;wire&quot; may be).
</p>
<a class="index-entry-id" id="index-jsonrpc_002dshutdown"></a>
<a class="index-entry-id" id="index-jsonrpc_002drunning_002dp"></a>
<p>Finally, and optionally, the <code class="code">jsonrpc-connection</code> subclass should
implement the <code class="code">jsonrpc-shutdown</code> and <code class="code">jsonrpc-running-p</code>
methods if these concepts apply to the transport.  If they do, then
any system resources (e.g. processes, timers, etc.) used to listen for
messages on the wire should be released in <code class="code">jsonrpc-shutdown</code>,
i.e. they should only be needed while <code class="code">jsonrpc-running-p</code> is
non-<code class="code">nil</code>.
</p>
</li></ol>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Process_002dbased-JSONRPC-connections.html">Process-based JSONRPC connections</a>, Up: <a href="JSONRPC.html">JSONRPC communication</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
