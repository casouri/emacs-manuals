<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 29.3.

Copyright Â© 1990-1996, 1998-2024 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Coding Conventions (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Coding Conventions (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Coding Conventions (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Tips.html" rel="up" title="Tips">
<link href="Key-Binding-Conventions.html" rel="next" title="Key Binding Conventions">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Coding-Conventions">
<div class="nav-panel">
<p>
Next: <a href="Key-Binding-Conventions.html" accesskey="n" rel="next">Key Binding Conventions</a>, Up: <a href="Tips.html" accesskey="u" rel="up">Tips and Conventions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Emacs-Lisp-Coding-Conventions"><span>D.1 Emacs Lisp Coding Conventions<a class="copiable-link" href="#Emacs-Lisp-Coding-Conventions"> &para;</a></span></h3>

<a class="index-entry-id" id="index-coding-conventions-in-Emacs-Lisp"></a>
<a class="index-entry-id" id="index-conventions-for-Emacs-Lisp-programs"></a>
<p>Here are conventions that you should follow when writing Emacs Lisp
code intended for widespread use:
</p>
<ul class="itemize mark-bullet">
<li>Simply loading a package should not change Emacs&rsquo;s editing behavior.
Include a command or commands to enable and disable the feature,
or to invoke it.

<p>This convention is mandatory for any file that includes custom
definitions.  If fixing such a file to follow this convention requires
an incompatible change, go ahead and make the incompatible change;
don&rsquo;t postpone it.
</p>
</li><li>You should choose a short word to distinguish your program from other
Lisp programs.  The names of all global symbols in your program, that
is the names of variables, constants, and functions, should begin with
that chosen prefix.  Separate the prefix from the rest of the name
with a hyphen, &lsquo;<samp class="samp">-</samp>&rsquo;.  This practice helps avoid name conflicts,
since all global variables in Emacs Lisp share the same name space,
and all functions share another name space<a class="footnote" id="DOCF33" href="#FOOT33"><sup>33</sup></a>.  Use two hyphens to separate prefix and name if the symbol is
not meant to be used by other packages.

<p>Occasionally, for a command name intended for users to use, it is more
convenient if some words come before the package&rsquo;s name prefix.  For
example, it is our convention to have commands that list objects named
as &lsquo;<samp class="samp">list-<var class="var">something</var></samp>&rsquo;, e.g., a package called &lsquo;<samp class="samp">frob</samp>&rsquo;
could have a command &lsquo;<samp class="samp">list-frobs</samp>&rsquo;, when its other global symbols
begin with &lsquo;<samp class="samp">frob-</samp>&rsquo;.  Also, constructs that define functions,
variables, etc., work better if they start with &lsquo;<samp class="samp">define-</samp>&rsquo;, so put
the name prefix later on in the name.
</p>
<p>This recommendation applies even to names for traditional Lisp
primitives that are not primitives in Emacs Lisp&mdash;such as
<code class="code">copy-list</code>.  Believe it or not, there is more than one plausible
way to define <code class="code">copy-list</code>.  Play it safe; append your name prefix
to produce a name like <code class="code">foo-copy-list</code> or <code class="code">mylib-copy-list</code>
instead.
</p>
<p>If you write a function that you think ought to be added to Emacs under
a certain name, such as <code class="code">twiddle-files</code>, don&rsquo;t call it by that name
in your program.  Call it <code class="code">mylib-twiddle-files</code> in your program,
and send mail to &lsquo;<samp class="samp">bug-gnu-emacs@gnu.org</samp>&rsquo; suggesting we add
it to Emacs.  If and when we do, we can change the name easily enough.
</p>
<p>If one prefix is insufficient, your package can use two or three
alternative common prefixes, so long as they make sense.
</p>
</li><li>We recommend enabling <code class="code">lexical-binding</code> in new code, and
converting existing Emacs Lisp code to enable <code class="code">lexical-binding</code>
if it doesn&rsquo;t already.  See <a class="xref" href="Using-Lexical-Binding.html">Using Lexical Binding</a>.

</li><li>Put a call to <code class="code">provide</code> at the end of each separate Lisp file.
See <a class="xref" href="Named-Features.html">Features</a>.

</li><li>If a file requires certain other Lisp programs to be loaded
beforehand, then the comments at the beginning of the file should say
so.  Also, use <code class="code">require</code> to make sure they are loaded.
See <a class="xref" href="Named-Features.html">Features</a>.

</li><li>If a file <var class="var">foo</var> uses a macro defined in another file <var class="var">bar</var>,
but does not use any functions or variables defined in <var class="var">bar</var>, then
<var class="var">foo</var> should contain the following expression:

<div class="example">
<pre class="example-preformatted">(eval-when-compile (require '<var class="var">bar</var>))
</pre></div>

<p>This tells Emacs to load <var class="var">bar</var> just before byte-compiling
<var class="var">foo</var>, so that the macro definition is available during
compilation.  Using <code class="code">eval-when-compile</code> avoids loading <var class="var">bar</var>
when the compiled version of <var class="var">foo</var> is <em class="emph">used</em>.  It should be
called before the first use of the macro in the file.  See <a class="xref" href="Compiling-Macros.html">Macros and Byte Compilation</a>.
</p>
</li><li>Avoid loading additional libraries at run time unless they are really
needed.  If your file simply cannot work without some other library,
then just <code class="code">require</code> that library at the top-level and be done
with it.  But if your file contains several independent features, and
only one or two require the extra library, then consider putting
<code class="code">require</code> statements inside the relevant functions rather than at
the top-level.  Or use <code class="code">autoload</code> statements to load the extra
library when needed.  This way people who don&rsquo;t use those aspects of
your file do not need to load the extra library.

</li><li>If you need Common Lisp extensions, use the <code class="code">cl-lib</code> library
rather than the old <code class="code">cl</code> library.  The latter library is
deprecated and will be removed in a future version of Emacs.

</li><li>When defining a major mode, please follow the major mode
conventions.  See <a class="xref" href="Major-Mode-Conventions.html">Major Mode Conventions</a>.

</li><li>When defining a minor mode, please follow the minor mode
conventions.  See <a class="xref" href="Minor-Mode-Conventions.html">Conventions for Writing Minor Modes</a>.

</li><li>If the purpose of a function is to tell you whether a certain
condition is true or false, give the function a name that ends in
&lsquo;<samp class="samp">p</samp>&rsquo; (which stands for &ldquo;predicate&rdquo;).  If the name is one word,
add just &lsquo;<samp class="samp">p</samp>&rsquo;; if the name is multiple words, add &lsquo;<samp class="samp">-p</samp>&rsquo;.
Examples are <code class="code">framep</code> and <code class="code">frame-live-p</code>.  We recommend to
avoid using this <code class="code">-p</code> suffix in boolean variable names, unless
the variable is bound to a predicate function; instead, use a
<code class="code">-flag</code> suffix or names like <code class="code">is-foo</code>.

</li><li>If the purpose of a variable is to store a single function, give it a
name that ends in &lsquo;<samp class="samp">-function</samp>&rsquo;.  If the purpose of a variable is
to store a list of functions (i.e., the variable is a hook), please
follow the naming conventions for hooks.  See <a class="xref" href="Hooks.html">Hooks</a>.

</li><li><a class="index-entry-id" id="index-unloading-packages_002c-preparing-for"></a>
Using <code class="code">unload-feature</code> will undo the changes usually done by
loading a feature (like adding functions to hooks).  However, if
loading <var class="var">feature</var> does something unusual and more complex, you can
define a function named <code class="code"><var class="var">feature</var>-unload-function</code>, and make
it undo any such special changes.  <code class="code">unload-feature</code> will then
automatically run this function if it exists.  See <a class="xref" href="Unloading.html">Unloading</a>.

</li><li>It is a bad idea to define aliases for the Emacs primitives.  Normally
you should use the standard names instead.  The case where an alias
may be useful is where it facilitates backwards compatibility or
portability.

</li><li>If a package needs to define an alias or a new function for
compatibility with some other version of Emacs, name it with the package
prefix, not with the raw name with which it occurs in the other version.
Here is an example from Gnus, which provides many examples of such
compatibility issues.

<div class="example">
<pre class="example-preformatted">(defalias 'gnus-point-at-bol
  (if (fboundp 'point-at-bol)
      'point-at-bol
    'line-beginning-position))
</pre></div>

</li><li>Redefining or advising an Emacs primitive is a bad idea.  It may do
the right thing for a particular program, but there is no telling what
other programs might break as a result.

</li><li>It is likewise a bad idea for one Lisp package to advise a function in
another Lisp package (see <a class="pxref" href="Advising-Functions.html">Advising Emacs Lisp Functions</a>).

</li><li>Avoid using <code class="code">eval-after-load</code> and <code class="code">with-eval-after-load</code> in
libraries and packages (see <a class="pxref" href="Hooks-for-Loading.html">Hooks for Loading</a>).  This feature is
meant for personal customizations; using it in a Lisp program is
unclean, because it modifies the behavior of another Lisp file in a
way that&rsquo;s not visible in that file.  This is an obstacle for
debugging, much like advising a function in the other package.

</li><li>If a file does replace any of the standard functions or library
programs of Emacs, prominent comments at the beginning of the file
should say which functions are replaced, and how the behavior of the
replacements differs from that of the originals.

</li><li>Constructs that define a function or variable should be macros,
not functions, and their names should start with &lsquo;<samp class="samp">define-</samp>&rsquo;.
The macro should receive the name to be
defined as the first argument.  That will help various tools find the
definition automatically.  Avoid constructing the names in the macro
itself, since that would confuse these tools.

</li><li>In some other systems there is a convention of choosing variable names
that begin and end with &lsquo;<samp class="samp">*</samp>&rsquo;.  We don&rsquo;t use that convention in Emacs
Lisp, so please don&rsquo;t use it in your programs.  (Emacs uses such names
only for special-purpose buffers.)  People will find Emacs more
coherent if all libraries use the same conventions.

</li><li>The default file coding system for Emacs Lisp source files is UTF-8
(see <a class="pxref" href="Text-Representations.html">Text Representations</a>).  In the rare event that your program
contains characters which are <em class="emph">not</em> in UTF-8, you should specify
an appropriate coding system in the source file&rsquo;s &lsquo;<samp class="samp">-*-</samp>&rsquo; line or
local variables list.  See <a data-manual="emacs" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Variables.html#File-Variables">Local Variables in
Files</a> in <cite class="cite">The GNU Emacs Manual</cite>.

</li><li>Indent the file using the default indentation parameters.

</li><li>Don&rsquo;t make a habit of putting close-parentheses on lines by
themselves; Lisp programmers find this disconcerting.

</li><li>Please put a copyright notice and copying permission notice on the
file if you distribute copies.  See <a class="xref" href="Library-Headers.html">Conventional Headers for Emacs Libraries</a>.

</li><li>For variables holding (or functions returning) a file or directory name,
avoid using <code class="code">path</code> in its name, preferring <code class="code">file</code>,
<code class="code">file-name</code>, or <code class="code">directory</code> instead, since Emacs follows the
GNU convention to use the term <em class="emph">path</em> only for search paths,
which are lists of directory names.

</li></ul>

</div>
<div class="footnotes-segment">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT33" href="#DOCF33">(33)</a></h5>
<p>The benefits of a
Common Lisp-style package system are considered not to outweigh the
costs.</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Key-Binding-Conventions.html">Key Binding Conventions</a>, Up: <a href="Tips.html">Tips and Conventions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
