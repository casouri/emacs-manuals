<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 29.3.

Copyright Â© 1990-1996, 1998-2024 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Customizing Keywords (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Customizing Keywords (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Customizing Keywords (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Font-Lock-Mode.html" rel="up" title="Font Lock Mode">
<link href="Other-Font-Lock-Variables.html" rel="next" title="Other Font Lock Variables">
<link href="Search_002dbased-Fontification.html" rel="prev" title="Search-based Fontification">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Customizing-Keywords">
<div class="nav-panel">
<p>
Next: <a href="Other-Font-Lock-Variables.html" accesskey="n" rel="next">Other Font Lock Variables</a>, Previous: <a href="Search_002dbased-Fontification.html" accesskey="p" rel="prev">Search-based Fontification</a>, Up: <a href="Font-Lock-Mode.html" accesskey="u" rel="up">Font Lock Mode</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Customizing-Search_002dBased-Fontification"><span>24.6.3 Customizing Search-Based Fontification<a class="copiable-link" href="#Customizing-Search_002dBased-Fontification"> &para;</a></span></h4>

<p>You can use <code class="code">font-lock-add-keywords</code> to add additional
search-based fontification rules to a major mode, and
<code class="code">font-lock-remove-keywords</code> to remove rules.  You can also
customize the <code class="code">font-lock-ignore</code> option to selectively disable
fontification rules for keywords that match certain criteria.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-font_002dlock_002dadd_002dkeywords"><span class="category-def">Function: </span><span><strong class="def-name">font-lock-add-keywords</strong> <var class="def-var-arguments">mode keywords &amp;optional how</var><a class="copiable-link" href="#index-font_002dlock_002dadd_002dkeywords"> &para;</a></span></dt>
<dd><p>This function adds highlighting <var class="var">keywords</var>, for the current buffer
or for major mode <var class="var">mode</var>.  The argument <var class="var">keywords</var> should be a
list with the same format as the variable <code class="code">font-lock-keywords</code>.
</p>
<p>If <var class="var">mode</var> is a symbol which is a major mode command name, such as
<code class="code">c-mode</code>, the effect is that enabling Font Lock mode in
<var class="var">mode</var> will add <var class="var">keywords</var> to <code class="code">font-lock-keywords</code>.
Calling with a non-<code class="code">nil</code> value of <var class="var">mode</var> is correct only in
your <samp class="file">~/.emacs</samp> file.
</p>
<p>If <var class="var">mode</var> is <code class="code">nil</code>, this function adds <var class="var">keywords</var> to
<code class="code">font-lock-keywords</code> in the current buffer.  This way of calling
<code class="code">font-lock-add-keywords</code> is usually used in mode hook functions.
</p>
<p>By default, <var class="var">keywords</var> are added at the beginning of
<code class="code">font-lock-keywords</code>.  If the optional argument <var class="var">how</var> is
<code class="code">set</code>, they are used to replace the value of
<code class="code">font-lock-keywords</code>.  If <var class="var">how</var> is any other non-<code class="code">nil</code>
value, they are added at the end of <code class="code">font-lock-keywords</code>.
</p>
<p>Some modes provide specialized support you can use in additional
highlighting patterns.  See the variables
<code class="code">c-font-lock-extra-types</code>, <code class="code">c++-font-lock-extra-types</code>,
and <code class="code">java-font-lock-extra-types</code>, for example.
</p>
<p><strong class="strong">Warning:</strong> Major mode commands must not call
<code class="code">font-lock-add-keywords</code> under any circumstances, either directly
or indirectly, except through their mode hooks.  (Doing so would lead to
incorrect behavior for some minor modes.)  They should set up their
rules for search-based fontification by setting
<code class="code">font-lock-keywords</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-font_002dlock_002dremove_002dkeywords"><span class="category-def">Function: </span><span><strong class="def-name">font-lock-remove-keywords</strong> <var class="def-var-arguments">mode keywords</var><a class="copiable-link" href="#index-font_002dlock_002dremove_002dkeywords"> &para;</a></span></dt>
<dd><p>This function removes <var class="var">keywords</var> from <code class="code">font-lock-keywords</code>
for the current buffer or for major mode <var class="var">mode</var>.  As in
<code class="code">font-lock-add-keywords</code>, <var class="var">mode</var> should be a major mode
command name or <code class="code">nil</code>.  All the caveats and requirements for
<code class="code">font-lock-add-keywords</code> apply here too.  The argument
<var class="var">keywords</var> must exactly match the one used by the corresponding
<code class="code">font-lock-add-keywords</code>.
</p></dd></dl>

<p>For example, the following code adds two fontification patterns for C
mode: one to fontify the word &lsquo;<samp class="samp">FIXME</samp>&rsquo;, even in comments, and
another to fontify the words &lsquo;<samp class="samp">and</samp>&rsquo;, &lsquo;<samp class="samp">or</samp>&rsquo; and &lsquo;<samp class="samp">not</samp>&rsquo; as
keywords.
</p>
<div class="example smallexample">
<pre class="example-preformatted">(font-lock-add-keywords 'c-mode
 '((&quot;\\&lt;\\(FIXME\\):&quot; 1 font-lock-warning-face prepend)
   (&quot;\\&lt;\\(and\\|or\\|not\\)\\&gt;&quot; . font-lock-keyword-face)))
</pre></div>

<p>This example affects only C mode proper.  To add the same patterns to C
mode <em class="emph">and</em> all modes derived from it, do this instead:
</p>
<div class="example smallexample">
<pre class="example-preformatted">(add-hook 'c-mode-hook
 (lambda ()
  (font-lock-add-keywords nil
   '((&quot;\\&lt;\\(FIXME\\):&quot; 1 font-lock-warning-face prepend)
     (&quot;\\&lt;\\(and\\|or\\|not\\)\\&gt;&quot; .
      font-lock-keyword-face)))))
</pre></div>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-font_002dlock_002dignore"><span class="category-def">User Option: </span><span><strong class="def-name">font-lock-ignore</strong><a class="copiable-link" href="#index-font_002dlock_002dignore"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-selectively-disabling-font_002dlock-fontifications"></a>
<p>This option defines conditions for selectively disabling
fontifications due to certain Font Lock keywords.  If non-<code class="code">nil</code>,
its value is a list of elements of the following form:
</p>
<div class="example">
<pre class="example-preformatted">(<var class="var">symbol</var> <var class="var">condition</var> ...)
</pre></div>

<p>Here, <var class="var">symbol</var> is a symbol, usually a major or minor mode.  The
subsequent <var class="var">condition</var>s of a <var class="var">symbol</var>&rsquo;s list element will be in
effect if <var class="var">symbol</var> is bound and its value is non-<code class="code">nil</code>.  For
a mode&rsquo;s symbol, it means that the current major mode is derived from
that mode, or that minor mode is enabled in the buffer.  When a
<var class="var">condition</var> is in effect, any fontifications caused by
<code class="code">font-lock-keywords</code> elements that match the <var class="var">condition</var> will
be disabled.
</p>
<p>Each <var class="var">condition</var> can be one of the following:
</p>
<dl class="table">
<dt>a symbol</dt>
<dd><p>This condition matches any element of Font Lock keywords that
references the symbol.  This is usually a face, but can be any symbol
referenced by an element of the <code class="code">font-lock-keywords</code> list.  The
symbol can contain wildcards: <code class="code">*</code> matches any string in the
symbol&rsquo;ss name, <code class="code">?</code> matches a single character, and
<code class="code">[<var class="var">char-set</var>]</code>, where <var class="var">char-set</var> is a string of one or
more characters, matches a single character from the set.
</p>
</dd>
<dt>a string</dt>
<dd><p>This condition matches any element of Font Lock keywords whose
<var class="var">matcher</var> is a regexp which matches the string.  In other words,
this condition matches a Font Lock rule which highlights the string.
Thus, the string could be a specific program keyword whose
highlighting you want to disable.
</p>
</dd>
<dt><code class="code">(pred <var class="var">function</var>)</code></dt>
<dd><p>This condition matches any element of Font Lock keywords for which
<var class="var">function</var>, when called with the element as the argument, returns
non-<code class="code">nil</code>.
</p>
</dd>
<dt><code class="code">(not <var class="var">condition</var>)</code></dt>
<dd><p>This matches if <var class="var">condition</var> doesn&rsquo;t.
</p>
</dd>
<dt><code class="code">(and <var class="var">condition</var> &hellip;)</code></dt>
<dd><p>This matches if each of the <var class="var">condition</var>s matches.
</p>
</dd>
<dt><code class="code">(or <var class="var">condition</var> &hellip;)</code></dt>
<dd><p>This matches if at least one of the <var class="var">condition</var>s matches.
</p>
</dd>
<dt><code class="code">(except <var class="var">condition</var>)</code></dt>
<dd><p>This condition can only be used at top level or inside an
<code class="code">or</code> clause.  It undoes the effect of a previously matching
condition on the same level.
</p></dd>
</dl>
</dd></dl>

<p>As an example, consider the following setting:
</p>
<div class="example smallexample">
<pre class="example-preformatted">(setq font-lock-ignore
      '((prog-mode font-lock-*-face
                   (except help-echo))
        (emacs-lisp-mode (except &quot;;;;###autoload)&quot;)
        (whitespace-mode whitespace-empty-at-bob-regexp)
        (makefile-mode (except *))))
</pre></div>

<p>Line by line, this does the following:
</p>
<ol class="enumerate">
<li> In all programming modes, disable fontifications due to all font-lock
keywords that apply one of the standard font-lock faces (excluding
strings and comments, which are covered by syntactic Font Lock).

</li><li> However, keep any keywords that add a <code class="code">help-echo</code> text property.

</li><li> In Emacs Lisp mode, also keep the highlighting of autoload cookies,
which would have been excluded by the first condition.

</li><li> When <code class="code">whitespace-mode</code> (a minor mode) is enabled, also don&rsquo;t
highlight an empty line at beginning of buffer.

</li><li> Finally, in Makefile mode, don&rsquo;t apply any conditions.
</li></ol>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Other-Font-Lock-Variables.html">Other Font Lock Variables</a>, Previous: <a href="Search_002dbased-Fontification.html">Search-based Fontification</a>, Up: <a href="Font-Lock-Mode.html">Font Lock Mode</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
