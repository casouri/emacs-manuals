<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 25.1.

Copyright Â© 1990-1996, 1998-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Core Advising Primitives (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Core Advising Primitives (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Core Advising Primitives (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Advising-Functions.html" rel="up" title="Advising Functions">
<link href="Advising-Named-Functions.html" rel="next" title="Advising Named Functions">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Core-Advising-Primitives">
<div class="nav-panel">
<p>
Next: <a href="Advising-Named-Functions.html" accesskey="n" rel="next">Advising Named Functions</a>, Up: <a href="Advising-Functions.html" accesskey="u" rel="up">Advising Emacs Lisp Functions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Primitives-to-manipulate-advices"><span>12.11.1 Primitives to manipulate advices<a class="copiable-link" href="#Primitives-to-manipulate-advices"> &para;</a></span></h4>
<a class="index-entry-id" id="index-advice_002c-add-and-remove"></a>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-add_002dfunction"><span class="category-def">Macro: </span><span><strong class="def-name">add-function</strong> <var class="def-var-arguments">where place function &amp;optional props</var><a class="copiable-link" href="#index-add_002dfunction"> &para;</a></span></dt>
<dd><p>This macro is the handy way to add the advice <var class="var">function</var> to the function
stored in <var class="var">place</var> (see <a class="pxref" href="Generalized-Variables.html">Generalized Variables</a>).
</p>
<p><var class="var">where</var> determines how <var class="var">function</var> is composed with the
existing function, e.g., whether <var class="var">function</var> should be called before, or
after the original function.  See <a class="xref" href="Advice-combinators.html">Ways to compose advice</a>, for the list of
available ways to compose the two functions.
</p>
<p>When modifying a variable (whose name will usually end with <code class="code">-function</code>),
you can choose whether <var class="var">function</var> is used globally or only in the current
buffer: if <var class="var">place</var> is just a symbol, then <var class="var">function</var> is added to the
global value of <var class="var">place</var>.  Whereas if <var class="var">place</var> is of the form
<code class="code">(local <var class="var">symbol</var>)</code>, where <var class="var">symbol</var> is an expression which returns
the variable name, then <var class="var">function</var> will only be added in the
current buffer.  Finally, if you want to modify a lexical variable, you will
have to use <code class="code">(var <var class="var">variable</var>)</code>.
</p>
<p>Every function added with <code class="code">add-function</code> can be accompanied by an
association list of properties <var class="var">props</var>.  Currently only two of those
properties have a special meaning:
</p>
<dl class="table">
<dt><code class="code">name</code></dt>
<dd><p>This gives a name to the advice, which <code class="code">remove-function</code> can use to
identify which function to remove.  Typically used when <var class="var">function</var> is an
anonymous function.
</p>
</dd>
<dt><code class="code">depth</code></dt>
<dd><p>This specifies how to order the advice, should several pieces of
advice be present.  By default, the depth is 0.  A depth of 100
indicates that this piece of advice should be kept as deep as
possible, whereas a depth of -100 indicates that it should stay as the
outermost piece.  When two pieces of advice specify the same depth,
the most recently added one will be outermost.
</p>
<p>For <code class="code">:before</code> advice, being outermost means that this advice will
be run first, before any other advice, whereas being innermost means
that it will run right before the original function, with no other
advice run between itself and the original function.  Similarly, for
<code class="code">:after</code> advice innermost means that it will run right after the
original function, with no other advice run in between, whereas
outermost means that it will be run right at the end after all other
advice.  An innermost <code class="code">:override</code> piece of advice will only
override the original function and other pieces of advice will apply
to it, whereas an outermost <code class="code">:override</code> piece of advice will
override not only the original function but all other advice applied
to it as well.
</p></dd>
</dl>

<p>If <var class="var">function</var> is not interactive, then the combined function will inherit
the interactive spec, if any, of the original function.  Else, the combined
function will be interactive and will use the interactive spec of
<var class="var">function</var>.  One exception: if the interactive spec of <var class="var">function</var>
is a function (rather than an expression or a string), then the interactive
spec of the combined function will be a call to that function with as sole
argument the interactive spec of the original function.  To interpret the spec
received as argument, use <code class="code">advice-eval-interactive-spec</code>.
</p>
<p>Note: The interactive spec of <var class="var">function</var> will apply to the combined
function and should hence obey the calling convention of the combined function
rather than that of <var class="var">function</var>.  In many cases, it makes no difference
since they are identical, but it does matter for <code class="code">:around</code>,
<code class="code">:filter-args</code>, and <code class="code">filter-return</code>, where <var class="var">function</var>.
</p></dd></dl>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-remove_002dfunction"><span class="category-def">Macro: </span><span><strong class="def-name">remove-function</strong> <var class="def-var-arguments">place function</var><a class="copiable-link" href="#index-remove_002dfunction"> &para;</a></span></dt>
<dd><p>This macro removes <var class="var">function</var> from the function stored in
<var class="var">place</var>.  This only works if <var class="var">function</var> was added to <var class="var">place</var>
using <code class="code">add-function</code>.
</p>
<p><var class="var">function</var> is compared with functions added to <var class="var">place</var> using
<code class="code">equal</code>, to try and make it work also with lambda expressions.  It is
additionally compared also with the <code class="code">name</code> property of the functions added
to <var class="var">place</var>, which can be more reliable than comparing lambda expressions
using <code class="code">equal</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-advice_002dfunction_002dmember_002dp"><span class="category-def">Function: </span><span><strong class="def-name">advice-function-member-p</strong> <var class="def-var-arguments">advice function-def</var><a class="copiable-link" href="#index-advice_002dfunction_002dmember_002dp"> &para;</a></span></dt>
<dd><p>Return non-<code class="code">nil</code> if <var class="var">advice</var> is already in <var class="var">function-def</var>.
Like for <code class="code">remove-function</code> above, instead of <var class="var">advice</var> being the actual
function, it can also be the <code class="code">name</code> of the piece of advice.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-advice_002dfunction_002dmapc"><span class="category-def">Function: </span><span><strong class="def-name">advice-function-mapc</strong> <var class="def-var-arguments">f function-def</var><a class="copiable-link" href="#index-advice_002dfunction_002dmapc"> &para;</a></span></dt>
<dd><p>Call the function <var class="var">f</var> for every piece of advice that was added to
<var class="var">function-def</var>.  <var class="var">f</var> is called with two arguments: the advice function
and its properties.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-advice_002deval_002dinteractive_002dspec"><span class="category-def">Function: </span><span><strong class="def-name">advice-eval-interactive-spec</strong> <var class="def-var-arguments">spec</var><a class="copiable-link" href="#index-advice_002deval_002dinteractive_002dspec"> &para;</a></span></dt>
<dd><p>Evaluate the interactive <var class="var">spec</var> just like an interactive call to a function
with such a spec would, and then return the corresponding list of arguments
that was built.  E.g., <code class="code">(advice-eval-interactive-spec &quot;r\nP&quot;)</code> will
return a list of three elements, containing the boundaries of the region and
the current prefix argument.
</p></dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Advising-Named-Functions.html">Advising Named Functions</a>, Up: <a href="Advising-Functions.html">Advising Emacs Lisp Functions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
