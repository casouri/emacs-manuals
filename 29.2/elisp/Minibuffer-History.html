<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 29.2.

Copyright Â© 1990-1996, 1998-2024 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Minibuffer History (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Minibuffer History (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Minibuffer History (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Minibuffers.html" rel="up" title="Minibuffers">
<link href="Initial-Input.html" rel="next" title="Initial Input">
<link href="Object-from-Minibuffer.html" rel="prev" title="Object from Minibuffer">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
kbd.kbd {font-style: oblique}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Minibuffer-History">
<div class="nav-panel">
<p>
Next: <a href="Initial-Input.html" accesskey="n" rel="next">Initial Input</a>, Previous: <a href="Object-from-Minibuffer.html" accesskey="p" rel="prev">Reading Lisp Objects with the Minibuffer</a>, Up: <a href="Minibuffers.html" accesskey="u" rel="up">Minibuffers</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Minibuffer-History-1"><span>21.4 Minibuffer History<a class="copiable-link" href="#Minibuffer-History-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-minibuffer-history"></a>
<a class="index-entry-id" id="index-history-list"></a>

<p>A <em class="dfn">minibuffer history list</em> records previous minibuffer inputs
so the user can reuse them conveniently.  It is a variable whose value
is a list of strings (previous inputs), most recent first.
</p>
<p>There are many separate minibuffer history lists, used for different
kinds of inputs.  It&rsquo;s the Lisp programmer&rsquo;s job to specify the right
history list for each use of the minibuffer.
</p>
<p>You specify a minibuffer history list with the optional <var class="var">history</var>
argument to <code class="code">read-from-minibuffer</code> or <code class="code">completing-read</code>.
Here are the possible values for it:
</p>
<dl class="table">
<dt><var class="var">variable</var></dt>
<dd><p>Use <var class="var">variable</var> (a symbol) as the history list.
</p>
</dd>
<dt>(<var class="var">variable</var> . <var class="var">startpos</var>)</dt>
<dd><p>Use <var class="var">variable</var> (a symbol) as the history list, and assume that the
initial history position is <var class="var">startpos</var> (a nonnegative integer).
</p>
<p>Specifying 0 for <var class="var">startpos</var> is equivalent to just specifying the
symbol <var class="var">variable</var>.  <code class="code">previous-history-element</code> will display
the most recent element of the history list in the minibuffer.  If you
specify a positive <var class="var">startpos</var>, the minibuffer history functions
behave as if <code class="code">(elt <var class="var">variable</var> (1- <var class="var">startpos</var>))</code> were the
history element currently shown in the minibuffer.
</p>
<p>For consistency, you should also specify that element of the history
as the initial minibuffer contents, using the <var class="var">initial</var> argument
to the minibuffer input function (see <a class="pxref" href="Initial-Input.html">Initial Input</a>).
</p></dd>
</dl>

<p>If you don&rsquo;t specify <var class="var">history</var>, then the default history list
<code class="code">minibuffer-history</code> is used.  For other standard history lists,
see below.  You can also create your own history list variable; just
initialize it to <code class="code">nil</code> before the first use.  If the variable is
buffer local, then each buffer will have its own input history list.
</p>
<p>Both <code class="code">read-from-minibuffer</code> and <code class="code">completing-read</code> add new
elements to the history list automatically, and provide commands to
allow the user to reuse items on the list (see <a class="pxref" href="Minibuffer-Commands.html">Minibuffer Commands</a>).  The only thing your program needs to do to use a history
list is to initialize it and to pass its name to the input functions
when you wish.  But it is safe to modify the list by hand when the
minibuffer input functions are not using it.
</p>
<a class="index-entry-id" id="index-minibuffer_002ddefault_002dadd_002dfunction"></a>
<p>By default, when <kbd class="kbd">M-n</kbd> (<code class="code">next-history-element</code>,
see <a class="pxref" href="Minibuffer-Commands.html">next-history-element</a>) reaches the end of
the list of default values provided by the command which initiated
reading input from the minibuffer, <kbd class="kbd">M-n</kbd> adds all of the
completion candidates, as specified by
<code class="code">minibuffer-completion-table</code> (see <a class="pxref" href="Completion-Commands.html">Minibuffer Commands that Do Completion</a>), to
the list of defaults, so that all those candidates are available as
&ldquo;future history&rdquo;.  Your program can control that via the variable
<code class="code">minibuffer-default-add-function</code>: if its value is not a
function, this automatic addition is disabled, and you can also set
this variable to your own function which adds only some candidates, or
some other values, to the &ldquo;future history&rdquo;.
</p>
<p>Emacs functions that add a new element to a history list can also
delete old elements if the list gets too long.  The variable
<code class="code">history-length</code> specifies the maximum length for most history
lists.  To specify a different maximum length for a particular history
list, put the length in the <code class="code">history-length</code> property of the
history list symbol.  The variable <code class="code">history-delete-duplicates</code>
specifies whether to delete duplicates in history.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-add_002dto_002dhistory"><span class="category-def">Function: </span><span><strong class="def-name">add-to-history</strong> <var class="def-var-arguments">history-var newelt &amp;optional maxelt keep-all</var><a class="copiable-link" href="#index-add_002dto_002dhistory"> &para;</a></span></dt>
<dd><p>This function adds a new element <var class="var">newelt</var>, if it isn&rsquo;t the empty
string, to the history list stored in the variable <var class="var">history-var</var>,
and returns the updated history list.  It limits the list length to
the value of <var class="var">maxelt</var> (if non-<code class="code">nil</code>) or <code class="code">history-length</code>
(described below).  The possible values of <var class="var">maxelt</var> have the same
meaning as the values of <code class="code">history-length</code>.
<var class="var">history-var</var> cannot refer to a lexical variable.
</p>
<p>Normally, <code class="code">add-to-history</code> removes duplicate members from the
history list if <code class="code">history-delete-duplicates</code> is non-<code class="code">nil</code>.
However, if <var class="var">keep-all</var> is non-<code class="code">nil</code>, that says not to remove
duplicates, and to add <var class="var">newelt</var> to the list even if it is empty.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-history_002dadd_002dnew_002dinput"><span class="category-def">Variable: </span><span><strong class="def-name">history-add-new-input</strong><a class="copiable-link" href="#index-history_002dadd_002dnew_002dinput"> &para;</a></span></dt>
<dd><p>If the value of this variable is <code class="code">nil</code>, standard functions that
read from the minibuffer don&rsquo;t add new elements to the history list.
This lets Lisp programs explicitly manage input history by using
<code class="code">add-to-history</code>.  The default value is <code class="code">t</code>.
</p></dd></dl>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-history_002dlength"><span class="category-def">User Option: </span><span><strong class="def-name">history-length</strong><a class="copiable-link" href="#index-history_002dlength"> &para;</a></span></dt>
<dd><p>The value of this variable specifies the maximum length for all
history lists that don&rsquo;t specify their own maximum lengths.  If the
value is <code class="code">t</code>, that means there is no maximum (don&rsquo;t delete old
elements).  If a history list variable&rsquo;s symbol has a non-<code class="code">nil</code>
<code class="code">history-length</code> property, it overrides this variable for that
particular history list.
</p></dd></dl>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-history_002ddelete_002dduplicates"><span class="category-def">User Option: </span><span><strong class="def-name">history-delete-duplicates</strong><a class="copiable-link" href="#index-history_002ddelete_002dduplicates"> &para;</a></span></dt>
<dd><p>If the value of this variable is <code class="code">t</code>, that means when adding a
new history element, all previous identical elements are deleted.
</p></dd></dl>

<p>Here are some of the standard minibuffer history list variables:
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-minibuffer_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">minibuffer-history</strong><a class="copiable-link" href="#index-minibuffer_002dhistory"> &para;</a></span></dt>
<dd><p>The default history list for minibuffer history input.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-query_002dreplace_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">query-replace-history</strong><a class="copiable-link" href="#index-query_002dreplace_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments to <code class="code">query-replace</code> (and similar
arguments to other commands).
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-file_002dname_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">file-name-history</strong><a class="copiable-link" href="#index-file_002dname_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for file-name arguments.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-buffer_002dname_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">buffer-name-history</strong><a class="copiable-link" href="#index-buffer_002dname_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for buffer-name arguments.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-regexp_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">regexp-history</strong><a class="copiable-link" href="#index-regexp_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for regular expression arguments.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-extended_002dcommand_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">extended-command-history</strong><a class="copiable-link" href="#index-extended_002dcommand_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments that are names of extended commands.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-shell_002dcommand_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">shell-command-history</strong><a class="copiable-link" href="#index-shell_002dcommand_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments that are shell commands.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-read_002dexpression_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">read-expression-history</strong><a class="copiable-link" href="#index-read_002dexpression_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments that are Lisp expressions to evaluate.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-face_002dname_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">face-name-history</strong><a class="copiable-link" href="#index-face_002dname_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments that are faces.
</p></dd></dl>

<a class="index-entry-id" id="index-read_002dvariable_002c-history-list"></a>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-custom_002dvariable_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">custom-variable-history</strong><a class="copiable-link" href="#index-custom_002dvariable_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for variable-name arguments read by
<code class="code">read-variable</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-read_002dnumber_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">read-number-history</strong><a class="copiable-link" href="#index-read_002dnumber_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for numbers read by <code class="code">read-number</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-goto_002dline_002dhistory"><span class="category-def">Variable: </span><span><strong class="def-name">goto-line-history</strong><a class="copiable-link" href="#index-goto_002dline_002dhistory"> &para;</a></span></dt>
<dd><p>A history list for arguments to <code class="code">goto-line</code>.  This variable can
be made local in every buffer by customizing the user option
<code class="code">goto-line-history-local</code>.
</p></dd></dl>


</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Initial-Input.html">Initial Input</a>, Previous: <a href="Object-from-Minibuffer.html">Reading Lisp Objects with the Minibuffer</a>, Up: <a href="Minibuffers.html">Minibuffers</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
