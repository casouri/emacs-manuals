<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 24.5.

Copyright Â© 1990-1996, 1998-2015 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Event Input Misc (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Event Input Misc (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Event Input Misc (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Reading-Input.html" rel="up" title="Reading Input">
<link href="Quoted-Character-Input.html" rel="prev" title="Quoted Character Input">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Event-Input-Misc">
<div class="nav-panel">
<p>
Previous: <a href="Quoted-Character-Input.html" accesskey="p" rel="prev">Quoted Character Input</a>, Up: <a href="Reading-Input.html" accesskey="u" rel="up">Reading Input</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Miscellaneous-Event-Input-Features"><span>20.8.6 Miscellaneous Event Input Features<a class="copiable-link" href="#Miscellaneous-Event-Input-Features"> &para;</a></span></h4>

<p>This section describes how to &ldquo;peek ahead&rdquo; at events without using
them up, how to check for pending input, and how to discard pending
input.  See also the function <code class="code">read-passwd</code> (see <a class="pxref" href="Reading-a-Password.html">Reading a Password</a>).
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-unread_002dcommand_002devents"><span class="category-def">Variable: </span><span><strong class="def-name">unread-command-events</strong><a class="copiable-link" href="#index-unread_002dcommand_002devents"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-next-input"></a>
<a class="index-entry-id" id="index-peeking-at-input"></a>
<p>This variable holds a list of events waiting to be read as command
input.  The events are used in the order they appear in the list, and
removed one by one as they are used.
</p>
<p>The variable is needed because in some cases a function reads an event
and then decides not to use it.  Storing the event in this variable
causes it to be processed normally, by the command loop or by the
functions to read command input.
</p>
<a class="index-entry-id" id="index-prefix-argument-unreading"></a>
<p>For example, the function that implements numeric prefix arguments reads
any number of digits.  When it finds a non-digit event, it must unread
the event so that it can be read normally by the command loop.
Likewise, incremental search uses this feature to unread events with no
special meaning in a search, because these events should exit the search
and then execute normally.
</p>
<p>The reliable and easy way to extract events from a key sequence so as
to put them in <code class="code">unread-command-events</code> is to use
<code class="code">listify-key-sequence</code> (see below).
</p>
<p>Normally you add events to the front of this list, so that the events
most recently unread will be reread first.
</p>
<p>Events read from this list are not normally added to the current
command&rsquo;s key sequence (as returned by, e.g., <code class="code">this-command-keys</code>),
as the events will already have been added once as they were read for
the first time.  An element of the form <code class="code">(t&nbsp;.&nbsp;<var class="var">event</var>)</code><!-- /@w -->
forces <var class="var">event</var> to be added to the current command&rsquo;s key sequence.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-listify_002dkey_002dsequence"><span class="category-def">Function: </span><span><strong class="def-name">listify-key-sequence</strong> <var class="def-var-arguments">key</var><a class="copiable-link" href="#index-listify_002dkey_002dsequence"> &para;</a></span></dt>
<dd><p>This function converts the string or vector <var class="var">key</var> to a list of
individual events, which you can put in <code class="code">unread-command-events</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-input_002dpending_002dp"><span class="category-def">Function: </span><span><strong class="def-name">input-pending-p</strong> <var class="def-var-arguments">&amp;optional check-timers</var><a class="copiable-link" href="#index-input_002dpending_002dp"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-waiting-for-command-key-input"></a>
<p>This function determines whether any command input is currently
available to be read.  It returns immediately, with value <code class="code">t</code> if
there is available input, <code class="code">nil</code> otherwise.  On rare occasions it
may return <code class="code">t</code> when no input is available.
</p>
<p>If the optional argument <var class="var">check-timers</var> is non-<code class="code">nil</code>, then if
no input is available, Emacs runs any timers which are ready.
See <a class="xref" href="Timers.html">Timers for Delayed Execution</a>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-last_002dinput_002devent"><span class="category-def">Variable: </span><span><strong class="def-name">last-input-event</strong><a class="copiable-link" href="#index-last_002dinput_002devent"> &para;</a></span></dt>
<dd><p>This variable records the last terminal input event read, whether
as part of a command or explicitly by a Lisp program.
</p>
<p>In the example below, the Lisp program reads the character <kbd class="kbd">1</kbd>,
<abbr class="acronym">ASCII</abbr> code 49.  It becomes the value of <code class="code">last-input-event</code>,
while <kbd class="kbd">C-e</kbd> (we assume <kbd class="kbd">C-x C-e</kbd> command is used to evaluate
this expression) remains the value of <code class="code">last-command-event</code>.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(progn (print (read-char))
       (print last-command-event)
       last-input-event)
     -| 49
     -| 5
     &rArr; 49
</pre></div></div>
</dd></dl>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-while_002dno_002dinput"><span class="category-def">Macro: </span><span><strong class="def-name">while-no-input</strong> <var class="def-var-arguments">body&hellip;</var><a class="copiable-link" href="#index-while_002dno_002dinput"> &para;</a></span></dt>
<dd><p>This construct runs the <var class="var">body</var> forms and returns the value of the
last one&mdash;but only if no input arrives.  If any input arrives during
the execution of the <var class="var">body</var> forms, it aborts them (working much
like a quit).  The <code class="code">while-no-input</code> form returns <code class="code">nil</code> if
aborted by a real quit, and returns <code class="code">t</code> if aborted by arrival of
other input.
</p>
<p>If a part of <var class="var">body</var> binds <code class="code">inhibit-quit</code> to non-<code class="code">nil</code>,
arrival of input during those parts won&rsquo;t cause an abort until
the end of that part.
</p>
<p>If you want to be able to distinguish all possible values computed
by <var class="var">body</var> from both kinds of abort conditions, write the code
like this:
</p>
<div class="example">
<pre class="example-preformatted">(while-no-input
  (list
    (progn . <var class="var">body</var>)))
</pre></div>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-discard_002dinput"><span class="category-def">Function: </span><span><strong class="def-name">discard-input</strong><a class="copiable-link" href="#index-discard_002dinput"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-flushing-input"></a>
<a class="index-entry-id" id="index-discarding-input"></a>
<a class="index-entry-id" id="index-keyboard-macro_002c-terminating"></a>
<p>This function discards the contents of the terminal input buffer and
cancels any keyboard macro that might be in the process of definition.
It returns <code class="code">nil</code>.
</p>
<p>In the following example, the user may type a number of characters right
after starting the evaluation of the form.  After the <code class="code">sleep-for</code>
finishes sleeping, <code class="code">discard-input</code> discards any characters typed
during the sleep.
</p>
<div class="example">
<pre class="example-preformatted">(progn (sleep-for 2)
       (discard-input))
     &rArr; nil
</pre></div>
</dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Previous: <a href="Quoted-Character-Input.html">Quoted Character Input</a>, Up: <a href="Reading-Input.html">Reading Input</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
