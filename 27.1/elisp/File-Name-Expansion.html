<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.1.

Copyright Â© 1990-1996, 1998-2020 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>File Name Expansion (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="File Name Expansion (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="File Name Expansion (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="File-Names.html" rel="up" title="File Names">
<link href="Unique-File-Names.html" rel="next" title="Unique File Names">
<link href="Directory-Names.html" rel="prev" title="Directory Names">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span.r {font-family: initial; font-weight: normal; font-style: normal}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="File-Name-Expansion">
<div class="nav-panel">
<p>
Next: <a href="Unique-File-Names.html" accesskey="n" rel="next">Generating Unique File Names</a>, Previous: <a href="Directory-Names.html" accesskey="p" rel="prev">Directory Names</a>, Up: <a href="File-Names.html" accesskey="u" rel="up">File Names</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Functions-that-Expand-Filenames"><span>25.9.4 Functions that Expand Filenames<a class="copiable-link" href="#Functions-that-Expand-Filenames"> &para;</a></span></h4>
<a class="index-entry-id" id="index-expansion-of-file-names"></a>

<p><em class="dfn">Expanding</em> a file name means converting a relative file name to
an absolute one.  Since this is done relative to a default directory,
you must specify the default directory as well as the file name
to be expanded.  It also involves expanding abbreviations like
<samp class="file">~/</samp>
(see <a class="pxref" href="Directory-Names.html#abbreviate_002dfile_002dname">abbreviate-file-name</a>),
and eliminating redundancies like <samp class="file">./</samp> and <samp class="file"><var class="var">name</var>/../</samp>.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-expand_002dfile_002dname"><span class="category-def">Function: </span><span><strong class="def-name">expand-file-name</strong> <var class="def-var-arguments">filename &amp;optional directory</var><a class="copiable-link" href="#index-expand_002dfile_002dname"> &para;</a></span></dt>
<dd><p>This function converts <var class="var">filename</var> to an absolute file name.  If
<var class="var">directory</var> is supplied, it is the default directory to start with
if <var class="var">filename</var> is relative and does not start with &lsquo;<samp class="samp">~</samp>&rsquo;.
(The value of <var class="var">directory</var> should
itself be an absolute directory name or directory file name; it may
start with &lsquo;<samp class="samp">~</samp>&rsquo;.)  Otherwise, the current buffer&rsquo;s value of
<code class="code">default-directory</code> is used.  For example:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(expand-file-name &quot;foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre></div><div class="group"><pre class="example-preformatted">(expand-file-name &quot;../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre></div><div class="group"><pre class="example-preformatted">(expand-file-name &quot;foo&quot; &quot;/usr/spool/&quot;)
     &rArr; &quot;/usr/spool/foo&quot;
</pre></div></div>

<p>If the part of <var class="var">filename</var> before the first slash is
&lsquo;<samp class="samp">~</samp>&rsquo;, it expands to your home directory, which is typically
specified by the value of the <code class="env">HOME</code> environment variable
(see <a data-manual="emacs" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/General-Variables.html#General-Variables">General Variables</a> in <cite class="cite">The GNU Emacs Manual</cite>).
If the part before the first
slash is &lsquo;<samp class="samp">~<var class="var">user</var></samp>&rsquo; and if <var class="var">user</var> is a valid login name,
it expands to <var class="var">user</var>&rsquo;s home directory.
If you do not want this expansion for a relative <var class="var">filename</var> that
might begin with a literal &lsquo;<samp class="samp">~</samp>&rsquo;, you can use <code class="code">(concat
(file-name-as-directory directory) filename)</code> instead of
<code class="code">(expand-file-name filename directory)</code>.
</p>
<p>Filenames containing &lsquo;<samp class="samp">.</samp>&rsquo; or &lsquo;<samp class="samp">..</samp>&rsquo; are simplified to their
canonical form:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(expand-file-name &quot;bar/../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre></div></div>

<p>In some cases, a leading &lsquo;<samp class="samp">..</samp>&rsquo; component can remain in the output:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(expand-file-name &quot;../home&quot; &quot;/&quot;)
     &rArr; &quot;/../home&quot;
</pre></div></div>

<p>This is for the sake of filesystems that have the concept of a
superroot above the root directory <samp class="file">/</samp>.  On other filesystems,
<samp class="file">/../</samp> is interpreted exactly the same as <samp class="file">/</samp>.
</p>
<p>Expanding <samp class="file">.</samp> or the empty string returns the default directory:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(expand-file-name &quot;.&quot; &quot;/usr/spool/&quot;)
     &rArr; &quot;/usr/spool&quot;
(expand-file-name &quot;&quot; &quot;/usr/spool/&quot;)
     &rArr; &quot;/usr/spool&quot;
</pre></div></div>

<p>Note that <code class="code">expand-file-name</code> does <em class="emph">not</em> expand environment
variables; only <code class="code">substitute-in-file-name</code> does that:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(expand-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/$HOME/foo&quot;
</pre></div></div>

<p>Note also that <code class="code">expand-file-name</code> does not follow symbolic links
at any level.  This results in a difference between the way
<code class="code">file-truename</code> and <code class="code">expand-file-name</code> treat &lsquo;<samp class="samp">..</samp>&rsquo;.
Assuming that &lsquo;<samp class="samp">/tmp/bar</samp>&rsquo; is a symbolic link to the directory
&lsquo;<samp class="samp">/tmp/foo/bar</samp>&rsquo; we get:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(file-truename &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/foo/myfile&quot;
</pre></div><div class="group"><pre class="example-preformatted">(expand-file-name &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/myfile&quot;
</pre></div></div>

<p>If you may need to follow symbolic links preceding &lsquo;<samp class="samp">..</samp>&rsquo;, you
should make sure to call <code class="code">file-truename</code> without prior direct or
indirect calls to <code class="code">expand-file-name</code>.  See <a class="xref" href="Truenames.html">Truenames</a>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-default_002ddirectory"><span class="category-def">Variable: </span><span><strong class="def-name">default-directory</strong><a class="copiable-link" href="#index-default_002ddirectory"> &para;</a></span></dt>
<dd><p>The value of this buffer-local variable is the default directory for the
current buffer.  It should be an absolute directory name; it may start
with &lsquo;<samp class="samp">~</samp>&rsquo;.  This variable is buffer-local in every buffer.
</p>
<p><code class="code">expand-file-name</code> uses the default directory when its second
argument is <code class="code">nil</code>.
</p>
<p>The value is always a string ending with a slash.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">default-directory
     &rArr; &quot;/user/lewis/manual/&quot;
</pre></div></div>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-substitute_002din_002dfile_002dname"><span class="category-def">Function: </span><span><strong class="def-name">substitute-in-file-name</strong> <var class="def-var-arguments">filename</var><a class="copiable-link" href="#index-substitute_002din_002dfile_002dname"> &para;</a></span></dt>
<dd><a class="anchor" id="Definition-of-substitute_002din_002dfile_002dname"></a><p>This function replaces environment variable references in
<var class="var">filename</var> with the environment variable values.  Following
standard Unix shell syntax, &lsquo;<samp class="samp">$</samp>&rsquo; is the prefix to substitute an
environment variable value.  If the input contains &lsquo;<samp class="samp">$$</samp>&rsquo;, that is
converted to &lsquo;<samp class="samp">$</samp>&rsquo;; this gives the user a way to quote a
&lsquo;<samp class="samp">$</samp>&rsquo;.
</p>
<p>The environment variable name is the series of alphanumeric characters
(including underscores) that follow the &lsquo;<samp class="samp">$</samp>&rsquo;.  If the character following
the &lsquo;<samp class="samp">$</samp>&rsquo; is a &lsquo;<samp class="samp">{</samp>&rsquo;, then the variable name is everything up to the
matching &lsquo;<samp class="samp">}</samp>&rsquo;.
</p>
<p>Calling <code class="code">substitute-in-file-name</code> on output produced by
<code class="code">substitute-in-file-name</code> tends to give incorrect results.  For
instance, use of &lsquo;<samp class="samp">$$</samp>&rsquo; to quote a single &lsquo;<samp class="samp">$</samp>&rsquo; won&rsquo;t work
properly, and &lsquo;<samp class="samp">$</samp>&rsquo; in an environment variable&rsquo;s value could lead
to repeated substitution.  Therefore, programs that call this function
and put the output where it will be passed to this function need to
double all &lsquo;<samp class="samp">$</samp>&rsquo; characters to prevent subsequent incorrect
results.
</p>
<p>Here we assume that the environment variable <code class="env">HOME</code>, which holds
the user&rsquo;s home directory, has value &lsquo;<samp class="samp">/xcssun/users/rms</samp>&rsquo;.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(substitute-in-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre></div></div>

<p>After substitution, if a &lsquo;<samp class="samp">~</samp>&rsquo; or a &lsquo;<samp class="samp">/</samp>&rsquo; appears immediately
after another &lsquo;<samp class="samp">/</samp>&rsquo;, the function discards everything before it (up
through the immediately preceding &lsquo;<samp class="samp">/</samp>&rsquo;).
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(substitute-in-file-name &quot;bar/~/foo&quot;)
     &rArr; &quot;~/foo&quot;
</pre></div><div class="group"><pre class="example-preformatted">(substitute-in-file-name &quot;/usr/local/$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
     ;; <span class="r"><samp class="file">/usr/local/</samp> has been discarded.</span>
</pre></div></div>

</dd></dl>

<p>Sometimes, it is not desired to expand file names.  In such cases,
the file name can be quoted to suppress the expansion, and to handle
the file name literally.  Quoting happens by prefixing the file name
with &lsquo;<samp class="samp">/:</samp>&rsquo;.
</p>
<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-file_002dname_002dquote"><span class="category-def">Macro: </span><span><strong class="def-name">file-name-quote</strong> <var class="def-var-arguments">name</var><a class="copiable-link" href="#index-file_002dname_002dquote"> &para;</a></span></dt>
<dd><p>This macro adds the quotation prefix &lsquo;<samp class="samp">/:</samp>&rsquo; to the file <var class="var">name</var>.
For a local file <var class="var">name</var>, it prefixes <var class="var">name</var> with &lsquo;<samp class="samp">/:</samp>&rsquo;.
If <var class="var">name</var> is a remote file name, the local part of <var class="var">name</var>
(see <a class="pxref" href="Magic-File-Names.html">Making Certain File Names &ldquo;Magic&rdquo;</a>) is quoted.  If <var class="var">name</var> is already a
quoted file name, <var class="var">name</var> is returned unchanged.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(substitute-in-file-name (file-name-quote &quot;bar/~/foo&quot;))
     &rArr; &quot;/:bar/~/foo&quot;
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">(substitute-in-file-name (file-name-quote &quot;/ssh:host:bar/~/foo&quot;))
     &rArr; &quot;/ssh:host:/:bar/~/foo&quot;
</pre></div></div>

<p>The macro cannot be used to suppress file name handlers from magic
file names (see <a class="pxref" href="Magic-File-Names.html">Making Certain File Names &ldquo;Magic&rdquo;</a>).
</p></dd></dl>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-file_002dname_002dunquote"><span class="category-def">Macro: </span><span><strong class="def-name">file-name-unquote</strong> <var class="def-var-arguments">name</var><a class="copiable-link" href="#index-file_002dname_002dunquote"> &para;</a></span></dt>
<dd><p>This macro removes the quotation prefix &lsquo;<samp class="samp">/:</samp>&rsquo; from the file
<var class="var">name</var>, if any. If <var class="var">name</var> is a remote file name, the local
part of <var class="var">name</var> is unquoted.
</p></dd></dl>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-file_002dname_002dquoted_002dp"><span class="category-def">Macro: </span><span><strong class="def-name">file-name-quoted-p</strong> <var class="def-var-arguments">name</var><a class="copiable-link" href="#index-file_002dname_002dquoted_002dp"> &para;</a></span></dt>
<dd><p>This macro returns non-<code class="code">nil</code>, when <var class="var">name</var> is quoted with the
prefix &lsquo;<samp class="samp">/:</samp>&rsquo;.  If <var class="var">name</var> is a remote file name, the local part
of <var class="var">name</var> is checked.
</p></dd></dl>


</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Unique-File-Names.html">Generating Unique File Names</a>, Previous: <a href="Directory-Names.html">Directory Names</a>, Up: <a href="File-Names.html">File Names</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
