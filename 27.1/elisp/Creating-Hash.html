<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.1.

Copyright Â© 1990-1996, 1998-2020 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Creating Hash (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Creating Hash (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Creating Hash (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Hash-Tables.html" rel="up" title="Hash Tables">
<link href="Hash-Access.html" rel="next" title="Hash Access">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Creating-Hash">
<div class="nav-panel">
<p>
Next: <a href="Hash-Access.html" accesskey="n" rel="next">Hash Table Access</a>, Up: <a href="Hash-Tables.html" accesskey="u" rel="up">Hash Tables</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Creating-Hash-Tables"><span>8.1 Creating Hash Tables<a class="copiable-link" href="#Creating-Hash-Tables"> &para;</a></span></h3>
<a class="index-entry-id" id="index-creating-hash-tables"></a>

<p>The principal function for creating a hash table is
<code class="code">make-hash-table</code>.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-make_002dhash_002dtable"><span class="category-def">Function: </span><span><strong class="def-name">make-hash-table</strong> <var class="def-var-arguments">&amp;rest keyword-args</var><a class="copiable-link" href="#index-make_002dhash_002dtable"> &para;</a></span></dt>
<dd><p>This function creates a new hash table according to the specified
arguments.  The arguments should consist of alternating keywords
(particular symbols recognized specially) and values corresponding to
them.
</p>
<p>Several keywords make sense in <code class="code">make-hash-table</code>, but the only two
that you really need to know about are <code class="code">:test</code> and <code class="code">:weakness</code>.
</p>
<dl class="table">
<dt><code class="code">:test <var class="var">test</var></code></dt>
<dd><p>This specifies the method of key lookup for this hash table.  The
default is <code class="code">eql</code>; <code class="code">eq</code> and <code class="code">equal</code> are other
alternatives:
</p>
<dl class="table">
<dt><code class="code">eql</code></dt>
<dd><p>Keys which are numbers are the same if they are <code class="code">equal</code>, that
is, if they are equal in value and either both are integers or both
are floating point; otherwise, two distinct objects are never
the same.
</p>
</dd>
<dt><code class="code">eq</code></dt>
<dd><p>Any two distinct Lisp objects are different as keys.
</p>
</dd>
<dt><code class="code">equal</code></dt>
<dd><p>Two Lisp objects are the same, as keys, if they are equal
according to <code class="code">equal</code>.
</p></dd>
</dl>

<p>You can use <code class="code">define-hash-table-test</code> (see <a class="pxref" href="Defining-Hash.html">Defining Hash Comparisons</a>) to
define additional possibilities for <var class="var">test</var>.
</p>
</dd>
<dt><code class="code">:weakness <var class="var">weak</var></code></dt>
<dd><p>The weakness of a hash table specifies whether the presence of a key or
value in the hash table preserves it from garbage collection.
</p>
<p>The value, <var class="var">weak</var>, must be one of <code class="code">nil</code>, <code class="code">key</code>,
<code class="code">value</code>, <code class="code">key-or-value</code>, <code class="code">key-and-value</code>, or <code class="code">t</code>
which is an alias for <code class="code">key-and-value</code>.  If <var class="var">weak</var> is <code class="code">key</code>
then the hash table does not prevent its keys from being collected as
garbage (if they are not referenced anywhere else); if a particular key
does get collected, the corresponding association is removed from the
hash table.
</p>
<p>If <var class="var">weak</var> is <code class="code">value</code>, then the hash table does not prevent
values from being collected as garbage (if they are not referenced
anywhere else); if a particular value does get collected, the
corresponding association is removed from the hash table.
</p>
<p>If <var class="var">weak</var> is <code class="code">key-and-value</code> or <code class="code">t</code>, both the key and
the value must be live in order to preserve the association.  Thus,
the hash table does not protect either keys or values from garbage
collection; if either one is collected as garbage, that removes the
association.
</p>
<p>If <var class="var">weak</var> is <code class="code">key-or-value</code>, either the key or
the value can preserve the association.  Thus, associations are
removed from the hash table when both their key and value would be
collected as garbage (if not for references from weak hash tables).
</p>
<p>The default for <var class="var">weak</var> is <code class="code">nil</code>, so that all keys and values
referenced in the hash table are preserved from garbage collection.
</p>
</dd>
<dt><code class="code">:size <var class="var">size</var></code></dt>
<dd><p>This specifies a hint for how many associations you plan to store in the
hash table.  If you know the approximate number, you can make things a
little more efficient by specifying it this way.  If you specify too
small a size, the hash table will grow automatically when necessary, but
doing that takes some extra time.
</p>
<p>The default size is 65.
</p>
</dd>
<dt><code class="code">:rehash-size <var class="var">rehash-size</var></code></dt>
<dd><p>When you add an association to a hash table and the table is full,
it grows automatically.  This value specifies how to make the hash table
larger, at that time.
</p>
<p>If <var class="var">rehash-size</var> is an integer, it should be positive, and the hash
table grows by adding approximately that much to the nominal size.  If
<var class="var">rehash-size</var> is floating point, it had better be greater
than 1, and the hash table grows by multiplying the old size by
approximately that number.
</p>
<p>The default value is 1.5.
</p>
</dd>
<dt><code class="code">:rehash-threshold <var class="var">threshold</var></code></dt>
<dd><p>This specifies the criterion for when the hash table is full (so
it should be made larger).  The value, <var class="var">threshold</var>, should be a
positive floating-point number, no greater than 1.  The hash table is
full whenever the actual number of entries exceeds the nominal size
multiplied by an approximation to this value.  The default for
<var class="var">threshold</var> is 0.8125.
</p></dd>
</dl>
</dd></dl>

<p>You can also create a new hash table using the printed representation
for hash tables.  The Lisp reader can read this printed
representation, provided each element in the specified hash table has
a valid read syntax (see <a class="pxref" href="Printed-Representation.html">Printed Representation and Read Syntax</a>).  For instance,
the following specifies a new hash table containing the keys
<code class="code">key1</code> and <code class="code">key2</code> (both symbols) associated with <code class="code">val1</code>
(a symbol) and <code class="code">300</code> (a number) respectively.
</p>
<div class="example">
<pre class="example-preformatted">#s(hash-table size 30 data (key1 val1 key2 300))
</pre></div>

<p>The printed representation for a hash table consists of &lsquo;<samp class="samp">#s</samp>&rsquo;
followed by a list beginning with &lsquo;<samp class="samp">hash-table</samp>&rsquo;.  The rest of the
list should consist of zero or more property-value pairs specifying
the hash table&rsquo;s properties and initial contents.  The properties and
values are read literally.  Valid property names are <code class="code">size</code>,
<code class="code">test</code>, <code class="code">weakness</code>, <code class="code">rehash-size</code>,
<code class="code">rehash-threshold</code>, and <code class="code">data</code>.  The <code class="code">data</code> property
should be a list of key-value pairs for the initial contents; the
other properties have the same meanings as the matching
<code class="code">make-hash-table</code> keywords (<code class="code">:size</code>, <code class="code">:test</code>, etc.),
described above.
</p>
<p>Note that you cannot specify a hash table whose initial contents
include objects that have no read syntax, such as buffers and frames.
Such objects may be added to the hash table after it is created.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Hash-Access.html">Hash Table Access</a>, Up: <a href="Hash-Tables.html">Hash Tables</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
