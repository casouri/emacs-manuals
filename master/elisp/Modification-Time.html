<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 31.0.50.

Copyright Â© 1990-1996, 1998-2025 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Modification Time (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Modification Time (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Modification Time (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Buffers.html" rel="up" title="Buffers">
<link href="Read-Only-Buffers.html" rel="next" title="Read Only Buffers">
<link href="Buffer-Modification.html" rel="prev" title="Buffer Modification">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Modification-Time">
<div class="nav-panel">
<p>
Next: <a href="Read-Only-Buffers.html" accesskey="n" rel="next">Read-Only Buffers</a>, Previous: <a href="Buffer-Modification.html" accesskey="p" rel="prev">Buffer Modification</a>, Up: <a href="Buffers.html" accesskey="u" rel="up">Buffers</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Buffer-Modification-Time"><span>28.6 Buffer Modification Time<a class="copiable-link" href="#Buffer-Modification-Time"> &para;</a></span></h3>
<a class="index-entry-id" id="index-comparing-file-modification-time"></a>
<a class="index-entry-id" id="index-modification-time-of-buffer"></a>

<p>Suppose that you visit a file and make changes in its buffer, and
meanwhile the file itself is changed on disk.  At this point, saving the
buffer would overwrite the changes in the file.  Occasionally this may
be what you want, but usually it would lose valuable information.  Emacs
therefore checks the file&rsquo;s modification time using the functions
described below before saving the file.  (See <a class="xref" href="File-Attributes.html">File Attributes</a>,
for how to examine a file&rsquo;s modification time.)
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-verify_002dvisited_002dfile_002dmodtime"><span class="category-def">Function: </span><span><strong class="def-name">verify-visited-file-modtime</strong> <var class="def-var-arguments">&amp;optional buffer</var><a class="copiable-link" href="#index-verify_002dvisited_002dfile_002dmodtime"> &para;</a></span></dt>
<dd><p>This function compares what <var class="var">buffer</var> (by default, the
current-buffer) has recorded for the modification time of its visited
file against the actual modification time of the file as recorded by the
operating system.  The two should be the same unless some other process
has written the file since Emacs visited or saved it.
</p>
<p>The function returns <code class="code">t</code> if the last actual modification time and
Emacs&rsquo;s recorded modification time are the same, <code class="code">nil</code> otherwise.
It also returns <code class="code">t</code> if the buffer has no recorded last
modification time, that is if <code class="code">visited-file-modtime</code> would return
zero.
</p>
<p>It always returns <code class="code">t</code> for buffers that are not visiting a file,
even if <code class="code">visited-file-modtime</code> returns a non-zero value.  For
instance, it always returns <code class="code">t</code> for dired buffers.  It returns
<code class="code">t</code> for buffers that are visiting a file that does not exist and
never existed, but <code class="code">nil</code> for file-visiting buffers whose file has
been deleted.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-clear_002dvisited_002dfile_002dmodtime"><span class="category-def">Function: </span><span><strong class="def-name">clear-visited-file-modtime</strong><a class="copiable-link" href="#index-clear_002dvisited_002dfile_002dmodtime"> &para;</a></span></dt>
<dd><p>This function clears out the record of the last modification time of
the file being visited by the current buffer.  As a result, the next
attempt to save this buffer will not complain of a discrepancy in
file modification times.
</p>
<p>This function is called in <code class="code">set-visited-file-name</code> and other
exceptional places where the usual test to avoid overwriting a changed
file should not be done.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-visited_002dfile_002dmodtime"><span class="category-def">Function: </span><span><strong class="def-name">visited-file-modtime</strong><a class="copiable-link" href="#index-visited_002dfile_002dmodtime"> &para;</a></span></dt>
<dd><p>This function returns the current buffer&rsquo;s recorded last file
modification time, as a Lisp timestamp (see <a class="pxref" href="Time-of-Day.html">Time of Day</a>).
</p>
<p>If the buffer has no recorded last modification time, this function
returns zero.  This case occurs, for instance, if the buffer is not
visiting a file or if the time has been explicitly cleared by
<code class="code">clear-visited-file-modtime</code>.  Note, however, that
<code class="code">visited-file-modtime</code> returns a timestamp for some non-file buffers
too.  For instance, in a Dired buffer listing a directory, it returns
the last modification time of that directory, as recorded by Dired.
</p>
<p>If the buffer is visiting a file that doesn&rsquo;t exist, this function
returns &minus;1.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-set_002dvisited_002dfile_002dmodtime"><span class="category-def">Function: </span><span><strong class="def-name">set-visited-file-modtime</strong> <var class="def-var-arguments">&amp;optional time</var><a class="copiable-link" href="#index-set_002dvisited_002dfile_002dmodtime"> &para;</a></span></dt>
<dd><p>This function updates the buffer&rsquo;s record of the last modification time
of the visited file, to the value specified by <var class="var">time</var> if <var class="var">time</var>
is not <code class="code">nil</code>, and otherwise to the last modification time of the
visited file.
</p>
<p>If <var class="var">time</var> is neither <code class="code">nil</code> nor an integer flag returned
by <code class="code">visited-file-modtime</code>, it should be a Lisp time value
(see <a class="pxref" href="Time-of-Day.html">Time of Day</a>).
</p>
<p>This function is useful if the buffer was not read from the file
normally, or if the file itself has been changed for some known benign
reason.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-ask_002duser_002dabout_002dsupersession_002dthreat"><span class="category-def">Function: </span><span><strong class="def-name">ask-user-about-supersession-threat</strong> <var class="def-var-arguments">filename</var><a class="copiable-link" href="#index-ask_002duser_002dabout_002dsupersession_002dthreat"> &para;</a></span></dt>
<dd><p>This function is used to ask a user how to proceed after an attempt to
modify a buffer visiting file <var class="var">filename</var> when the file is newer
than the buffer text.  Emacs detects this because the modification
time of the file on disk is newer than the last save-time and its contents
have changed.
This means some other program has probably altered the file.
</p>
<a class="index-entry-id" id="index-file_002dsupersession"></a>
<p>Depending on the user&rsquo;s answer, the function may return normally, in
which case the modification of the buffer proceeds, or it may signal a
<code class="code">file-supersession</code> error with data <code class="code">(<var class="var">filename</var>)</code>, in which
case the proposed buffer modification is not allowed.
</p>
<p>This function is called automatically by Emacs on the proper
occasions.  It exists so you can customize Emacs by redefining it.
See the file <samp class="file">userlock.el</samp> for the standard definition.
</p>
<p>See also the file locking mechanism in <a class="ref" href="File-Locks.html">File Locks</a>.
</p></dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Read-Only-Buffers.html">Read-Only Buffers</a>, Previous: <a href="Buffer-Modification.html">Buffer Modification</a>, Up: <a href="Buffers.html">Buffers</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
