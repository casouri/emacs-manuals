<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 31.0.50.

Copyright Â© 1990-1996, 1998-2026 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Compilation Functions (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Compilation Functions (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Compilation Functions (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Byte-Compilation.html" rel="up" title="Byte Compilation">
<link href="Docs-and-Compilation.html" rel="next" title="Docs and Compilation">
<link href="Speed-of-Byte_002dCode.html" rel="prev" title="Speed of Byte-Code">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Compilation-Functions">
<div class="nav-panel">
<p>
Next: <a href="Docs-and-Compilation.html" accesskey="n" rel="next">Documentation Strings and Compilation</a>, Previous: <a href="Speed-of-Byte_002dCode.html" accesskey="p" rel="prev">Performance of Byte-Compiled Code</a>, Up: <a href="Byte-Compilation.html" accesskey="u" rel="up">Byte Compilation</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Byte_002dCompilation-Functions"><span>17.2 Byte-Compilation Functions<a class="copiable-link" href="#Byte_002dCompilation-Functions"> &para;</a></span></h3>
<a class="index-entry-id" id="index-compilation-functions"></a>

<p>You can byte-compile an individual function or macro definition with
the <code class="code">byte-compile</code> function.  You can compile a whole file with
<code class="code">byte-compile-file</code>, or several files with
<code class="code">byte-recompile-directory</code> or <code class="code">batch-byte-compile</code>.
</p>
<a class="index-entry-id" id="index-byte_002dcompile_002ddebug"></a>
<p>Sometimes, the byte compiler produces warning and/or error messages
(see <a class="pxref" href="Compiler-Errors.html">Compiler Errors</a>, for details).  These messages are normally
recorded in a buffer called <samp class="file">*Compile-Log*</samp>, which uses
Compilation mode.  See <a data-manual="emacs" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode.html#Compilation-Mode">Compilation Mode</a> in <cite class="cite">The GNU Emacs
Manual</cite>.  However, if the variable <code class="code">byte-compile-debug</code> is
non-<code class="code">nil</code>, error messages will be signaled as Lisp errors instead
(see <a class="pxref" href="Errors.html">Errors</a>).
</p>
<a class="index-entry-id" id="index-macro-compilation"></a>
<p>Be careful when writing macro calls in files that you intend to
byte-compile.  Since macro calls are expanded when they are compiled,
the macros need to be loaded into Emacs or the byte compiler will not
do the right thing.  The usual way to handle this is with
<code class="code">require</code> forms which specify the files containing the needed
macro definitions (see <a class="pxref" href="Named-Features.html">Features</a>).  Normally, the
byte compiler does not evaluate the code that it is compiling, but it
handles <code class="code">require</code> forms specially, by loading the specified
libraries.  To avoid loading the macro definition files when someone
<em class="emph">runs</em> the compiled program, write <code class="code">eval-when-compile</code>
around the <code class="code">require</code> calls (see <a class="pxref" href="Eval-During-Compile.html">Evaluation During Compilation</a>).  For
more details, See <a class="xref" href="Compiling-Macros.html">Macros and Byte Compilation</a>.
</p>
<p>Inline (<code class="code">defsubst</code>) functions are less troublesome; if you
compile a call to such a function before its definition is known, the
call will still work right, it will just run slower.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-byte_002dcompile"><span class="category-def">Function: </span><span><strong class="def-name">byte-compile</strong> <var class="def-var-arguments">symbol</var><a class="copiable-link" href="#index-byte_002dcompile"> &para;</a></span></dt>
<dd><p>This function byte-compiles the function definition of <var class="var">symbol</var>,
replacing the previous definition with the compiled one.  The function
definition of <var class="var">symbol</var> must be the actual code for the function;
<code class="code">byte-compile</code> does not handle function indirection.  The return
value is the byte-code function object which is the compiled
definition of <var class="var">symbol</var> (see <a class="pxref" href="Closure-Objects.html">Closure Function Objects</a>).
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(defun factorial (integer)
  &quot;Compute factorial of INTEGER.&quot;
  (if (= 1 integer) 1
    (* integer (factorial (1- integer)))))
&rArr; factorial
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">(byte-compile 'factorial)
&rArr;
#[257
  &quot;\211\300U\203^H^@\300\207\211\301^BS!_\207&quot;
  [1 factorial] 4
  &quot;Compute factorial of INTEGER.\n\n(fn INTEGER)&quot;]
</pre></div></div>

<p>If <var class="var">symbol</var>&rsquo;s definition is a byte-code function object,
<code class="code">byte-compile</code> does nothing and returns <code class="code">nil</code>.  It does not
compile the symbol&rsquo;s definition again, since the original
(non-compiled) code has already been replaced in the symbol&rsquo;s function
cell by the byte-compiled code.
</p>
<p>The argument to <code class="code">byte-compile</code> can also be a <code class="code">lambda</code>
expression.  In that case, the function returns the corresponding
compiled code but does not store it anywhere.
</p></dd></dl>

<dl class="first-deffn">
<dt class="deffn" id="index-compile_002ddefun"><span class="category-def">Command: </span><span><strong class="def-name">compile-defun</strong> <var class="def-var-arguments">&amp;optional arg</var><a class="copiable-link" href="#index-compile_002ddefun"> &para;</a></span></dt>
<dd><p>This command reads the defun containing point, compiles it, and
evaluates the result.  If you use this on a defun that is actually a
function definition, the effect is to install a compiled version of that
function.
</p>
<p><code class="code">compile-defun</code> normally displays the result of evaluation in the
echo area, but if <var class="var">arg</var> is non-<code class="code">nil</code>, it inserts the result
in the current buffer after the form it has compiled.
</p></dd></dl>

<dl class="first-deffn">
<dt class="deffn" id="index-byte_002dcompile_002dfile"><span class="category-def">Command: </span><span><strong class="def-name">byte-compile-file</strong> <var class="def-var-arguments">filename</var><a class="copiable-link" href="#index-byte_002dcompile_002dfile"> &para;</a></span></dt>
<dd><p>This function compiles a file of Lisp code named <var class="var">filename</var> into a
file of byte-code.  The output file&rsquo;s name is made by changing the
&lsquo;<samp class="samp">.el</samp>&rsquo; suffix into &lsquo;<samp class="samp">.elc</samp>&rsquo;; if <var class="var">filename</var> does not end in
&lsquo;<samp class="samp">.el</samp>&rsquo;, it adds &lsquo;<samp class="samp">.elc</samp>&rsquo; to the end of <var class="var">filename</var>.
</p>
<p>Compilation works by reading the input file one form at a time.  If it
is a definition of a function or macro, the compiled function or macro
definition is written out.  Other forms are batched together, then each
batch is compiled, and written so that its compiled code will be
executed when the file is read.  All comments are discarded when the
input file is read.
</p>
<p>This command returns <code class="code">t</code> if there were no errors and <code class="code">nil</code>
otherwise.  When called interactively, it prompts for the file name.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">$ ls -l push*
-rw-r--r-- 1 lewis lewis 791 Oct  5 20:31 push.el
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">(byte-compile-file &quot;~/emacs/push.el&quot;)
     &rArr; t
</pre></div><pre class="example-preformatted">

</pre><div class="group"><pre class="example-preformatted">$ ls -l push*
-rw-r--r-- 1 lewis lewis 791 Oct  5 20:31 push.el
-rw-rw-rw- 1 lewis lewis 638 Oct  8 20:25 push.elc
</pre></div></div>
</dd></dl>

<dl class="first-deffn">
<dt class="deffn" id="index-byte_002drecompile_002ddirectory"><span class="category-def">Command: </span><span><strong class="def-name">byte-recompile-directory</strong> <var class="def-var-arguments">directory &amp;optional flag force follow-symlinks</var><a class="copiable-link" href="#index-byte_002drecompile_002ddirectory"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-library-compilation"></a>
<p>This command recompiles every &lsquo;<samp class="samp">.el</samp>&rsquo; file in <var class="var">directory</var> (or
its subdirectories) that needs recompilation.  A file needs
recompilation if a &lsquo;<samp class="samp">.elc</samp>&rsquo; file exists but is older than the
&lsquo;<samp class="samp">.el</samp>&rsquo; file.
</p>
<p>When a &lsquo;<samp class="samp">.el</samp>&rsquo; file has no corresponding &lsquo;<samp class="samp">.elc</samp>&rsquo; file,
<var class="var">flag</var> says what to do.  If it is <code class="code">nil</code>, this command ignores
these files.  If <var class="var">flag</var> is 0, it compiles them.  If it is neither
<code class="code">nil</code> nor 0, it asks the user whether to compile each such file,
and asks about each subdirectory as well.
</p>
<p>Interactively, <code class="code">byte-recompile-directory</code> prompts for
<var class="var">directory</var> and <var class="var">flag</var> is the prefix argument.
</p>
<p>If <var class="var">force</var> is non-<code class="code">nil</code>, this command recompiles every
&lsquo;<samp class="samp">.el</samp>&rsquo; file that has a &lsquo;<samp class="samp">.elc</samp>&rsquo; file.
</p>
<p>This command will normally not compile &lsquo;<samp class="samp">.el</samp>&rsquo; files that are
symlinked.  If the optional <var class="var">follow-symlink</var> parameter is
non-<code class="code">nil</code>, symlinked &lsquo;<samp class="samp">.el</samp>&rsquo; will also be compiled.
</p>
<p>The returned value is unpredictable.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-batch_002dbyte_002dcompile"><span class="category-def">Function: </span><span><strong class="def-name">batch-byte-compile</strong> <var class="def-var-arguments">&amp;optional noforce</var><a class="copiable-link" href="#index-batch_002dbyte_002dcompile"> &para;</a></span></dt>
<dd><p>This function runs <code class="code">byte-compile-file</code> on files specified on the
command line.  This function must be used only in a batch execution of
Emacs, as it kills Emacs on completion.  An error in one file does not
prevent processing of subsequent files, but no output file will be
generated for it, and the Emacs process will terminate with a nonzero
status code.
</p>
<p>If <var class="var">noforce</var> is non-<code class="code">nil</code>, this function does not recompile
files that have an up-to-date &lsquo;<samp class="samp">.elc</samp>&rsquo; file.
</p>
<div class="example">
<pre class="example-preformatted">$ emacs -batch -f batch-byte-compile *.el
</pre></div>
</dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Docs-and-Compilation.html">Documentation Strings and Compilation</a>, Previous: <a href="Speed-of-Byte_002dCode.html">Performance of Byte-Compiled Code</a>, Up: <a href="Byte-Compilation.html">Byte Compilation</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
