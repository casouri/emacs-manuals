<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 31.0.50.

Copyright Â© 1990-1996, 1998-2026 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>File Local Variables (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="File Local Variables (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="File Local Variables (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Variables.html" rel="up" title="Variables">
<link href="Directory-Local-Variables.html" rel="next" title="Directory Local Variables">
<link href="Buffer_002dLocal-Variables.html" rel="prev" title="Buffer-Local Variables">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="File-Local-Variables">
<div class="nav-panel">
<p>
Next: <a href="Directory-Local-Variables.html" accesskey="n" rel="next">Directory Local Variables</a>, Previous: <a href="Buffer_002dLocal-Variables.html" accesskey="p" rel="prev">Buffer-Local Variables</a>, Up: <a href="Variables.html" accesskey="u" rel="up">Variables</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="File-Local-Variables-1"><span>12.12 File Local Variables<a class="copiable-link" href="#File-Local-Variables-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-file-local-variables"></a>

<p>A file can specify local variable values; Emacs uses these to create
buffer-local bindings for those variables in the buffer visiting that
file.  See <a data-manual="emacs" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Variables.html#File-Variables">Local Variables in Files</a> in <cite class="cite">The
GNU Emacs Manual</cite>, for basic information about file-local variables.
This section describes the functions and variables that affect how
file-local variables are processed.
</p>
<p>If a file-local variable could specify an arbitrary function or Lisp
expression that would be called later, visiting a file could take over
your Emacs.  Emacs protects against this by automatically setting only
those file-local variables whose specified values are known to be
safe.  Other file-local variables are set only if the user agrees.
</p>
<p>For additional safety, <code class="code">read-circle</code> is temporarily bound to
<code class="code">nil</code> when Emacs reads file-local variables (see <a class="pxref" href="Input-Functions.html">Input Functions</a>).  This prevents the Lisp reader from recognizing circular
and shared Lisp structures (see <a class="pxref" href="Circular-Objects.html">Read Syntax for Circular Objects</a>).
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-enable_002dlocal_002dvariables"><span class="category-def">User Option: </span><span><strong class="def-name">enable-local-variables</strong><a class="copiable-link" href="#index-enable_002dlocal_002dvariables"> &para;</a></span></dt>
<dd><p>This variable controls whether to process file-local variables.
The possible values are:
</p>
<dl class="table">
<dt><code class="code">t</code> (the default)</dt>
<dd><p>Set the safe variables, and query (once) about any unsafe variables.
</p></dd>
<dt><code class="code">:safe</code></dt>
<dd><p>Set only the safe variables and do not query.
</p></dd>
<dt><code class="code">:all</code></dt>
<dd><p>Set all the variables and do not query.
</p></dd>
<dt><code class="code">nil</code></dt>
<dd><p>Don&rsquo;t set any variables.
</p></dd>
<dt>anything else</dt>
<dd><p>Query (once) about all the variables.
</p></dd>
</dl>
</dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-inhibit_002dlocal_002dvariables_002dregexps"><span class="category-def">Variable: </span><span><strong class="def-name">inhibit-local-variables-regexps</strong><a class="copiable-link" href="#index-inhibit_002dlocal_002dvariables_002dregexps"> &para;</a></span></dt>
<dd><p>This is a list of regular expressions.  If a file has a name
matching an element of this list, then it is not scanned for
any form of file-local variable.  For examples of why you might want
to use this, see <a class="pxref" href="Auto-Major-Mode.html">How Emacs Chooses a Major Mode</a>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-permanently_002denabled_002dlocal_002dvariables"><span class="category-def">Variable: </span><span><strong class="def-name">permanently-enabled-local-variables</strong><a class="copiable-link" href="#index-permanently_002denabled_002dlocal_002dvariables"> &para;</a></span></dt>
<dd><p>Some local variable settings will, by default, be heeded even if
<code class="code">enable-local-variables</code> is <code class="code">nil</code>.  By default, this is the
case only for the <code class="code">lexical-binding</code> local variable setting, but
this can be controlled by using this variable, which is a list of
symbols.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-safe_002dlocal_002dvariable_002ddirectories"><span class="category-def">Variable: </span><span><strong class="def-name">safe-local-variable-directories</strong><a class="copiable-link" href="#index-safe_002dlocal_002dvariable_002ddirectories"> &para;</a></span></dt>
<dd><p>This is a list of directories where local variables are always
enabled.  Directory-local variables loaded from these directories,
such as the variables in <samp class="file">.dir-locals.el</samp>, will be enabled even
if they are risky.  The directories in this list must be
fully-expanded absolute file names.  They may also be remote
directories if the variable <code class="code">enable-remote-dir-locals</code> is set
non-<code class="code">nil</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-hack_002dlocal_002dvariables"><span class="category-def">Function: </span><span><strong class="def-name">hack-local-variables</strong> <var class="def-var-arguments">&amp;optional handle-mode</var><a class="copiable-link" href="#index-hack_002dlocal_002dvariables"> &para;</a></span></dt>
<dd><p>This function parses, and binds or evaluates as appropriate, any local
variables specified by the contents of the current buffer.  The variable
<code class="code">enable-local-variables</code> has its effect here.  However, this
function does not look for the &lsquo;<samp class="samp">mode:</samp>&rsquo; local variable in the
&lsquo;<samp class="samp">-*-</samp>&rsquo;<!-- /@w --> line.  <code class="code">set-auto-mode</code> does that, also taking
<code class="code">enable-local-variables</code> into account (see <a class="pxref" href="Auto-Major-Mode.html">How Emacs Chooses a Major Mode</a>).
</p>
<p>This function also puts into effect directory-local variables as
specified in <samp class="file">.dir-locals.el</samp>.  If the buffer is not visiting any
file, then the directory-local variables that apply are those which
would be applicable to files in the <code class="code">default-directory</code>
(see <a class="pxref" href="Directory-Local-Variables.html">Directory Local Variables</a>).
</p>
<p>This function works by walking the alists stored in
<code class="code">file-local-variables-alist</code> and <code class="code">dir-local-variables-alist</code>
and applying each local variable in turn.  It calls
<code class="code">before-hack-local-variables-hook</code> and
<code class="code">hack-local-variables-hook</code> before and after applying the
variables, respectively.  It only calls the before-hook if
<code class="code">file-local-variables-alist</code> is non-<code class="code">nil</code>; it always calls the
other hook.  This function ignores a &lsquo;<samp class="samp">mode</samp>&rsquo; element if it specifies
the same major mode as the buffer already has.
</p>
<p>If the optional argument <var class="var">handle-mode</var> is <code class="code">t</code>, then all this
function does is return a symbol specifying the major mode, if the
&lsquo;<samp class="samp">-*-</samp>&rsquo;<!-- /@w --> line or the local variables list specifies one, and
<code class="code">nil</code> otherwise.  It does not set the mode or any other
file-local variable.  If <var class="var">handle-mode</var> has any value other than
<code class="code">nil</code> or <code class="code">t</code>, any settings of &lsquo;<samp class="samp">mode</samp>&rsquo; in the
&lsquo;<samp class="samp">-*-</samp>&rsquo;<!-- /@w --> line or the local variables list are ignored, and the
other settings are applied.  If <var class="var">handle-mode</var> is <code class="code">nil</code>, all
the file local variables are set.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-file_002dlocal_002dvariables_002dalist"><span class="category-def">Variable: </span><span><strong class="def-name">file-local-variables-alist</strong><a class="copiable-link" href="#index-file_002dlocal_002dvariables_002dalist"> &para;</a></span></dt>
<dd><p>This buffer-local variable holds the alist of file-local variable
settings.  Each element of the alist is of the form
<code class="code">(<var class="var">var</var>&nbsp;.&nbsp;<var class="var">value</var>)</code><!-- /@w -->, where <var class="var">var</var> is a symbol of
the local variable and <var class="var">value</var> is its value.  When Emacs visits a
file, it first collects all the file-local variables into this alist,
and then the <code class="code">hack-local-variables</code> function applies them one by
one.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-before_002dhack_002dlocal_002dvariables_002dhook"><span class="category-def">Variable: </span><span><strong class="def-name">before-hack-local-variables-hook</strong><a class="copiable-link" href="#index-before_002dhack_002dlocal_002dvariables_002dhook"> &para;</a></span></dt>
<dd><p>Emacs calls this hook immediately before applying file-local variables
stored in <code class="code">file-local-variables-alist</code>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-hack_002dlocal_002dvariables_002dhook"><span class="category-def">Variable: </span><span><strong class="def-name">hack-local-variables-hook</strong><a class="copiable-link" href="#index-hack_002dlocal_002dvariables_002dhook"> &para;</a></span></dt>
<dd><p>Emacs calls this hook immediately after it finishes applying
file-local variables stored in <code class="code">file-local-variables-alist</code>.
</p></dd></dl>

<a class="index-entry-id" id="index-safe-local-variable"></a>
<a class="index-entry-id" id="index-safe_002dlocal_002dvariable-_0028symbol-property_0029"></a>
<p>You can specify safe values for a variable with a
<code class="code">safe-local-variable</code> property.  The property has to be a
function of one argument; any value is safe if the function returns
non-<code class="code">nil</code> given that value.  Many commonly-encountered file
variables have <code class="code">safe-local-variable</code> properties; these include
<code class="code">fill-column</code>, <code class="code">fill-prefix</code>, and <code class="code">indent-tabs-mode</code>.
For boolean-valued variables that are safe, use <code class="code">booleanp</code> as the
property value.
</p>
<p>Since the value of <code class="code">safe-local-variable</code> is consulted when
loading files, the function should be efficient and should ideally not
lead to loading any libraries to determine the safeness (e.g., it should
not be an autoloaded function).
</p>
<p>If you want to define <code class="code">safe-local-variable</code> properties for
variables defined in C source code, add the names and the properties
of those variables to the list in the &ldquo;Safe local variables&rdquo; section
of <samp class="file">files.el</samp>.
</p>
<a class="index-entry-id" id="index-autoload-cookie_002c-and-safe-values-of-variable"></a>
<p>When defining a user option using <code class="code">defcustom</code>, you can set its
<code class="code">safe-local-variable</code> property by adding the arguments
<code class="code">:safe <var class="var">function</var></code> to <code class="code">defcustom</code> (see <a class="pxref" href="Variable-Definitions.html">Defining Customization Variables</a>).  However, a safety predicate defined using <code class="code">:safe</code>
will only be known once the package that contains the <code class="code">defcustom</code>
is loaded, which is often too late.  As an alternative, you can use
the autoload cookie (see <a class="pxref" href="Autoload.html">Autoload</a>) to assign the option its safety
predicate, like this:
</p>
<div class="example lisp">
<pre class="lisp-preformatted">;;;###autoload (put '<var class="var">var</var> 'safe-local-variable '<var class="var">pred</var>)
</pre></div>

<p>The safe value definitions specified with <code class="code">autoload</code> are copied
into the package&rsquo;s autoloads file (<samp class="file">loaddefs.el</samp> for most
packages bundled with Emacs), and are known to Emacs since the
beginning of a session.
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-safe_002dlocal_002dvariable_002dvalues"><span class="category-def">User Option: </span><span><strong class="def-name">safe-local-variable-values</strong><a class="copiable-link" href="#index-safe_002dlocal_002dvariable_002dvalues"> &para;</a></span></dt>
<dd><p>This variable provides another way to mark some variable values as
safe.  It is a list of cons cells <code class="code">(<var class="var">var</var> . <var class="var">val</var>)</code>,
where <var class="var">var</var> is a variable name and <var class="var">val</var> is a value which is
safe for that variable.
</p>
<p>When Emacs asks the user whether or not to obey a set of file-local
variable specifications, the user can choose to mark them as safe.
Doing so adds those variable/value pairs to
<code class="code">safe-local-variable-values</code>, and saves it to the user&rsquo;s custom
file.
</p></dd></dl>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-ignored_002dlocal_002dvariable_002dvalues"><span class="category-def">User Option: </span><span><strong class="def-name">ignored-local-variable-values</strong><a class="copiable-link" href="#index-ignored_002dlocal_002dvariable_002dvalues"> &para;</a></span></dt>
<dd><p>If there are some values of particular local variables that you always
want to ignore completely, you can use this variable.  Its value has
the same form as <code class="code">safe-local-variable-values</code>; a file-local
variable setting to the value that appears in the list will always be
ignored when processing the local variables specified by the file.  As
with that variable, when Emacs queries the user about whether to obey
file-local variables, the user can choose to ignore their particular
values permanently, and that will alter this variable and save it to
the user&rsquo;s custom file.  Variable-value pairs that appear in this
variable take precedence over the same pairs in
<code class="code">safe-local-variable-values</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-safe_002dlocal_002dvariable_002dp"><span class="category-def">Function: </span><span><strong class="def-name">safe-local-variable-p</strong> <var class="def-var-arguments">sym val</var><a class="copiable-link" href="#index-safe_002dlocal_002dvariable_002dp"> &para;</a></span></dt>
<dd><p>This function returns non-<code class="code">nil</code> if it is safe to give <var class="var">sym</var>
the value <var class="var">val</var>, based on the above criteria.
</p></dd></dl>

<a class="index-entry-id" id="index-risky_002dlocal_002dvariable-_0028symbol-property_0029"></a>
<p>Some variables are considered <em class="dfn">risky</em>.  If a variable is risky,
it is never entered automatically into
<code class="code">safe-local-variable-values</code>; Emacs always queries before setting
a risky variable, unless the user explicitly allows a value by
customizing <code class="code">safe-local-variable-values</code> directly.
</p>
<p>Any variable whose name has a non-<code class="code">nil</code>
<code class="code">risky-local-variable</code> property is considered risky.  When you
define a user option using <code class="code">defcustom</code>, you can set its
<code class="code">risky-local-variable</code> property by adding the arguments
<code class="code">:risky <var class="var">value</var></code> to <code class="code">defcustom</code> (see <a class="pxref" href="Variable-Definitions.html">Defining Customization Variables</a>).  In addition, any variable whose name ends in any of
&lsquo;<samp class="samp">-command</samp>&rsquo;, &lsquo;<samp class="samp">-frame-alist</samp>&rsquo;, &lsquo;<samp class="samp">-function</samp>&rsquo;,
&lsquo;<samp class="samp">-functions</samp>&rsquo;, &lsquo;<samp class="samp">-hook</samp>&rsquo;, &lsquo;<samp class="samp">-hooks</samp>&rsquo;, &lsquo;<samp class="samp">-form</samp>&rsquo;,
&lsquo;<samp class="samp">-forms</samp>&rsquo;, &lsquo;<samp class="samp">-map</samp>&rsquo;, &lsquo;<samp class="samp">-map-alist</samp>&rsquo;, &lsquo;<samp class="samp">-mode-alist</samp>&rsquo;,
&lsquo;<samp class="samp">-program</samp>&rsquo;, or &lsquo;<samp class="samp">-predicate</samp>&rsquo; is automatically considered
risky.  The variables &lsquo;<samp class="samp">font-lock-keywords</samp>&rsquo;,
&lsquo;<samp class="samp">font-lock-keywords</samp>&rsquo; followed by a digit, and
&lsquo;<samp class="samp">font-lock-syntactic-keywords</samp>&rsquo; are also considered risky.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-risky_002dlocal_002dvariable_002dp"><span class="category-def">Function: </span><span><strong class="def-name">risky-local-variable-p</strong> <var class="def-var-arguments">sym</var><a class="copiable-link" href="#index-risky_002dlocal_002dvariable_002dp"> &para;</a></span></dt>
<dd><p>This function returns non-<code class="code">nil</code> if <var class="var">sym</var> is a risky variable,
based on the above criteria.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-ignored_002dlocal_002dvariables"><span class="category-def">Variable: </span><span><strong class="def-name">ignored-local-variables</strong><a class="copiable-link" href="#index-ignored_002dlocal_002dvariables"> &para;</a></span></dt>
<dd><p>This variable holds a list of variables that should not be given local
values by files.  Any value specified for one of these variables is
completely ignored.
</p></dd></dl>

<p>The &lsquo;<samp class="samp">Eval:</samp>&rsquo; &ldquo;variable&rdquo; is also a potential loophole, so Emacs
normally asks for confirmation before handling it.
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-enable_002dlocal_002deval"><span class="category-def">User Option: </span><span><strong class="def-name">enable-local-eval</strong><a class="copiable-link" href="#index-enable_002dlocal_002deval"> &para;</a></span></dt>
<dd><p>This variable controls processing of &lsquo;<samp class="samp">Eval:</samp>&rsquo; in &lsquo;<samp class="samp">-*-</samp>&rsquo; lines
or local variables
lists in files being visited.  A value of <code class="code">t</code> means process them
unconditionally; <code class="code">nil</code> means ignore them; anything else means ask
the user what to do for each file.  The default value is <code class="code">maybe</code>.
</p></dd></dl>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-safe_002dlocal_002deval_002dforms"><span class="category-def">User Option: </span><span><strong class="def-name">safe-local-eval-forms</strong><a class="copiable-link" href="#index-safe_002dlocal_002deval_002dforms"> &para;</a></span></dt>
<dd><p>This variable holds a list of expressions that are safe to
evaluate when found in the &lsquo;<samp class="samp">Eval:</samp>&rsquo; &ldquo;variable&rdquo; in a file
local variables list.
</p></dd></dl>

<a class="index-entry-id" id="index-safe_002dlocal_002deval_002dfunction-_0028symbol-property_0029"></a>
<p>If the expression is a function call and the function has a
<code class="code">safe-local-eval-function</code> property, the property value
determines whether the expression is safe to evaluate.  The property
value can be a predicate to call to test the expression, a list of
such predicates (it&rsquo;s safe if any predicate succeeds), or <code class="code">t</code>
(always safe provided the arguments are constant).
</p>
<p>Text properties are also potential loopholes, since their values
could include functions to call.  So Emacs discards all text
properties from string values specified for file-local variables.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Directory-Local-Variables.html">Directory Local Variables</a>, Previous: <a href="Buffer_002dLocal-Variables.html">Buffer-Local Variables</a>, Up: <a href="Variables.html">Variables</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
