<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 31.0.50.

Copyright Â© 1990-1996, 1998-2025 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Programming Tips (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Programming Tips (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Programming Tips (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Tips.html" rel="up" title="Tips">
<link href="Compilation-Tips.html" rel="next" title="Compilation Tips">
<link href="Key-Binding-Conventions.html" rel="prev" title="Key Binding Conventions">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Programming-Tips">
<div class="nav-panel">
<p>
Next: <a href="Compilation-Tips.html" accesskey="n" rel="next">Tips for Making Compiled Code Fast</a>, Previous: <a href="Key-Binding-Conventions.html" accesskey="p" rel="prev">Key Binding Conventions</a>, Up: <a href="Tips.html" accesskey="u" rel="up">Tips and Conventions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Emacs-Programming-Tips"><span>D.3 Emacs Programming Tips<a class="copiable-link" href="#Emacs-Programming-Tips"> &para;</a></span></h3>
<a class="index-entry-id" id="index-programming-conventions"></a>
<a class="index-entry-id" id="index-conventions-for-Emacs-programming"></a>

<p>Following these conventions will make your program fit better
into Emacs when it runs.
</p>
<ul class="itemize mark-bullet">
<li>Don&rsquo;t use <code class="code">next-line</code> or <code class="code">previous-line</code> in programs; nearly
always, <code class="code">forward-line</code> is more convenient as well as more
predictable and robust.  See <a class="xref" href="Text-Lines.html">Motion by Text Lines</a>.

</li><li>Don&rsquo;t call functions that set the mark, unless setting the mark is one
of the intended features of your program.  The mark is a user-level
feature, so it is incorrect to change the mark except to supply a value
for the user&rsquo;s benefit.  See <a class="xref" href="The-Mark.html">The Mark</a>.

<p>In particular, don&rsquo;t use any of these functions:
</p>
<ul class="itemize mark-bullet">
<li><code class="code">beginning-of-buffer</code>, <code class="code">end-of-buffer</code>
</li><li><code class="code">replace-string</code>, <code class="code">replace-regexp</code>
</li><li><code class="code">insert-file</code>, <code class="code">insert-buffer</code>
</li></ul>

<p>If you just want to move point, or replace a certain string, or insert
a file or buffer&rsquo;s contents, without any of the other features
intended for interactive users, you can replace these functions with
one or two lines of simple Lisp code.
</p>
</li><li>Use lists rather than vectors, except when there is a particular reason
to use a vector.  Lisp has more facilities for manipulating lists than
for vectors, and working with lists is usually more convenient.

<p>Vectors are advantageous for tables that are substantial in size and are
accessed in random order (not searched front to back), provided there is
no need to insert or delete elements (only lists allow that).
</p>
</li><li>The recommended way to show a message in the echo area is with
the <code class="code">message</code> function, not <code class="code">princ</code>.  See <a class="xref" href="The-Echo-Area.html">The Echo Area</a>.

</li><li>When you encounter an error condition, call the function <code class="code">error</code>
(or <code class="code">signal</code>).  The function <code class="code">error</code> does not return.
See <a class="xref" href="Signaling-Errors.html">How to Signal an Error</a>.

<p>Don&rsquo;t use <code class="code">message</code>, <code class="code">throw</code>, <code class="code">sleep-for</code>, or
<code class="code">beep</code> to report errors.
</p>
</li><li>An error message should start with a capital letter but should not end
with a period or other punctuation.

<p>It is occasionally useful to tell the user where an error originated,
even if <code class="code">debug-on-error</code> is <code class="code">nil</code>.  In such cases, a
lower-case Lisp symbol can be prepended to the error message.  For
example, the error message &ldquo;Invalid input&rdquo; could be extended to say
&ldquo;some-function: Invalid input&rdquo;.
</p>
</li><li>A question asked in the minibuffer with <code class="code">yes-or-no-p</code> or
<code class="code">y-or-n-p</code> should start with a capital letter and end with
&lsquo;<samp class="samp">?</samp>&rsquo;.

</li><li>When you mention a default value in a minibuffer prompt,
put it and the word &lsquo;<samp class="samp">default</samp>&rsquo; inside parentheses.
It should look like this:

<div class="example">
<pre class="example-preformatted">Enter the answer (default 42):
</pre></div>

</li><li>In <code class="code">interactive</code>, if you use a Lisp expression to produce a list
of arguments, don&rsquo;t try to provide the correct default values for
region or position arguments.  Instead, provide <code class="code">nil</code> for those
arguments if they were not specified, and have the function body
compute the default value when the argument is <code class="code">nil</code>.  For
instance, write this:

<div class="example">
<pre class="example-preformatted">(defun foo (pos)
  (interactive
   (list (if <var class="var">specified</var> <var class="var">specified-pos</var>)))
  (unless pos (setq pos <var class="var">default-pos</var>))
  ...)
</pre></div>

<p>rather than this:
</p>
<div class="example">
<pre class="example-preformatted">(defun foo (pos)
  (interactive
   (list (if <var class="var">specified</var> <var class="var">specified-pos</var>
             <var class="var">default-pos</var>)))
  ...)
</pre></div>

<p>This is so that repetition of the command will recompute
these defaults based on the current circumstances.
</p>
<p>You do not need to take such precautions when you use interactive
specs &lsquo;<samp class="samp">d</samp>&rsquo;, &lsquo;<samp class="samp">m</samp>&rsquo; and &lsquo;<samp class="samp">r</samp>&rsquo;, because they make special
arrangements to recompute the argument values on repetition of the
command.
</p>
</li><li>Many commands that take a long time to execute display a message that
says something like &lsquo;<samp class="samp">Operating...</samp>&rsquo; when they start, and change it
to &lsquo;<samp class="samp">Operating...done</samp>&rsquo; when they finish.  Please keep the style of
these messages uniform: <em class="emph">no</em> space around the ellipsis, and
<em class="emph">no</em> period after &lsquo;<samp class="samp">done</samp>&rsquo;.  See <a class="xref" href="Progress.html">Reporting Operation Progress</a>, for an easy way
to generate such messages.

</li><li>Try to avoid using recursive edits.  Instead, do what the Rmail <kbd class="kbd">e</kbd>
command does: use a new local keymap that contains a command defined
to switch back to the old local keymap.  Or simply switch to another
buffer and let the user switch back at will.  See <a class="xref" href="Recursive-Editing.html">Recursive Editing</a>.
</li></ul>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Compilation-Tips.html">Tips for Making Compiled Code Fast</a>, Previous: <a href="Key-Binding-Conventions.html">Key Binding Conventions</a>, Up: <a href="Tips.html">Tips and Conventions</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
