<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 31.0.50.

Copyright Â© 1990-1996, 1998-2026 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Image Descriptors (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Image Descriptors (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Image Descriptors (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Images.html" rel="up" title="Images">
<link href="XBM-Images.html" rel="next" title="XBM Images">
<link href="Image-Formats.html" rel="prev" title="Image Formats">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.display {margin-left: 3.2em}
pre.display-preformatted {font-family: inherit}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Image-Descriptors">
<div class="nav-panel">
<p>
Next: <a href="XBM-Images.html" accesskey="n" rel="next">XBM Images</a>, Previous: <a href="Image-Formats.html" accesskey="p" rel="prev">Image Formats</a>, Up: <a href="Images.html" accesskey="u" rel="up">Images</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Image-Descriptors-1"><span>42.17.2 Image Descriptors<a class="copiable-link" href="#Image-Descriptors-1"> &para;</a></span></h4>
<a class="index-entry-id" id="index-image-descriptor"></a>

<p>An <em class="dfn">image descriptor</em> is a list which specifies the underlying
data for an image, and how to display it.  It is typically used as the
value of a <code class="code">display</code> overlay or text property (see <a class="pxref" href="Other-Display-Specs.html">Other Display Specifications</a>); but See <a class="xref" href="Showing-Images.html">Showing Images</a>, for convenient helper
functions to insert images into buffers.
</p>
<p>Each image descriptor has the form <code class="code">(image . <var class="var">props</var>)</code>,
where <var class="var">props</var> is a property list of alternating keyword symbols
and values, including at least the pair <code class="code">:type <var class="var">type</var></code> that
specifies the image type.
</p>
<p>Image descriptors which define image dimensions, <code class="code">:width</code>,
<code class="code">:height</code>, <code class="code">:max-width</code> and <code class="code">:max-height</code>, may take
either an integer, which represents the dimension in pixels, or a pair
<code class="code">(<var class="var">value</var> . em)</code>, where <var class="var">value</var> is the dimension&rsquo;s
length in <em class="dfn">ems</em><a class="footnote" id="DOCF35" href="#FOOT35"><sup>35</sup></a>.  One em is equivalent to the size of the font
and <var class="var">value</var> may be an integer or a float.  Also, dimension can be
specified in <code class="code">(<var class="var">value</var> . ch)</code> and <code class="code">(<var class="var">value</var> . cw)</code>
forms, where <code class="code">ch</code> means height of the canonical character and
<code class="code">cw</code> means width of the canonical character.
</p>
<p>The following is a list of properties that are meaningful for all
image types (there are also properties which are meaningful only for
certain image types, as documented in the following subsections):
</p>
<dl class="table">
<dt><code class="code">:type <var class="var">type</var></code></dt>
<dd><p>The image type.
See <a class="xref" href="Image-Formats.html">Image Formats</a>.
Every image descriptor must include this property.
</p>
</dd>
<dt><code class="code">:file <var class="var">file</var></code></dt>
<dd><p>This says to load the image from file <var class="var">file</var>.  If <var class="var">file</var> is
not an absolute file name, it is expanded relative to each of the
directories mentioned by <code class="code">image-load-path</code> (see <a class="pxref" href="Defining-Images.html">Defining Images</a>).
</p>
</dd>
<dt><code class="code">:data <var class="var">data</var></code></dt>
<dd><p>This specifies the raw image data.  Each image descriptor must have
either <code class="code">:data</code> or <code class="code">:file</code>, but not both.
</p>
<p>For most image types, the value of a <code class="code">:data</code> property should be a
string containing the image data.  Some image types do not support
<code class="code">:data</code>; for some others, <code class="code">:data</code> alone is not enough, so
you need to use other image properties along with <code class="code">:data</code>.  See
the following subsections for details.
</p>
</dd>
<dt><code class="code">:margin <var class="var">margin</var></code></dt>
<dd><p>This specifies how many pixels to add as an extra margin around the
image.  The value, <var class="var">margin</var>, must be a non-negative number, or a
pair <code class="code">(<var class="var">x</var> . <var class="var">y</var>)</code> of such numbers.  If it is a pair,
<var class="var">x</var> specifies how many pixels to add horizontally, and <var class="var">y</var>
specifies how many pixels to add vertically.  If <code class="code">:margin</code> is not
specified, the default is zero.
</p>
</dd>
<dt><code class="code">:ascent <var class="var">ascent</var></code></dt>
<dd><p>This specifies the amount of the image&rsquo;s height to use for its
ascent&mdash;that is, the part above the baseline.  The value,
<var class="var">ascent</var>, must be a number in the range 0 to 100, or the symbol
<code class="code">center</code>.
</p>
<p>If <var class="var">ascent</var> is a number, that percentage of the image&rsquo;s height is
used for its ascent.
</p>
<p>If <var class="var">ascent</var> is <code class="code">center</code>, the image is vertically centered
around a centerline which would be the vertical centerline of text drawn
at the position of the image, in the manner specified by the text
properties and overlays that apply to the image.
</p>
<p>If this property is omitted, it defaults to 50.
</p>
</dd>
<dt><code class="code">:relief <var class="var">relief</var></code></dt>
<dd><p>This adds a shadow rectangle around the image.  The value,
<var class="var">relief</var>, specifies the width of the shadow lines, in pixels.  If
<var class="var">relief</var> is negative, shadows are drawn so that the image appears
as a pressed button; otherwise, it appears as an unpressed button.
</p>
</dd>
<dt><code class="code">:width <var class="var">width</var>, :height <var class="var">height</var></code></dt>
<dd><p>The <code class="code">:width</code> and <code class="code">:height</code> keywords are used for scaling the
image.  If only one of them is specified, the other one will be
calculated so as to preserve the aspect ratio.  If both are specified,
aspect ratio may not be preserved.
</p>
</dd>
<dt><code class="code">:max-width <var class="var">max-width</var>, :max-height <var class="var">max-height</var></code></dt>
<dd><p>The <code class="code">:max-width</code> and <code class="code">:max-height</code> keywords are used for
scaling if the size of the image exceeds these values.  If
<code class="code">:width</code> is set, it will have precedence over <code class="code">max-width</code>,
and if <code class="code">:height</code> is set, it will have precedence over
<code class="code">max-height</code>, but you can otherwise mix these keywords as you
wish.
</p>
<p>If both <code class="code">:max-width</code> and <code class="code">:height</code> are specified, but
<code class="code">:width</code> is not, preserving the aspect ratio might require that
width exceeds <code class="code">:max-width</code>.  If this happens, scaling will use a
smaller value for the height so as to preserve the aspect ratio while
not exceeding <code class="code">:max-width</code>.  Similarly when both
<code class="code">:max-height</code> and <code class="code">:width</code> are specified, but <code class="code">:height</code>
is not.  For example, if you have a 200x100 image and specify that
<code class="code">:width</code> should be 400 and <code class="code">:max-height</code> should be 150,
you&rsquo;ll end up with an image that is 300x150: Preserving the aspect
ratio and not exceeding the &ldquo;max&rdquo; setting.  This combination of
parameters is a useful way of saying &ldquo;display this image as large as
possible, but no larger than the available display area&rdquo;.
</p>
</dd>
<dt><code class="code">:scale <var class="var">scale</var></code></dt>
<dd><p>This should be a scaling factor for the image, a number.  Values higher
than 1 mean to increase the image size, and lower values mean to
decrease the size, by multiplying both the width and height of the image
by the factor.  For instance, a value of 0.25 will make the image a
quarter size of what it originally was.  If the scaling makes the image
larger than specified by <code class="code">:max-width</code> or <code class="code">:max-height</code>, the
resulting size will not exceed those two values.  If both <code class="code">:scale</code>
and <code class="code">:height</code>/<code class="code">:width</code> are specified, the height/width will be
adjusted by the specified scaling factor.
</p>
<a class="index-entry-id" id="index-image_002dscaling_002dfactor"></a>
<p>The value of <var class="var">scale</var> can also be the symbol <code class="code">default</code>, which
means to use the value of <code class="code">image-scaling-factor</code>.  If that value is
a number, it is the scale factor to use; if it is <code class="code">auto</code> (the
default), it means to compute the scaling factor based on pixel size of
the font used by the frame&rsquo;s default face (see <a class="pxref" href="Low_002dLevel-Font.html">Low-Level Font Representation</a>).
Specifically, if the pixel width of the default face&rsquo;s font is greater
than 10, the image is enlarged by the factor computed as the ratio of
the font width to 10; if the font width is 10 pixels or less, the image
is not scaled.  For example, if the default font&rsquo;s width is 15, the
image will be scaled by the factor 1.5.
</p>
<p>If <var class="var">scale</var> is not provided, <code class="code">create-image</code> scales the image
according to the value of <code class="code">image-scaling-factor</code>.
</p>
</dd>
<dt><code class="code">:rotation <var class="var">angle</var></code></dt>
<dd><p>Specifies a rotation angle in degrees.  Only multiples of 90 degrees
are supported, unless the image type is <code class="code">imagemagick</code>.  Positive
values rotate clockwise, negative values counter-clockwise.  Rotation
is performed after scaling and cropping.
</p>
</dd>
<dt><code class="code">:flip <var class="var">flip</var></code></dt>
<dd><p>If this is <code class="code">t</code>, the image will be horizontally flipped.
Currently it has no effect if the image type is <code class="code">imagemagick</code>.
Vertical flipping can be achieved by rotating the image 180 degrees
and toggling this value.
</p>
</dd>
<dt><code class="code">:transform-smoothing <var class="var">smooth</var></code></dt>
<dd><p>If this is <code class="code">t</code>, any image transform will have smoothing applied;
if <code class="code">nil</code>, no smoothing will be applied.  The exact algorithm used
is platform dependent, but should be equivalent to bilinear
filtering.  Disabling smoothing will use the nearest neighbor
algorithm.
</p>
<a class="index-entry-id" id="index-image_002dtransform_002dsmoothing"></a>
<p>If this property is not specified, <code class="code">create-image</code> will use the
<code class="code">image-transform-smoothing</code> user option to say whether smoothing
should be done or not.  This option can be <code class="code">nil</code> (no smoothing),
<code class="code">t</code> (use smoothing) or a predicate function that&rsquo;s called with
the image object as the only parameter, and should return either
<code class="code">nil</code> or <code class="code">t</code>.  The default is for down-scaling to apply
smoothing, and for large up-scaling to not apply smoothing.
</p>
</dd>
<dt><code class="code">:index <var class="var">frame</var></code></dt>
<dd><p>See <a class="xref" href="Multi_002dFrame-Images.html">Multi-Frame Images</a>.
</p>
</dd>
<dt><code class="code">:conversion <var class="var">algorithm</var></code></dt>
<dd><p>This specifies a conversion algorithm that should be applied to the
image before it is displayed; the value, <var class="var">algorithm</var>, specifies
which algorithm.
</p>
<dl class="table">
<dt><code class="code">laplace</code></dt>
<dt><code class="code">emboss</code></dt>
<dd><p>Specifies the Laplace edge detection algorithm, which blurs out small
differences in color while highlighting larger differences.  People
sometimes consider this useful for displaying the image for a
disabled button.
</p>
</dd>
<dt><a id="index-edge-detection_002c-images"></a><span><code class="code">(edge-detection :matrix <var class="var">matrix</var> :color-adjust <var class="var">adjust</var>)</code><a class="copiable-link" href="#index-edge-detection_002c-images"> &para;</a></span></dt>
<dd><p>Specifies a general edge-detection algorithm.  <var class="var">matrix</var> must be
either a nine-element list or a nine-element vector of numbers.  A pixel
at position <em class="math">x/y</em> in the transformed image is computed from
original pixels around that position.  <var class="var">matrix</var> specifies, for each
pixel in the neighborhood of <em class="math">x/y</em>, a factor with which that pixel
will influence the transformed pixel; element <em class="math">0</em> specifies the
factor for the pixel at <em class="math">x-1/y-1</em>, element <em class="math">1</em> the factor for
the pixel at <em class="math">x/y-1</em> etc., as shown below:
</p><div class="display">
<pre class="display-preformatted">  (x-1/y-1  x/y-1  x+1/y-1
   x-1/y    x/y    x+1/y
   x-1/y+1  x/y+1  x+1/y+1)
</pre></div>

<p>The resulting pixel is computed from the color intensity of the color
resulting from summing up the RGB values of surrounding pixels,
multiplied by the specified factors, and dividing that sum by the sum
of the factors&rsquo; absolute values.
</p>
<p>Laplace edge-detection currently uses a matrix of
</p><div class="display">
<pre class="display-preformatted">  (1  0  0
   0  0  0
   0  0 -1)
</pre></div>

<p>Emboss edge-detection uses a matrix of
</p><div class="display">
<pre class="display-preformatted">  ( 2 -1  0
   -1  0  1
    0  1 -2)
</pre></div>

</dd>
<dt><code class="code">disabled</code></dt>
<dd><p>Specifies transforming the image so that it looks disabled.
</p></dd>
</dl>

</dd>
<dt><code class="code">:mask <var class="var">mask</var></code></dt>
<dd><p>If <var class="var">mask</var> is <code class="code">heuristic</code> or <code class="code">(heuristic <var class="var">bg</var>)</code>, build
a clipping mask for the image, so that the background of a frame is
visible behind the image.  If <var class="var">bg</var> is not specified, or if <var class="var">bg</var>
is <code class="code">t</code>, determine the background color of the image by looking at
the four corners of the image, assuming the most frequently occurring
color from the corners is the background color of the image.  Otherwise,
<var class="var">bg</var> must be a list <code class="code">(<var class="var">red</var> <var class="var">green</var> <var class="var">blue</var>)</code>
specifying the color to assume for the background of the image.
</p>
<p>If <var class="var">mask</var> is <code class="code">nil</code>, remove a mask from the image, if it has
one.  Images in some formats include a mask which can be removed by
specifying <code class="code">:mask nil</code>.
</p>
</dd>
<dt><code class="code">:pointer <var class="var">shape</var></code></dt>
<dd><p>This specifies the pointer shape when the mouse pointer is over this
image.  See <a class="xref" href="Pointer-Shape.html">Pointer Shape</a>, for available pointer shapes.
</p>
</dd>
<dt><a id="index-image-maps"></a><span><code class="code">:map <var class="var">map</var></code><a class="copiable-link" href="#index-image-maps"> &para;</a></span></dt>
<dd><p>This associates an image map of <em class="dfn">hot spots</em> with this image.
</p>
<p>An image map is an alist where each element has the format
<code class="code">(<var class="var">area</var> <var class="var">id</var> <var class="var">plist</var>)</code>.  An <var class="var">area</var> is specified
as either a rectangle, a circle, or a polygon.
</p>
<p>A rectangle is a cons
<code class="code">(rect . ((<var class="var">x0</var> . <var class="var">y0</var>) . (<var class="var">x1</var> . <var class="var">y1</var>)))</code>
which specifies the pixel coordinates of the upper left and bottom right
corners of the rectangle area.
</p>
<p>A circle is a cons
<code class="code">(circle . ((<var class="var">x0</var> . <var class="var">y0</var>) . <var class="var">r</var>))</code>
which specifies the center and the radius of the circle; <var class="var">r</var> may
be a float or integer.
</p>
<p>A polygon is a cons
<code class="code">(poly . [<var class="var">x0</var> <var class="var">y0</var> <var class="var">x1</var> <var class="var">y1</var> ...])</code>
where each pair in the vector describes one corner in the polygon.
</p>
<p>When the mouse pointer lies on a hot-spot area of an image, the
<var class="var">plist</var> of that hot-spot is consulted; if it contains a <code class="code">help-echo</code>
property, that defines a tool-tip for the hot-spot, and if it contains
a <code class="code">pointer</code> property, that defines the shape of the mouse cursor when
it is on the hot-spot.
See <a class="xref" href="Pointer-Shape.html">Pointer Shape</a>, for available pointer shapes.
</p>
<p>When you click the mouse when the mouse pointer is over a hot-spot, an
event is composed by combining the <var class="var">id</var> of the hot-spot with the
mouse event; for instance, <code class="code">[area4 mouse-1]</code> if the hot-spot&rsquo;s
<var class="var">id</var> is <code class="code">area4</code>.
</p>
<a class="index-entry-id" id="index-image_002dcompute_002dscaling_002dfactor"></a>
<p>Note that the map&rsquo;s coordinates should reflect the displayed image
after all transforms have been done (rotation, scaling and so on), and
also note that Emacs (by default) performs auto-scaling of images, so
to make things match up, you should either specify <code class="code">:scale 1.0</code>
when creating the image, or use the result of
<code class="code">image-compute-scaling-factor</code> to compute the elements of the
map.
</p>
<p>When an image&rsquo;s <code class="code">:scale</code>, <code class="code">:rotation</code>, or <code class="code">:flip</code> is
changed, <code class="code">:map</code> will be recomputed based on the value of
<code class="code">:original-map</code> and the values of those transformation.
</p>
</dd>
<dt><a id="index-original-image-map"></a><span><code class="code">:original-map <var class="var">original-map</var></code><a class="copiable-link" href="#index-original-image-map"> &para;</a></span></dt>
<dd><p>This specifies the untransformed image map which will be used to
recompute <code class="code">:map</code> after the image&rsquo;s <code class="code">:scale</code>, <code class="code">:rotation</code>,
or <code class="code">:flip</code> is changed.
</p>
<p>If <code class="code">:original-map</code> is not specified when creating an image with
<code class="code">create-image</code>, it will be computed based on the supplied
<code class="code">:map</code>, as well as any of <code class="code">:scale</code>, <code class="code">:rotation</code>, or
<code class="code">:flip</code> which are non-<code class="code">nil</code>.
</p>
<p>Conversely, if <code class="code">:original-map</code> is specified but <code class="code">:map</code> is not,
<code class="code">:map</code> will be computed based on <code class="code">:original-map</code>,
<code class="code">:scale</code>, <code class="code">:rotation</code>, and <code class="code">:flip</code>.
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-image_002drecompute_002dmap_002dp"><span class="category-def">User Option: </span><span><strong class="def-name">image-recompute-map-p</strong><a class="copiable-link" href="#index-image_002drecompute_002dmap_002dp"> &para;</a></span></dt>
<dd><p>Set this user option to nil to prevent Emacs from automatically
recomputing an image <code class="code">:map</code> based on its <code class="code">:original-map</code>.
</p></dd></dl>
</dd>
</dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-image_002dmask_002dp"><span class="category-def">Function: </span><span><strong class="def-name">image-mask-p</strong> <var class="def-var-arguments">spec &amp;optional frame</var><a class="copiable-link" href="#index-image_002dmask_002dp"> &para;</a></span></dt>
<dd><p>This function returns <code class="code">t</code> if image <var class="var">spec</var> has a mask bitmap.
<var class="var">frame</var> is the frame on which the image will be displayed.
<var class="var">frame</var> <code class="code">nil</code> or omitted means to use the selected frame
(see <a class="pxref" href="Input-Focus.html">Input Focus</a>).
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-image_002dtransforms_002dp"><span class="category-def">Function: </span><span><strong class="def-name">image-transforms-p</strong> <var class="def-var-arguments">&amp;optional frame</var><a class="copiable-link" href="#index-image_002dtransforms_002dp"> &para;</a></span></dt>
<dd><p>This function returns non-<code class="code">nil</code> if <var class="var">frame</var> supports image
scaling and rotation.  <var class="var">frame</var> <code class="code">nil</code> or omitted means to use
the selected frame (see <a class="pxref" href="Input-Focus.html">Input Focus</a>).  The returned list includes
symbols that indicate which image transform operations are supported:
</p>
<dl class="table">
<dt><code class="code">scale</code></dt>
<dd><p>Image scaling is supported by <var class="var">frame</var> via the <code class="code">:scale</code>,
<code class="code">:width</code>, <code class="code">:height</code>, <code class="code">:max-width</code>, and
<code class="code">:max-height</code> properties.
</p></dd>
<dt><code class="code">rotate90</code></dt>
<dd><p>Image rotation is supported by <var class="var">frame</var> if the rotation angle is an
integral multiple of 90 degrees.
</p></dd>
</dl>

<p>If image transforms are not supported, <code class="code">:rotation</code>, <code class="code">:crop</code>,
<code class="code">:width</code>, <code class="code">:height</code>, <code class="code">:scale</code>, <code class="code">:max-width</code> and
<code class="code">:max-height</code> will only be usable through ImageMagick, if
available (see <a class="pxref" href="ImageMagick-Images.html">ImageMagick Images</a>).
</p></dd></dl>
</div>
<div class="footnotes-segment">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT35" href="#DOCF35">(35)</a></h5>
<p>In typography an em is a distance
equivalent to the height of the type.  For example when using 12 point
type 1 em is equal to 12 points.  Its use ensures distances and type
remain proportional.</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="XBM-Images.html">XBM Images</a>, Previous: <a href="Image-Formats.html">Image Formats</a>, Up: <a href="Images.html">Images</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
