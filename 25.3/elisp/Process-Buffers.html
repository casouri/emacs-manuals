<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 25.3.

Copyright Â© 1990-1996, 1998-2017 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Process Buffers (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Process Buffers (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Process Buffers (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Output-from-Processes.html" rel="up" title="Output from Processes">
<link href="Filter-Functions.html" rel="next" title="Filter Functions">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Process-Buffers">
<div class="nav-panel">
<p>
Next: <a href="Filter-Functions.html" accesskey="n" rel="next">Process Filter Functions</a>, Up: <a href="Output-from-Processes.html" accesskey="u" rel="up">Receiving Output from Processes</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Process-Buffers-1"><span>36.9.1 Process Buffers<a class="copiable-link" href="#Process-Buffers-1"> &para;</a></span></h4>

<p>A process can (and usually does) have an <em class="dfn">associated buffer</em>,
which is an ordinary Emacs buffer that is used for two purposes: storing
the output from the process, and deciding when to kill the process.  You
can also use the buffer to identify a process to operate on, since in
normal practice only one process is associated with any given buffer.
Many applications of processes also use the buffer for editing input to
be sent to the process, but this is not built into Emacs Lisp.
</p>
<p>By default, process output is inserted in the associated buffer.
(You can change this by defining a custom filter function,
see <a class="pxref" href="Filter-Functions.html">Process Filter Functions</a>.)  The position to insert the output is
determined by the <code class="code">process-mark</code>, which is then updated to point
to the end of the text just inserted.  Usually, but not always, the
<code class="code">process-mark</code> is at the end of the buffer.
</p>
<a class="index-entry-id" id="index-process_002dkill_002dbuffer_002dquery_002dfunction"></a>
<p>Killing the associated buffer of a process also kills the process.
Emacs asks for confirmation first, if the process&rsquo;s
<code class="code">process-query-on-exit-flag</code> is non-<code class="code">nil</code> (see <a class="pxref" href="Query-Before-Exit.html">Querying Before Exit</a>).  This confirmation is done by the function
<code class="code">process-kill-buffer-query-function</code>, which is run from
<code class="code">kill-buffer-query-functions</code> (see <a class="pxref" href="Killing-Buffers.html">Killing Buffers</a>).
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-process_002dbuffer"><span class="category-def">Function: </span><span><strong class="def-name">process-buffer</strong> <var class="def-var-arguments">process</var><a class="copiable-link" href="#index-process_002dbuffer"> &para;</a></span></dt>
<dd><p>This function returns the associated buffer of the specified
<var class="var">process</var>.
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">(process-buffer (get-process &quot;shell&quot;))
     &rArr; #&lt;buffer *shell*&gt;
</pre></div></div>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-process_002dmark"><span class="category-def">Function: </span><span><strong class="def-name">process-mark</strong> <var class="def-var-arguments">process</var><a class="copiable-link" href="#index-process_002dmark"> &para;</a></span></dt>
<dd><p>This function returns the process marker for <var class="var">process</var>, which is the
marker that says where to insert output from the process.
</p>
<p>If <var class="var">process</var> does not have a buffer, <code class="code">process-mark</code> returns a
marker that points nowhere.
</p>
<p>The default filter function uses this marker to decide where to
insert process output, and updates it to point after the inserted text.
That is why successive batches of output are inserted consecutively.
</p>
<p>Custom filter functions normally should use this marker in the same fashion.
For an example of a filter function that uses <code class="code">process-mark</code>,
see <a class="pxref" href="Filter-Functions.html#Process-Filter-Example">Process Filter Example</a>.
</p>
<p>When the user is expected to enter input in the process buffer for
transmission to the process, the process marker separates the new input
from previous output.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-set_002dprocess_002dbuffer"><span class="category-def">Function: </span><span><strong class="def-name">set-process-buffer</strong> <var class="def-var-arguments">process buffer</var><a class="copiable-link" href="#index-set_002dprocess_002dbuffer"> &para;</a></span></dt>
<dd><p>This function sets the buffer associated with <var class="var">process</var> to
<var class="var">buffer</var>.  If <var class="var">buffer</var> is <code class="code">nil</code>, the process becomes
associated with no buffer.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-get_002dbuffer_002dprocess"><span class="category-def">Function: </span><span><strong class="def-name">get-buffer-process</strong> <var class="def-var-arguments">buffer-or-name</var><a class="copiable-link" href="#index-get_002dbuffer_002dprocess"> &para;</a></span></dt>
<dd><p>This function returns a nondeleted process associated with the buffer
specified by <var class="var">buffer-or-name</var>.  If there are several processes
associated with it, this function chooses one (currently, the one most
recently created, but don&rsquo;t count on that).  Deletion of a process
(see <code class="code">delete-process</code>) makes it ineligible for this function to
return.
</p>
<p>It is usually a bad idea to have more than one process associated with
the same buffer.
</p>
<div class="example smallexample">
<div class="group"><pre class="example-preformatted">(get-buffer-process &quot;*shell*&quot;)
     &rArr; #&lt;process shell&gt;
</pre></div></div>

<p>Killing the process&rsquo;s buffer deletes the process, which kills the
subprocess with a <code class="code">SIGHUP</code> signal (see <a class="pxref" href="Signals-to-Processes.html">Sending Signals to Processes</a>).
</p></dd></dl>

<p>If the process&rsquo;s buffer is displayed in a window, your Lisp program
may wish to tell the process the dimensions of that window, so that
the process could adapt its output to those dimensions, much as it
adapts to the screen dimensions.  The following functions allow
communicating this kind of information to processes; however, not all
systems support the underlying functionality, so it is best to provide
fallbacks, e.g., via command-line arguments or environment variables.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-set_002dprocess_002dwindow_002dsize"><span class="category-def">Function: </span><span><strong class="def-name">set-process-window-size</strong> <var class="def-var-arguments">process height width</var><a class="copiable-link" href="#index-set_002dprocess_002dwindow_002dsize"> &para;</a></span></dt>
<dd><p>Tell <var class="var">process</var> that its logical window size has dimensions
<var class="var">width</var> by <var class="var">height</var>, in character units.  If this function
succeeds in communicating this information to the process, it returns
<code class="code">t</code>; otherwise it returns <code class="code">nil</code>.
</p></dd></dl>

<p>When windows that display buffers associated with process change their
dimensions, the affected processes should be told about these changes.
By default, when the window configuration changes, Emacs will
automatically call <code class="code">set-process-window-size</code> on behalf of every
process whose buffer is displayed in a window, passing it the smallest
dimensions of all the windows displaying the process&rsquo;s buffer.  This
works via <code class="code">window-configuration-change-hook</code> (see <a class="pxref" href="Window-Hooks.html">Hooks for Window Scrolling and Changes</a>), which is told to invoke the function that is the value of
the variable <code class="code">window-adjust-process-window-size-function</code> for
each process whose buffer is displayed in at least one window.  You
can customize this behavior by setting the value of that variable.
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-window_002dadjust_002dprocess_002dwindow_002dsize_002dfunction"><span class="category-def">User Option: </span><span><strong class="def-name">window-adjust-process-window-size-function</strong><a class="copiable-link" href="#index-window_002dadjust_002dprocess_002dwindow_002dsize_002dfunction"> &para;</a></span></dt>
<dd><p>The value of this variable should be a function of two arguments: a
process and the list of windows displaying the process&rsquo;s buffer.  When
the function is called, the process&rsquo;s buffer is the current buffer.
The function should return a cons cell <code class="code">(<var class="var">width</var>&nbsp;.&nbsp;<var class="var">height</var>)</code><!-- /@w --> that describes the dimensions of the logical process
window to be passed via a call to <code class="code">set-process-window-size</code>.  The
function can also return <code class="code">nil</code>, in which case Emacs will not call
<code class="code">set-process-window-size</code> for this process.
</p>
<p>Emacs supplies two predefined values for this variable:
<code class="code">window-adjust-process-window-size-smallest</code>, which returns the
smallest of all the dimensions of the windows that display a process&rsquo;s
buffer; and <code class="code">window-adjust-process-window-size-largest</code>, which
returns the largest dimensions.  For more complex strategies, write
your own function.
</p>
<p>This variable can be buffer-local.
</p></dd></dl>

<p>If the process has the <code class="code">adjust-window-size-function</code> property
(see <a class="pxref" href="Process-Information.html">Process Information</a>), its value overrides the global and
buffer-local values of
<code class="code">window-adjust-process-window-size-function</code>.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Filter-Functions.html">Process Filter Functions</a>, Up: <a href="Output-from-Processes.html">Receiving Output from Processes</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
