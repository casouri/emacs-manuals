<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 25.3.

Copyright Â© 1990-1996, 1998-2017 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>How Programs Do Loading (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="How Programs Do Loading (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="How Programs Do Loading (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Loading.html" rel="up" title="Loading">
<link href="Load-Suffixes.html" rel="next" title="Load Suffixes">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="How-Programs-Do-Loading">
<div class="nav-panel">
<p>
Next: <a href="Load-Suffixes.html" accesskey="n" rel="next">Load Suffixes</a>, Up: <a href="Loading.html" accesskey="u" rel="up">Loading</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="How-Programs-Do-Loading-1"><span>15.1 How Programs Do Loading<a class="copiable-link" href="#How-Programs-Do-Loading-1"> &para;</a></span></h3>

<p>Emacs Lisp has several interfaces for loading.  For example,
<code class="code">autoload</code> creates a placeholder object for a function defined in a
file; trying to call the autoloading function loads the file to get the
function&rsquo;s real definition (see <a class="pxref" href="Autoload.html">Autoload</a>).  <code class="code">require</code> loads a
file if it isn&rsquo;t already loaded (see <a class="pxref" href="Named-Features.html">Features</a>).  Ultimately,
all these facilities call the <code class="code">load</code> function to do the work.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-load"><span class="category-def">Function: </span><span><strong class="def-name">load</strong> <var class="def-var-arguments">filename &amp;optional missing-ok nomessage nosuffix must-suffix</var><a class="copiable-link" href="#index-load"> &para;</a></span></dt>
<dd><p>This function finds and opens a file of Lisp code, evaluates all the
forms in it, and closes the file.
</p>
<p>To find the file, <code class="code">load</code> first looks for a file named
<samp class="file"><var class="var">filename</var>.elc</samp>, that is, for a file whose name is
<var class="var">filename</var> with the extension &lsquo;<samp class="samp">.elc</samp>&rsquo; appended.  If such a
file exists, it is loaded.  If there is no file by that name, then
<code class="code">load</code> looks for a file named <samp class="file"><var class="var">filename</var>.el</samp>.  If that
file exists, it is loaded.  If Emacs was compiled with support for
dynamic modules (see <a class="pxref" href="Dynamic-Modules.html">Emacs Dynamic Modules</a>), <code class="code">load</code> next looks for
a file named <samp class="file"><var class="var">filename</var>.<var class="var">ext</var></samp>, where <var class="var">ext</var> is a
system-dependent file-name extension of shared libraries.  Finally, if
neither of those names is found, <code class="code">load</code> looks for a file named
<var class="var">filename</var> with nothing appended, and loads it if it exists.  (The
<code class="code">load</code> function is not clever about looking at <var class="var">filename</var>.
In the perverse case of a file named <samp class="file">foo.el.el</samp>, evaluation of
<code class="code">(load &quot;foo.el&quot;)</code> will indeed find it.)
</p>
<p>If Auto Compression mode is enabled, as it is by default, then if
<code class="code">load</code> can not find a file, it searches for a compressed version
of the file before trying other file names.  It decompresses and loads
it if it exists.  It looks for compressed versions by appending each
of the suffixes in <code class="code">jka-compr-load-suffixes</code> to the file name.
The value of this variable must be a list of strings.  Its standard
value is <code class="code">(&quot;.gz&quot;)</code>.
</p>
<p>If the optional argument <var class="var">nosuffix</var> is non-<code class="code">nil</code>, then
<code class="code">load</code> does not try the suffixes &lsquo;<samp class="samp">.elc</samp>&rsquo; and &lsquo;<samp class="samp">.el</samp>&rsquo;.  In
this case, you must specify the precise file name you want, except
that, if Auto Compression mode is enabled, <code class="code">load</code> will still use
<code class="code">jka-compr-load-suffixes</code> to find compressed versions.  By
specifying the precise file name and using <code class="code">t</code> for
<var class="var">nosuffix</var>, you can prevent file names like <samp class="file">foo.el.el</samp> from
being tried.
</p>
<p>If the optional argument <var class="var">must-suffix</var> is non-<code class="code">nil</code>, then
<code class="code">load</code> insists that the file name used must end in either
&lsquo;<samp class="samp">.el</samp>&rsquo; or &lsquo;<samp class="samp">.elc</samp>&rsquo; (possibly extended with a compression
suffix) or the shared-library extension, unless it contains an
explicit directory name.
</p>
<p>If the option <code class="code">load-prefer-newer</code> is non-<code class="code">nil</code>, then when
searching suffixes, <code class="code">load</code> selects whichever version of a file
(&lsquo;<samp class="samp">.elc</samp>&rsquo;, &lsquo;<samp class="samp">.el</samp>&rsquo;, etc.) has been modified most recently.
</p>
<p>If <var class="var">filename</var> is a relative file name, such as <samp class="file">foo</samp> or
<samp class="file">baz/foo.bar</samp>, <code class="code">load</code> searches for the file using the variable
<code class="code">load-path</code>.  It appends <var class="var">filename</var> to each of the directories
listed in <code class="code">load-path</code>, and loads the first file it finds whose name
matches.  The current default directory is tried only if it is specified
in <code class="code">load-path</code>, where <code class="code">nil</code> stands for the default directory.
<code class="code">load</code> tries all three possible suffixes in the first directory in
<code class="code">load-path</code>, then all three suffixes in the second directory, and
so on.  See <a class="xref" href="Library-Search.html">Library Search</a>.
</p>
<p>Whatever the name under which the file is eventually found, and the
directory where Emacs found it, Emacs sets the value of the variable
<code class="code">load-file-name</code> to that file&rsquo;s name.
</p>
<p>If you get a warning that <samp class="file">foo.elc</samp> is older than <samp class="file">foo.el</samp>, it
means you should consider recompiling <samp class="file">foo.el</samp>.  See <a class="xref" href="Byte-Compilation.html">Byte Compilation</a>.
</p>
<p>When loading a source file (not compiled), <code class="code">load</code> performs
character set translation just as Emacs would do when visiting the file.
See <a class="xref" href="Coding-Systems.html">Coding Systems</a>.
</p>
<a class="index-entry-id" id="index-eager-macro-expansion"></a>
<p>When loading an uncompiled file, Emacs tries to expand any macros
that the file contains (see <a class="pxref" href="Macros.html">Macros</a>).  We refer to this as
<em class="dfn">eager macro expansion</em>.  Doing this (rather than deferring
the expansion until the relevant code runs) can significantly speed
up the execution of uncompiled code.  Sometimes, this macro expansion
cannot be done, owing to a cyclic dependency.  In the simplest
example of this, the file you are loading refers to a macro defined
in another file, and that file in turn requires the file you are
loading.  This is generally harmless.  Emacs prints a warning
(&lsquo;<samp class="samp">Eager macro-expansion skipped due to cycle&hellip;</samp>&rsquo;)
giving details of the problem, but it still loads the file, just
leaving the macro unexpanded for now.  You may wish to restructure
your code so that this does not happen.  Loading a compiled file does
not cause macroexpansion, because this should already have happened
during compilation.  See <a class="xref" href="Compiling-Macros.html">Macros and Byte Compilation</a>.
</p>
<p>Messages like &lsquo;<samp class="samp">Loading foo...</samp>&rsquo; and &lsquo;<samp class="samp">Loading foo...done</samp>&rsquo; appear
in the echo area during loading unless <var class="var">nomessage</var> is
non-<code class="code">nil</code>.
</p>
<a class="index-entry-id" id="index-load-errors"></a>
<p>Any unhandled errors while loading a file terminate loading.  If the
load was done for the sake of <code class="code">autoload</code>, any function definitions
made during the loading are undone.
</p>
<a class="index-entry-id" id="index-file_002derror"></a>
<p>If <code class="code">load</code> can&rsquo;t find the file to load, then normally it signals the
error <code class="code">file-error</code> (with &lsquo;<samp class="samp">Cannot open load file
<var class="var">filename</var></samp>&rsquo;).  But if <var class="var">missing-ok</var> is non-<code class="code">nil</code>, then
<code class="code">load</code> just returns <code class="code">nil</code>.
</p>
<p>You can use the variable <code class="code">load-read-function</code> to specify a function
for <code class="code">load</code> to use instead of <code class="code">read</code> for reading expressions.
See below.
</p>
<p><code class="code">load</code> returns <code class="code">t</code> if the file loads successfully.
</p></dd></dl>

<dl class="first-deffn">
<dt class="deffn" id="index-load_002dfile"><span class="category-def">Command: </span><span><strong class="def-name">load-file</strong> <var class="def-var-arguments">filename</var><a class="copiable-link" href="#index-load_002dfile"> &para;</a></span></dt>
<dd><p>This command loads the file <var class="var">filename</var>.  If <var class="var">filename</var> is a
relative file name, then the current default directory is assumed.
This command does not use <code class="code">load-path</code>, and does not append
suffixes.  However, it does look for compressed versions (if Auto
Compression Mode is enabled).  Use this command if you wish to specify
precisely the file name to load.
</p></dd></dl>

<dl class="first-deffn">
<dt class="deffn" id="index-load_002dlibrary"><span class="category-def">Command: </span><span><strong class="def-name">load-library</strong> <var class="def-var-arguments">library</var><a class="copiable-link" href="#index-load_002dlibrary"> &para;</a></span></dt>
<dd><p>This command loads the library named <var class="var">library</var>.  It is equivalent to
<code class="code">load</code>, except for the way it reads its argument interactively.
See <a data-manual="emacs" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Libraries.html#Lisp-Libraries">Lisp Libraries</a> in <cite class="cite">The GNU Emacs Manual</cite>.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-load_002din_002dprogress"><span class="category-def">Variable: </span><span><strong class="def-name">load-in-progress</strong><a class="copiable-link" href="#index-load_002din_002dprogress"> &para;</a></span></dt>
<dd><p>This variable is non-<code class="code">nil</code> if Emacs is in the process of loading a
file, and it is <code class="code">nil</code> otherwise.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-load_002dfile_002dname"><span class="category-def">Variable: </span><span><strong class="def-name">load-file-name</strong><a class="copiable-link" href="#index-load_002dfile_002dname"> &para;</a></span></dt>
<dd><p>When Emacs is in the process of loading a file, this variable&rsquo;s value
is the name of that file, as Emacs found it during the search
described earlier in this section.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-load_002dread_002dfunction"><span class="category-def">Variable: </span><span><strong class="def-name">load-read-function</strong><a class="copiable-link" href="#index-load_002dread_002dfunction"> &para;</a></span></dt>
<dd><a class="anchor" id="Definition-of-load_002dread_002dfunction"></a><p>This variable specifies an alternate expression-reading function for
<code class="code">load</code> and <code class="code">eval-region</code> to use instead of <code class="code">read</code>.
The function should accept one argument, just as <code class="code">read</code> does.
</p>
<p>By default, this variable&rsquo;s value is <code class="code">read</code>.  See <a class="xref" href="Input-Functions.html">Input Functions</a>.
</p>
<p>Instead of using this variable, it is cleaner to use another, newer
feature: to pass the function as the <var class="var">read-function</var> argument to
<code class="code">eval-region</code>.  See <a class="xref" href="Eval.html#Definition-of-eval_002dregion">Eval</a>.
</p></dd></dl>

<p>For information about how <code class="code">load</code> is used in building Emacs, see
<a class="ref" href="Building-Emacs.html">Building Emacs</a>.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Load-Suffixes.html">Load Suffixes</a>, Up: <a href="Loading.html">Loading</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
