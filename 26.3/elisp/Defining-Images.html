<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 26.3.

Copyright Â© 1990-1996, 1998-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Defining Images (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Defining Images (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Defining Images (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Images.html" rel="up" title="Images">
<link href="Showing-Images.html" rel="next" title="Showing Images">
<link href="Other-Image-Types.html" rel="prev" title="Other Image Types">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Defining-Images">
<div class="nav-panel">
<p>
Next: <a href="Showing-Images.html" accesskey="n" rel="next">Showing Images</a>, Previous: <a href="Other-Image-Types.html" accesskey="p" rel="prev">Other Image Types</a>, Up: <a href="Images.html" accesskey="u" rel="up">Images</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Defining-Images-1"><span>39.17.8 Defining Images<a class="copiable-link" href="#Defining-Images-1"> &para;</a></span></h4>
<a class="index-entry-id" id="index-define-image"></a>

<p>The functions <code class="code">create-image</code>, <code class="code">defimage</code> and
<code class="code">find-image</code> provide convenient ways to create image descriptors.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-create_002dimage"><span class="category-def">Function: </span><span><strong class="def-name">create-image</strong> <var class="def-var-arguments">file-or-data &amp;optional type data-p &amp;rest props</var><a class="copiable-link" href="#index-create_002dimage"> &para;</a></span></dt>
<dd><p>This function creates and returns an image descriptor which uses the
data in <var class="var">file-or-data</var>.  <var class="var">file-or-data</var> can be a file name or
a string containing the image data; <var class="var">data-p</var> should be <code class="code">nil</code>
for the former case, non-<code class="code">nil</code> for the latter case.
</p>
<p>The optional argument <var class="var">type</var> is a symbol specifying the image type.
If <var class="var">type</var> is omitted or <code class="code">nil</code>, <code class="code">create-image</code> tries to
determine the image type from the file&rsquo;s first few bytes, or else
from the file&rsquo;s name.
</p>
<p>The remaining arguments, <var class="var">props</var>, specify additional image
properties&mdash;for example,
</p>
<div class="example">
<pre class="example-preformatted">(create-image &quot;foo.xpm&quot; 'xpm nil :heuristic-mask t)
</pre></div>

<p>The function returns <code class="code">nil</code> if images of this type are not
supported.  Otherwise it returns an image descriptor.
</p></dd></dl>

<dl class="first-deffn first-defmac-alias-first-deffn">
<dt class="deffn defmac-alias-deffn" id="index-defimage"><span class="category-def">Macro: </span><span><strong class="def-name">defimage</strong> <var class="def-var-arguments">symbol specs &amp;optional doc</var><a class="copiable-link" href="#index-defimage"> &para;</a></span></dt>
<dd><p>This macro defines <var class="var">symbol</var> as an image name.  The arguments
<var class="var">specs</var> is a list which specifies how to display the image.
The third argument, <var class="var">doc</var>, is an optional documentation string.
</p>
<p>Each argument in <var class="var">specs</var> has the form of a property list, and each
one should specify at least the <code class="code">:type</code> property and either the
<code class="code">:file</code> or the <code class="code">:data</code> property.  The value of <code class="code">:type</code>
should be a symbol specifying the image type, the value of
<code class="code">:file</code> is the file to load the image from, and the value of
<code class="code">:data</code> is a string containing the actual image data.  Here is an
example:
</p>
<div class="example">
<pre class="example-preformatted">(defimage test-image
  ((:type xpm :file &quot;~/test1.xpm&quot;)
   (:type xbm :file &quot;~/test1.xbm&quot;)))
</pre></div>

<p><code class="code">defimage</code> tests each argument, one by one, to see if it is
usable&mdash;that is, if the type is supported and the file exists.  The
first usable argument is used to make an image descriptor which is
stored in <var class="var">symbol</var>.
</p>
<p>If none of the alternatives will work, then <var class="var">symbol</var> is defined
as <code class="code">nil</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-image_002dproperty"><span class="category-def">Function: </span><span><strong class="def-name">image-property</strong> <var class="def-var-arguments">image property</var><a class="copiable-link" href="#index-image_002dproperty"> &para;</a></span></dt>
<dd><p>Return the value of <var class="var">property</var> in <var class="var">image</var>.  Properties can be
set by using <code class="code">setf</code>.  Setting a property to <code class="code">nil</code> will
remove the property from the image.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-find_002dimage"><span class="category-def">Function: </span><span><strong class="def-name">find-image</strong> <var class="def-var-arguments">specs</var><a class="copiable-link" href="#index-find_002dimage"> &para;</a></span></dt>
<dd><p>This function provides a convenient way to find an image satisfying one
of a list of image specifications <var class="var">specs</var>.
</p>
<p>Each specification in <var class="var">specs</var> is a property list with contents
depending on image type.  All specifications must at least contain the
properties <code class="code">:type <var class="var">type</var></code> and either <code class="code">:file&nbsp;<var class="var">file</var></code><!-- /@w -->
or <code class="code">:data&nbsp;<var class="var">data</var></code><!-- /@w -->, where <var class="var">type</var> is a symbol specifying
the image type, e.g., <code class="code">xbm</code>, <var class="var">file</var> is the file to load the
image from, and <var class="var">data</var> is a string containing the actual image data.
The first specification in the list whose <var class="var">type</var> is supported, and
<var class="var">file</var> exists, is used to construct the image specification to be
returned.  If no specification is satisfied, <code class="code">nil</code> is returned.
</p>
<p>The image is looked for in <code class="code">image-load-path</code>.
</p></dd></dl>

<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-image_002dload_002dpath"><span class="category-def">User Option: </span><span><strong class="def-name">image-load-path</strong><a class="copiable-link" href="#index-image_002dload_002dpath"> &para;</a></span></dt>
<dd><p>This variable&rsquo;s value is a list of locations in which to search for
image files.  If an element is a string or a variable symbol whose
value is a string, the string is taken to be the name of a directory
to search.  If an element is a variable symbol whose value is a list,
that is taken to be a list of directories to search.
</p>
<p>The default is to search in the <samp class="file">images</samp> subdirectory of the
directory specified by <code class="code">data-directory</code>, then the directory
specified by <code class="code">data-directory</code>, and finally in the directories in
<code class="code">load-path</code>.  Subdirectories are not automatically included in
the search, so if you put an image file in a subdirectory, you have to
supply the subdirectory explicitly.  For example, to find the
image <samp class="file">images/foo/bar.xpm</samp> within <code class="code">data-directory</code>, you
should specify the image as follows:
</p>
<div class="example">
<pre class="example-preformatted">(defimage foo-image '((:type xpm :file &quot;foo/bar.xpm&quot;)))
</pre></div>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-image_002dload_002dpath_002dfor_002dlibrary"><span class="category-def">Function: </span><span><strong class="def-name">image-load-path-for-library</strong> <var class="def-var-arguments">library image &amp;optional path no-error</var><a class="copiable-link" href="#index-image_002dload_002dpath_002dfor_002dlibrary"> &para;</a></span></dt>
<dd><p>This function returns a suitable search path for images used by the
Lisp package <var class="var">library</var>.
</p>
<p>The function searches for <var class="var">image</var> first using <code class="code">image-load-path</code>,
excluding <samp class="file"><code class="code">data-directory</code>/images</samp>, and then in
<code class="code">load-path</code>, followed by a path suitable for <var class="var">library</var>, which
includes <samp class="file">../../etc/images</samp> and <samp class="file">../etc/images</samp> relative to
the library file itself, and finally in
<samp class="file"><code class="code">data-directory</code>/images</samp>.
</p>
<p>Then this function returns a list of directories which contains first
the directory in which <var class="var">image</var> was found, followed by the value of
<code class="code">load-path</code>.  If <var class="var">path</var> is given, it is used instead of
<code class="code">load-path</code>.
</p>
<p>If <var class="var">no-error</var> is non-<code class="code">nil</code> and a suitable path can&rsquo;t be
found, don&rsquo;t signal an error.  Instead, return a list of directories as
before, except that <code class="code">nil</code> appears in place of the image directory.
</p>
<p>Here is an example of using <code class="code">image-load-path-for-library</code>:
</p>
<div class="example">
<pre class="example-preformatted">(defvar image-load-path) ; shush compiler
(let* ((load-path (image-load-path-for-library
                    &quot;mh-e&quot; &quot;mh-logo.xpm&quot;))
       (image-load-path (cons (car load-path)
                              image-load-path)))
  (mh-tool-bar-folder-buttons-init))
</pre></div>
</dd></dl>

<a class="index-entry-id" id="index-image_002dscaling_002dfactor"></a>
<p>Images are automatically scaled when created based on the
<code class="code">image-scaling-factor</code> variable.  The value is either a floating
point number (where numbers higher than 1 means to increase the size
and lower means to shrink the size), or the symbol <code class="code">auto</code>, which
will compute a scaling factor based on the font pixel size.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Showing-Images.html">Showing Images</a>, Previous: <a href="Other-Image-Types.html">Other Image Types</a>, Up: <a href="Images.html">Images</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
