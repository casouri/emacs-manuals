<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 26.3.

Copyright Â© 1990-1996, 1998-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Invisible Text (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Invisible Text (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Invisible Text (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Display.html" rel="up" title="Display">
<link href="Selective-Display.html" rel="next" title="Selective Display">
<link href="Warnings.html" rel="prev" title="Warnings">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span.r {font-family: initial; font-weight: normal; font-style: normal}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Invisible-Text">
<div class="nav-panel">
<p>
Next: <a href="Selective-Display.html" accesskey="n" rel="next">Selective Display</a>, Previous: <a href="Warnings.html" accesskey="p" rel="prev">Reporting Warnings</a>, Up: <a href="Display.html" accesskey="u" rel="up">Emacs Display</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Invisible-Text-1"><span>39.6 Invisible Text<a class="copiable-link" href="#Invisible-Text-1"> &para;</a></span></h3>

<a class="index-entry-id" id="index-invisible-text"></a>
<p>You can make characters <em class="dfn">invisible</em>, so that they do not appear on
the screen, with the <code class="code">invisible</code> property.  This can be either a
text property (see <a class="pxref" href="Text-Properties.html">Text Properties</a>) or an overlay property
(see <a class="pxref" href="Overlays.html">Overlays</a>).  Cursor motion also partly ignores these
characters; if the command loop finds that point is inside a range of
invisible text after a command, it relocates point to the other side
of the text.
</p>
<p>In the simplest case, any non-<code class="code">nil</code> <code class="code">invisible</code> property makes
a character invisible.  This is the default case&mdash;if you don&rsquo;t alter
the default value of <code class="code">buffer-invisibility-spec</code>, this is how the
<code class="code">invisible</code> property works.  You should normally use <code class="code">t</code>
as the value of the <code class="code">invisible</code> property if you don&rsquo;t plan
to set <code class="code">buffer-invisibility-spec</code> yourself.
</p>
<p>More generally, you can use the variable <code class="code">buffer-invisibility-spec</code>
to control which values of the <code class="code">invisible</code> property make text
invisible.  This permits you to classify the text into different subsets
in advance, by giving them different <code class="code">invisible</code> values, and
subsequently make various subsets visible or invisible by changing the
value of <code class="code">buffer-invisibility-spec</code>.
</p>
<p>Controlling visibility with <code class="code">buffer-invisibility-spec</code> is
especially useful in a program to display the list of entries in a
database.  It permits the implementation of convenient filtering
commands to view just a part of the entries in the database.  Setting
this variable is very fast, much faster than scanning all the text in
the buffer looking for properties to change.
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-buffer_002dinvisibility_002dspec"><span class="category-def">Variable: </span><span><strong class="def-name">buffer-invisibility-spec</strong><a class="copiable-link" href="#index-buffer_002dinvisibility_002dspec"> &para;</a></span></dt>
<dd><p>This variable specifies which kinds of <code class="code">invisible</code> properties
actually make a character invisible.  Setting this variable makes it
buffer-local.
</p>
<dl class="table">
<dt><code class="code">t</code></dt>
<dd><p>A character is invisible if its <code class="code">invisible</code> property is
non-<code class="code">nil</code>.  This is the default.
</p>
</dd>
<dt>a list</dt>
<dd><p>Each element of the list specifies a criterion for invisibility; if a
character&rsquo;s <code class="code">invisible</code> property fits any one of these criteria,
the character is invisible.  The list can have two kinds of elements:
</p>
<dl class="table">
<dt><code class="code"><var class="var">atom</var></code></dt>
<dd><p>A character is invisible if its <code class="code">invisible</code> property value is
<var class="var">atom</var> or if it is a list with <var class="var">atom</var> as a member; comparison
is done with <code class="code">eq</code>.
</p>
</dd>
<dt><code class="code">(<var class="var">atom</var> . t)</code></dt>
<dd><p>A character is invisible if its <code class="code">invisible</code> property value is
<var class="var">atom</var> or if it is a list with <var class="var">atom</var> as a member; comparison
is done with <code class="code">eq</code>.  Moreover, a sequence of such characters
displays as an ellipsis.
</p></dd>
</dl>
</dd>
</dl>
</dd></dl>

<p>Two functions are specifically provided for adding elements to
<code class="code">buffer-invisibility-spec</code> and removing elements from it.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-add_002dto_002dinvisibility_002dspec"><span class="category-def">Function: </span><span><strong class="def-name">add-to-invisibility-spec</strong> <var class="def-var-arguments">element</var><a class="copiable-link" href="#index-add_002dto_002dinvisibility_002dspec"> &para;</a></span></dt>
<dd><p>This function adds the element <var class="var">element</var> to
<code class="code">buffer-invisibility-spec</code>.  If <code class="code">buffer-invisibility-spec</code>
was <code class="code">t</code>, it changes to a list, <code class="code">(t)</code>, so that text whose
<code class="code">invisible</code> property is <code class="code">t</code> remains invisible.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-remove_002dfrom_002dinvisibility_002dspec"><span class="category-def">Function: </span><span><strong class="def-name">remove-from-invisibility-spec</strong> <var class="def-var-arguments">element</var><a class="copiable-link" href="#index-remove_002dfrom_002dinvisibility_002dspec"> &para;</a></span></dt>
<dd><p>This removes the element <var class="var">element</var> from
<code class="code">buffer-invisibility-spec</code>.  This does nothing if <var class="var">element</var>
is not in the list.
</p></dd></dl>

<p>A convention for use of <code class="code">buffer-invisibility-spec</code> is that a
major mode should use the mode&rsquo;s own name as an element of
<code class="code">buffer-invisibility-spec</code> and as the value of the
<code class="code">invisible</code> property:
</p>
<div class="example">
<pre class="example-preformatted">;; <span class="r">If you want to display an ellipsis:</span>
(add-to-invisibility-spec '(my-symbol . t))
;; <span class="r">If you don&rsquo;t want ellipsis:</span>
(add-to-invisibility-spec 'my-symbol)

(overlay-put (make-overlay beginning end)
             'invisible 'my-symbol)

;; <span class="r">When done with the invisibility:</span>
(remove-from-invisibility-spec '(my-symbol . t))
;; <span class="r">Or respectively:</span>
(remove-from-invisibility-spec 'my-symbol)
</pre></div>

<p>You can check for invisibility using the following function:
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-invisible_002dp"><span class="category-def">Function: </span><span><strong class="def-name">invisible-p</strong> <var class="def-var-arguments">pos-or-prop</var><a class="copiable-link" href="#index-invisible_002dp"> &para;</a></span></dt>
<dd><p>If <var class="var">pos-or-prop</var> is a marker or number, this function returns a
non-<code class="code">nil</code> value if the text at that position is currently
invisible.
</p>
<p>If <var class="var">pos-or-prop</var> is any other kind of Lisp object, that is taken
to mean a possible value of the <code class="code">invisible</code> text or overlay
property.  In that case, this function returns a non-<code class="code">nil</code> value
if that value would cause text to become invisible, based on the
current value of <code class="code">buffer-invisibility-spec</code>.
</p>
<p>The return value of this function is <code class="code">t</code> if the text would be
completely hidden on display, or a non-<code class="code">nil</code>, non-<code class="code">t</code> value
if the text would be replaced by an ellipsis.
</p></dd></dl>

<a class="index-entry-id" id="index-line_002dmove_002dignore_002dinvisible"></a>
<p>Ordinarily, functions that operate on text or move point do not care
whether the text is invisible, they process invisible characters and
visible characters alike.  The user-level line motion commands,
such as <code class="code">next-line</code>, <code class="code">previous-line</code>, ignore invisible
newlines if <code class="code">line-move-ignore-invisible</code> is non-<code class="code">nil</code> (the
default), i.e., behave like these invisible newlines didn&rsquo;t exist in
the buffer, but only because they are explicitly programmed to do so.
</p>
<p>If a command ends with point inside or at the boundary of
invisible text, the main editing loop relocates point to one of the
two ends of the invisible text.  Emacs chooses the direction of
relocation so that it is the same as the overall movement direction of
the command; if in doubt, it prefers a position where an inserted char
would not inherit the <code class="code">invisible</code> property.  Additionally, if the
text is not replaced by an ellipsis and the command only moved within
the invisible text, then point is moved one extra character so as to
try and reflect the command&rsquo;s movement by a visible movement of the
cursor.
</p>
<p>Thus, if the command moved point back to an invisible range (with the usual
stickiness), Emacs moves point back to the beginning of that range.  If the
command moved point forward into an invisible range, Emacs moves point forward
to the first visible character that follows the invisible text and then forward
one more character.
</p>
<p>These <em class="dfn">adjustments</em> of point that ended up in the middle of
invisible text can be disabled by setting <code class="code">disable-point-adjustment</code>
to a non-<code class="code">nil</code> value.  See <a class="xref" href="Adjusting-Point.html">Adjusting Point After Commands</a>.
</p>
<p>Incremental search can make invisible overlays visible temporarily
and/or permanently when a match includes invisible text.  To enable
this, the overlay should have a non-<code class="code">nil</code>
<code class="code">isearch-open-invisible</code> property.  The property value should be a
function to be called with the overlay as an argument.  This function
should make the overlay visible permanently; it is used when the match
overlaps the overlay on exit from the search.
</p>
<p>During the search, such overlays are made temporarily visible by
temporarily modifying their invisible and intangible properties.  If you
want this to be done differently for a certain overlay, give it an
<code class="code">isearch-open-invisible-temporary</code> property which is a function.
The function is called with two arguments: the first is the overlay, and
the second is <code class="code">nil</code> to make the overlay visible, or <code class="code">t</code> to
make it invisible again.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Selective-Display.html">Selective Display</a>, Previous: <a href="Warnings.html">Reporting Warnings</a>, Up: <a href="Display.html">Emacs Display</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
