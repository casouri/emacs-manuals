<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 26.1.

Copyright Â© 1990-1996, 1998-2018 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Text Representations (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Text Representations (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Text Representations (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Non_002dASCII-Characters.html" rel="up" title="Non-ASCII Characters">
<link href="Disabling-Multibyte.html" rel="next" title="Disabling Multibyte">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Text-Representations">
<div class="nav-panel">
<p>
Next: <a href="Disabling-Multibyte.html" accesskey="n" rel="next">Disabling Multibyte Characters</a>, Up: <a href="Non_002dASCII-Characters.html" accesskey="u" rel="up">Non-<abbr class="acronym">ASCII</abbr> Characters</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Text-Representations-1"><span>33.1 Text Representations<a class="copiable-link" href="#Text-Representations-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-text-representation"></a>

<p>Emacs buffers and strings support a large repertoire of characters
from many different scripts, allowing users to type and display text
in almost any known written language.
</p>
<a class="index-entry-id" id="index-character-codepoint"></a>
<a class="index-entry-id" id="index-codespace"></a>
<a class="index-entry-id" id="index-Unicode"></a>
<p>To support this multitude of characters and scripts, Emacs closely
follows the <em class="dfn">Unicode Standard</em>.  The Unicode Standard assigns a
unique number, called a <em class="dfn">codepoint</em>, to each and every character.
The range of codepoints defined by Unicode, or the Unicode
<em class="dfn">codespace</em>, is <code class="code">0..#x10FFFF</code> (in hexadecimal notation),
inclusive.  Emacs extends this range with codepoints in the range
<code class="code">#x110000..#x3FFFFF</code>, which it uses for representing characters
that are not unified with Unicode and <em class="dfn">raw 8-bit bytes</em> that
cannot be interpreted as characters.  Thus, a character codepoint in
Emacs is a 22-bit integer.
</p>
<a class="index-entry-id" id="index-internal-representation-of-characters"></a>
<a class="index-entry-id" id="index-characters_002c-representation-in-buffers-and-strings"></a>
<a class="index-entry-id" id="index-multibyte-text"></a>
<p>To conserve memory, Emacs does not hold fixed-length 22-bit numbers
that are codepoints of text characters within buffers and strings.
Rather, Emacs uses a variable-length internal representation of
characters, that stores each character as a sequence of 1 to 5 8-bit
bytes, depending on the magnitude of its codepoint<a class="footnote" id="DOCF15" href="#FOOT15"><sup>15</sup></a>.  For example, any <abbr class="acronym">ASCII</abbr> character takes up only 1
byte, a Latin-1 character takes up 2 bytes, etc.  We call this
representation of text <em class="dfn">multibyte</em>.
</p>
<p>Outside Emacs, characters can be represented in many different
encodings, such as ISO-8859-1, GB-2312, Big-5, etc.  Emacs converts
between these external encodings and its internal representation, as
appropriate, when it reads text into a buffer or a string, or when it
writes text to a disk file or passes it to some other process.
</p>
<p>Occasionally, Emacs needs to hold and manipulate encoded text or
binary non-text data in its buffers or strings.  For example, when
Emacs visits a file, it first reads the file&rsquo;s text verbatim into a
buffer, and only then converts it to the internal representation.
Before the conversion, the buffer holds encoded text.
</p>
<a class="index-entry-id" id="index-unibyte-text"></a>
<p>Encoded text is not really text, as far as Emacs is concerned, but
rather a sequence of raw 8-bit bytes.  We call buffers and strings
that hold encoded text <em class="dfn">unibyte</em> buffers and strings, because
Emacs treats them as a sequence of individual bytes.  Usually, Emacs
displays unibyte buffers and strings as octal codes such as
<code class="code">\237</code>.  We recommend that you never use unibyte buffers and
strings except for manipulating encoded text or binary non-text data.
</p>
<p>In a buffer, the buffer-local value of the variable
<code class="code">enable-multibyte-characters</code> specifies the representation used.
The representation for a string is determined and recorded in the string
when the string is constructed.
</p>
<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-enable_002dmultibyte_002dcharacters"><span class="category-def">Variable: </span><span><strong class="def-name">enable-multibyte-characters</strong><a class="copiable-link" href="#index-enable_002dmultibyte_002dcharacters"> &para;</a></span></dt>
<dd><p>This variable specifies the current buffer&rsquo;s text representation.
If it is non-<code class="code">nil</code>, the buffer contains multibyte text; otherwise,
it contains unibyte encoded text or binary non-text data.
</p>
<p>You cannot set this variable directly; instead, use the function
<code class="code">set-buffer-multibyte</code> to change a buffer&rsquo;s representation.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-position_002dbytes"><span class="category-def">Function: </span><span><strong class="def-name">position-bytes</strong> <var class="def-var-arguments">position</var><a class="copiable-link" href="#index-position_002dbytes"> &para;</a></span></dt>
<dd><p>Buffer positions are measured in character units.  This function
returns the byte-position corresponding to buffer position
<var class="var">position</var> in the current buffer.  This is 1 at the start of the
buffer, and counts upward in bytes.  If <var class="var">position</var> is out of
range, the value is <code class="code">nil</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-byte_002dto_002dposition"><span class="category-def">Function: </span><span><strong class="def-name">byte-to-position</strong> <var class="def-var-arguments">byte-position</var><a class="copiable-link" href="#index-byte_002dto_002dposition"> &para;</a></span></dt>
<dd><p>Return the buffer position, in character units, corresponding to given
<var class="var">byte-position</var> in the current buffer.  If <var class="var">byte-position</var> is
out of range, the value is <code class="code">nil</code>.  In a multibyte buffer, an
arbitrary value of <var class="var">byte-position</var> can be not at character
boundary, but inside a multibyte sequence representing a single
character; in this case, this function returns the buffer position of
the character whose multibyte sequence includes <var class="var">byte-position</var>.
In other words, the value does not change for all byte positions that
belong to the same character.
</p></dd></dl>

<a class="index-entry-id" id="index-convert-file-byte-to-buffer-position"></a>
<a class="index-entry-id" id="index-convert-buffer-position-to-file-byte"></a>
<p>The following two functions are useful when a Lisp program needs to
map buffer positions to byte offsets in a file visited by the buffer.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-bufferpos_002dto_002dfilepos"><span class="category-def">Function: </span><span><strong class="def-name">bufferpos-to-filepos</strong> <var class="def-var-arguments">position &amp;optional quality coding-system</var><a class="copiable-link" href="#index-bufferpos_002dto_002dfilepos"> &para;</a></span></dt>
<dd><p>This function is similar to <code class="code">position-bytes</code>, but instead of byte
position in the current buffer it returns the offset from the
beginning of the current buffer&rsquo;s file of the byte that corresponds to
the given character <var class="var">position</var> in the buffer.  The conversion
requires to know how the text is encoded in the buffer&rsquo;s file; this is
what the <var class="var">coding-system</var> argument is for, defaulting to the value
of <code class="code">buffer-file-coding-system</code>.  The optional argument
<var class="var">quality</var> specifies how accurate the result should be; it should
be one of the following:
</p>
<dl class="table">
<dt><code class="code">exact</code></dt>
<dd><p>The result must be accurate.  The function may need to encode and
decode a large part of the buffer, which is expensive and can be slow.
</p></dd>
<dt><code class="code">approximate</code></dt>
<dd><p>The value can be an approximation.  The function may avoid expensive
processing and return an inexact result.
</p></dd>
<dt><code class="code">nil</code></dt>
<dd><p>If the exact result needs expensive processing, the function will
return <code class="code">nil</code> rather than an approximation.  This is the default
if the argument is omitted.
</p></dd>
</dl>
</dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-filepos_002dto_002dbufferpos"><span class="category-def">Function: </span><span><strong class="def-name">filepos-to-bufferpos</strong> <var class="def-var-arguments">byte &amp;optional quality coding-system</var><a class="copiable-link" href="#index-filepos_002dto_002dbufferpos"> &para;</a></span></dt>
<dd><p>This function returns the buffer position corresponding to a file
position specified by <var class="var">byte</var>, a zero-base byte offset from the
file&rsquo;s beginning.  The function performs the conversion opposite to
what <code class="code">bufferpos-to-filepos</code> does.  Optional arguments
<var class="var">quality</var> and <var class="var">coding-system</var> have the same meaning and values
as for <code class="code">bufferpos-to-filepos</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-multibyte_002dstring_002dp"><span class="category-def">Function: </span><span><strong class="def-name">multibyte-string-p</strong> <var class="def-var-arguments">string</var><a class="copiable-link" href="#index-multibyte_002dstring_002dp"> &para;</a></span></dt>
<dd><p>Return <code class="code">t</code> if <var class="var">string</var> is a multibyte string, <code class="code">nil</code>
otherwise.  This function also returns <code class="code">nil</code> if <var class="var">string</var> is
some object other than a string.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-string_002dbytes"><span class="category-def">Function: </span><span><strong class="def-name">string-bytes</strong> <var class="def-var-arguments">string</var><a class="copiable-link" href="#index-string_002dbytes"> &para;</a></span></dt>
<dd><a class="index-entry-id" id="index-string_002c-number-of-bytes"></a>
<p>This function returns the number of bytes in <var class="var">string</var>.
If <var class="var">string</var> is a multibyte string, this can be greater than
<code class="code">(length <var class="var">string</var>)</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-unibyte_002dstring"><span class="category-def">Function: </span><span><strong class="def-name">unibyte-string</strong> <var class="def-var-arguments">&amp;rest bytes</var><a class="copiable-link" href="#index-unibyte_002dstring"> &para;</a></span></dt>
<dd><p>This function concatenates all its argument <var class="var">bytes</var> and makes the
result a unibyte string.
</p></dd></dl>

</div>
<div class="footnotes-segment">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT15" href="#DOCF15">(15)</a></h5>
<p>This internal representation is based on one of the encodings defined
by the Unicode Standard, called <em class="dfn">UTF-8</em>, for representing any
Unicode codepoint, but Emacs extends UTF-8 to represent the additional
codepoints it uses for raw 8-bit bytes and characters not unified with
Unicode.</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Disabling-Multibyte.html">Disabling Multibyte Characters</a>, Up: <a href="Non_002dASCII-Characters.html">Non-<abbr class="acronym">ASCII</abbr> Characters</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
