<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 24.3.

Copyright © 1990-1996, 1998-2013 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Active Keymaps (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Active Keymaps (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Active Keymaps (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Keymaps.html" rel="up" title="Keymaps">
<link href="Searching-Keymaps.html" rel="next" title="Searching Keymaps">
<link href="Prefix-Keys.html" rel="prev" title="Prefix Keys">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>


</head>

<body lang="en">
<div class="section-level-extent" id="Active-Keymaps">
<div class="nav-panel">
<p>
Next: <a href="Searching-Keymaps.html" accesskey="n" rel="next">Searching the Active Keymaps</a>, Previous: <a href="Prefix-Keys.html" accesskey="p" rel="prev">Prefix Keys</a>, Up: <a href="Keymaps.html" accesskey="u" rel="up">Keymaps</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Active-Keymaps-1"><span>22.7 Active Keymaps<a class="copiable-link" href="#Active-Keymaps-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-active-keymap"></a>
<a class="index-entry-id" id="index-global-keymap"></a>
<a class="index-entry-id" id="index-local-keymap"></a>

<p>Emacs normally contains many keymaps; at any given time, just a few
of them are <em class="dfn">active</em>, meaning that they participate in the
interpretation of user input.  All the active keymaps are used
together to determine what command to execute when a key is entered.
</p>
<p>Normally the active keymaps are the <code class="code">keymap</code> property keymap,
the keymaps of any enabled minor modes, the current buffer&rsquo;s local
keymap, and the global keymap, in that order.  Emacs searches for each
input key sequence in all these keymaps.  See <a class="xref" href="Searching-Keymaps.html">Searching the Active Keymaps</a>,
for more details of this procedure.
</p>
<p>When the key sequence starts with a mouse event,
the active keymaps are determined based on the
position in that event.  If the event happened on a string embedded
with a <code class="code">display</code>, <code class="code">before-string</code>, or <code class="code">after-string</code>
property (see <a class="pxref" href="Special-Properties.html">Properties with Special Meanings</a>), the non-<code class="code">nil</code> map
properties of the string override those of the buffer (if the
underlying buffer text contains map properties in its text properties
or overlays, they are ignored).
</p>
<p>The <em class="dfn">global keymap</em> holds the bindings of keys that are defined
regardless of the current buffer, such as <kbd class="kbd">C-f</kbd>.  The variable
<code class="code">global-map</code> holds this keymap, which is always active.
</p>
<p>Each buffer may have another keymap, its <em class="dfn">local keymap</em>, which
may contain new or overriding definitions for keys.  The current
buffer&rsquo;s local keymap is always active except when
<code class="code">overriding-local-map</code> overrides it.  The <code class="code">local-map</code> text
or overlay property can specify an alternative local keymap for certain
parts of the buffer; see <a class="ref" href="Special-Properties.html">Properties with Special Meanings</a>.
</p>
<p>Each minor mode can have a keymap; if it does, the keymap is active
when the minor mode is enabled.  Modes for emulation can specify
additional active keymaps through the variable
<code class="code">emulation-mode-map-alists</code>.
</p>
<p>The highest precedence normal keymap comes from the <code class="code">keymap</code>
text or overlay property.  If that is non-<code class="code">nil</code>, it is the first
keymap to be processed, in normal circumstances.  Next comes
any keymap added by the function <code class="code">set-temporary-overlay-map</code>.
See <a class="xref" href="Controlling-Active-Maps.html">Controlling the Active Keymaps</a>.
</p>
<p>However, there are also special ways for programs to substitute
other keymaps for some of those.  The variable
<code class="code">overriding-local-map</code>, if non-<code class="code">nil</code>, specifies a keymap
that replaces all the usual active keymaps except the global keymap.
Another way to do this is with <code class="code">overriding-terminal-local-map</code>;
it operates on a per-terminal basis.  These variables are documented
below.
</p>
<a class="index-entry-id" id="index-major-mode-keymap"></a>
<p>Since every buffer that uses the same major mode normally uses the
same local keymap, you can think of the keymap as local to the mode.  A
change to the local keymap of a buffer (using <code class="code">local-set-key</code>, for
example) is seen also in the other buffers that share that keymap.
</p>
<p>The local keymaps that are used for Lisp mode and some other major
modes exist even if they have not yet been used.  These local keymaps are
the values of variables such as <code class="code">lisp-mode-map</code>.  For most major
modes, which are less frequently used, the local keymap is constructed
only when the mode is used for the first time in a session.
</p>
<p>The minibuffer has local keymaps, too; they contain various completion
and exit commands.  See <a class="xref" href="Intro-to-Minibuffers.html">Introduction to Minibuffers</a>.
</p>
<p>Emacs has other keymaps that are used in a different way&mdash;translating
events within <code class="code">read-key-sequence</code>.  See <a class="xref" href="Translation-Keymaps.html">Keymaps for Translating Sequences of Events</a>.
</p>
<p>See <a class="xref" href="Standard-Keymaps.html">Standard Keymaps</a>, for a list of some standard keymaps.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-current_002dactive_002dmaps"><span class="category-def">Function: </span><span><strong class="def-name">current-active-maps</strong> <var class="def-var-arguments">&amp;optional olp position</var><a class="copiable-link" href="#index-current_002dactive_002dmaps"> &para;</a></span></dt>
<dd><p>This returns the list of active keymaps that would be used by the
command loop in the current circumstances to look up a key sequence.
Normally it ignores <code class="code">overriding-local-map</code> and
<code class="code">overriding-terminal-local-map</code>, but if <var class="var">olp</var> is non-<code class="code">nil</code>
then it pays attention to them.  <var class="var">position</var> can optionally be either
an event position as returned by <code class="code">event-start</code> or a buffer
position, and may change the keymaps as described for
<code class="code">key-binding</code>.
</p></dd></dl>

<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-key_002dbinding"><span class="category-def">Function: </span><span><strong class="def-name">key-binding</strong> <var class="def-var-arguments">key &amp;optional accept-defaults no-remap position</var><a class="copiable-link" href="#index-key_002dbinding"> &para;</a></span></dt>
<dd><p>This function returns the binding for <var class="var">key</var> according to the
current active keymaps.  The result is <code class="code">nil</code> if <var class="var">key</var> is
undefined in the keymaps.
</p>
<p>The argument <var class="var">accept-defaults</var> controls checking for default
bindings, as in <code class="code">lookup-key</code> (see <a class="pxref" href="Functions-for-Key-Lookup.html">Functions for Key Lookup</a>).
</p>
<p>When commands are remapped (see <a class="pxref" href="Remapping-Commands.html">Remapping Commands</a>),
<code class="code">key-binding</code> normally processes command remappings so as to
return the remapped command that will actually be executed.  However,
if <var class="var">no-remap</var> is non-<code class="code">nil</code>, <code class="code">key-binding</code> ignores
remappings and returns the binding directly specified for <var class="var">key</var>.
</p>
<p>If <var class="var">key</var> starts with a mouse event (perhaps following a prefix
event), the maps to be consulted are determined based on the event&rsquo;s
position.  Otherwise, they are determined based on the value of point.
However, you can override either of them by specifying <var class="var">position</var>.
If <var class="var">position</var> is non-<code class="code">nil</code>, it should be either a buffer
position or an event position like the value of <code class="code">event-start</code>.
Then the maps consulted are determined based on <var class="var">position</var>.
</p>
<p>An error is signaled if <var class="var">key</var> is not a string or a vector.
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">(key-binding &quot;\C-x\C-f&quot;)
    &rArr; find-file
</pre></div></div>
</dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Searching-Keymaps.html">Searching the Active Keymaps</a>, Previous: <a href="Prefix-Keys.html">Prefix Keys</a>, Up: <a href="Keymaps.html">Keymaps</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
