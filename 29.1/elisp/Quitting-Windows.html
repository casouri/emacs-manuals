<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 29.1.

Copyright Â© 1990-1996, 1998-2023 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Quitting Windows (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Quitting Windows (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Quitting Windows (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Windows.html" rel="up" title="Windows">
<link href="Side-Windows.html" rel="next" title="Side Windows">
<link href="Dedicated-Windows.html" rel="prev" title="Dedicated Windows">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Quitting-Windows">
<div class="nav-panel">
<p>
Next: <a href="Side-Windows.html" accesskey="n" rel="next">Side Windows</a>, Previous: <a href="Dedicated-Windows.html" accesskey="p" rel="prev">Dedicated Windows</a>, Up: <a href="Windows.html" accesskey="u" rel="up">Windows</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Quitting-Windows-1"><span>29.16 Quitting Windows<a class="copiable-link" href="#Quitting-Windows-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-quitting-windows"></a>

<p>After a command uses <code class="code">display-buffer</code> to put a buffer on the
screen, the user may decide to hide it and return to the previous
configuration of the Emacs display.  We call that <em class="dfn">quitting the
window</em>.  The way to do this is to call <code class="code">quit-window</code> while the
window used by <code class="code">display-buffer</code> is the selected window.
</p>
<p>The right way to restore the previous configuration of the display
depends on what was done to the window where the buffer now appears.
It might be right to delete that window, or delete its frame, or just
display another buffer in that window.  One complication is that the
user may have changed the window configuration since the act of
displaying that buffer, and it would be undesirable to undo the user&rsquo;s
explicitly requested changes.
</p>
<p>To enable <code class="code">quit-window</code> to do the right thing,
<code class="code">display-buffer</code> saves information about what it did in the
window&rsquo;s <code class="code">quit-restore</code> parameter (see <a class="pxref" href="Window-Parameters.html">Window Parameters</a>).
</p>
<dl class="first-deffn">
<dt class="deffn" id="index-quit_002dwindow"><span class="category-def">Command: </span><span><strong class="def-name">quit-window</strong> <var class="def-var-arguments">&amp;optional kill window</var><a class="copiable-link" href="#index-quit_002dwindow"> &para;</a></span></dt>
<dd><p>This command quits <var class="var">window</var> and buries its buffer.  The argument
<var class="var">window</var> must be a live window and defaults to the selected one.
With prefix argument <var class="var">kill</var> non-<code class="code">nil</code>, it kills the buffer
instead of burying it.
</p>
<a class="index-entry-id" id="index-quit_002dwindow_002dhook"></a>
<p>The function <code class="code">quit-window</code> first runs <code class="code">quit-window-hook</code>.
Then it calls the function <code class="code">quit-restore-window</code>, described next,
which does the hard work.
</p></dd></dl>

<p>You can get more control by calling <code class="code">quit-restore-window</code> instead.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-quit_002drestore_002dwindow"><span class="category-def">Function: </span><span><strong class="def-name">quit-restore-window</strong> <var class="def-var-arguments">&amp;optional window bury-or-kill</var><a class="copiable-link" href="#index-quit_002drestore_002dwindow"> &para;</a></span></dt>
<dd><p>This function handles <var class="var">window</var> and its buffer after quitting.  The
optional argument <var class="var">window</var> must be a live window and defaults to
the selected one.  The function takes account of the <var class="var">window</var>&rsquo;s
<code class="code">quit-restore</code> parameter.
</p>
<p>The optional argument <var class="var">bury-or-kill</var> specifies how to deal with
<var class="var">window</var>&rsquo;s buffer.  The following values are meaningful:
</p>
<dl class="table">
<dt><code class="code">nil</code></dt>
<dd><p>This means to not deal with the buffer in any particular way.  As a
consequence, if <var class="var">window</var> is not deleted, invoking
<code class="code">switch-to-prev-buffer</code> will usually show the buffer again.
</p>
</dd>
<dt><code class="code">append</code></dt>
<dd><p>This means that if <var class="var">window</var> is not deleted, its buffer is moved to
the end of <var class="var">window</var>&rsquo;s list of previous buffers (see <a class="pxref" href="Window-History.html">Window History</a>), so it&rsquo;s less likely that future invocations of
<code class="code">switch-to-prev-buffer</code> will switch to it.  Also, it moves the
buffer to the end of the frame&rsquo;s buffer list (see <a class="pxref" href="Buffer-List.html">The Buffer List</a>).
</p>
</dd>
<dt><code class="code">bury</code></dt>
<dd><p>This means that if <var class="var">window</var> is not deleted, its buffer is removed
from <var class="var">window</var>&rsquo;s list of previous buffers.  Also, it moves the
buffer to the end of the frame&rsquo;s buffer list.  This is the most
reliable way to prevent <code class="code">switch-to-prev-buffer</code> from switching to
this buffer again, short of killing the buffer.
</p>
</dd>
<dt><code class="code">kill</code></dt>
<dd><p>This means to kill <var class="var">window</var>&rsquo;s buffer.
</p></dd>
</dl>

<p>The argument <var class="var">bury-or-kill</var> also specifies what to do with
<var class="var">window</var>&rsquo;s frame when <var class="var">window</var> should be deleted, if it is the
only window on its frame, and there are other frames on that frame&rsquo;s
terminal.  If <var class="var">bury-or-kill</var> equals <code class="code">kill</code>, it means to
delete the frame.  Otherwise, the fate of the frame is determined by
calling <code class="code">frame-auto-hide-function</code> (see below) with that frame as
sole argument.
</p>
<p>This function always sets <var class="var">window</var>&rsquo;s <code class="code">quit-restore</code> parameter
to <code class="code">nil</code> unless it deletes the window.
</p></dd></dl>

<p>The window <var class="var">window</var>&rsquo;s <code class="code">quit-restore</code> parameter (see <a class="pxref" href="Window-Parameters.html">Window Parameters</a>) should be <code class="code">nil</code> or a list of four elements:
</p>
<div class="example lisp">
<pre class="lisp-preformatted">(<var class="var">method</var> <var class="var">obuffer</var> <var class="var">owindow</var> <var class="var">this-buffer</var>)
</pre></div>

<p>The first element, <var class="var">method</var>, is one of the four symbols
<code class="code">window</code>, <code class="code">frame</code>, <code class="code">same</code> and <code class="code">other</code>.
<code class="code">frame</code> and <code class="code">window</code> control how to delete <var class="var">window</var>,
while <code class="code">same</code> and <code class="code">other</code> control displaying some other
buffer in it.
</p>
<p>Specifically, <code class="code">window</code> means that the window has been specially
created by <code class="code">display-buffer</code>; <code class="code">frame</code> means that a separate
frame has been created; <code class="code">same</code>, that the window has only ever
displayed this buffer; <code class="code">other</code>, that the window showed another
buffer before.
</p>
<p>The second element, <var class="var">obuffer</var>, is either one of the symbols
<code class="code">window</code> or <code class="code">frame</code>, or a list of the form
</p>
<div class="example lisp">
<pre class="lisp-preformatted">(<var class="var">prev-buffer</var> <var class="var">prev-window-start</var> <var class="var">prev-window-point</var> <var class="var">height</var>)
</pre></div>

<p>which says which buffer was shown in <var class="var">window</var> before, that
buffer&rsquo;s window start (see <a class="pxref" href="Window-Start-and-End.html">The Window Start and End Positions</a>) and window point
(see <a class="pxref" href="Window-Point.html">Windows and Point</a>) positions at that time, and
<var class="var">window</var>&rsquo;s height at that time.  If <var class="var">prev-buffer</var> is still
live when quitting <var class="var">window</var>, quitting the window may reuse
<var class="var">window</var> to display <var class="var">prev-buffer</var>.
</p>
<p>The third element, <var class="var">owindow</var>, is the window that was selected
just before the displaying was done.  If quitting deletes
<var class="var">window</var>, it tries to select <var class="var">owindow</var>.
</p>
<p>The fourth element, <var class="var">this-buffer</var>, is the buffer whose displaying
set the <code class="code">quit-restore</code> parameter.  Quitting <var class="var">window</var> may delete
that window only if it still shows that buffer.
</p>
<p>Quitting <var class="var">window</var> tries to delete it if and only if (1)
<var class="var">method</var> is either <code class="code">window</code> or <code class="code">frame</code>, (2) the window
has no history of previously-displayed buffers and (3)
<var class="var">this-buffer</var> equals the buffer currently displayed in
<var class="var">window</var>.  If <var class="var">window</var> is part of an atomic window
(see <a class="pxref" href="Atomic-Windows.html">Atomic Windows</a>), quitting will try to delete the root of that
atomic window instead.  In either case, it tries to avoid signaling an
error when <var class="var">window</var> cannot be deleted.
</p>
<p>If <var class="var">obuffer</var> is a list, and <var class="var">prev-buffer</var> is still live,
quitting displays <var class="var">prev-buffer</var> in <var class="var">window</var> according to the
rest of the elements of <var class="var">obuffer</var>.  This includes resizing the
window to <var class="var">height</var> if it was temporarily resized to display
<var class="var">this-buffer</var>.
</p>
<p>Otherwise, if <var class="var">window</var> was previously used for displaying other
buffers (see <a class="pxref" href="Window-History.html">Window History</a>), the most recent buffer in that
history will be displayed.
</p>

<p>The following option specifies a function to do the right thing with a
frame containing one window when quitting that window.
</p>
<dl class="first-defvr first-defopt-alias-first-defvr">
<dt class="defvr defopt-alias-defvr" id="index-frame_002dauto_002dhide_002dfunction"><span class="category-def">User Option: </span><span><strong class="def-name">frame-auto-hide-function</strong><a class="copiable-link" href="#index-frame_002dauto_002dhide_002dfunction"> &para;</a></span></dt>
<dd><p>The function specified by this option is called to automatically hide
frames.  This function is called with one argument&mdash;a frame.
</p>
<p>The function specified here is called by <code class="code">bury-buffer</code>
(see <a class="pxref" href="Buffer-List.html">The Buffer List</a>) when the selected window is dedicated and shows
the buffer to bury.  It is also called by <code class="code">quit-restore-window</code>
(see above) when the frame of the window to quit has been specially
created for displaying that window&rsquo;s buffer and the buffer is not
killed.
</p>
<p>The default is to call <code class="code">iconify-frame</code> (see <a class="pxref" href="Visibility-of-Frames.html">Visibility of Frames</a>).  Alternatively, you may specify either <code class="code">delete-frame</code>
(see <a class="pxref" href="Deleting-Frames.html">Deleting Frames</a>) to remove the frame from its display,
<code class="code">make-frame-invisible</code> to make the frame invisible, <code class="code">ignore</code>
to leave the frame unchanged, or any other function that can take a
frame as its sole argument.
</p>
<p>Note that the function specified by this option is called only if the
specified frame contains just one live window and there is at least one
other frame on the same terminal.
</p>
<p>For a particular frame, the value specified here may be overridden by
that frame&rsquo;s <code class="code">auto-hide-function</code> frame parameter (see <a class="pxref" href="Frame-Interaction-Parameters.html">Frame Interaction Parameters</a>).
</p></dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Side-Windows.html">Side Windows</a>, Previous: <a href="Dedicated-Windows.html">Dedicated Windows</a>, Up: <a href="Windows.html">Windows</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
