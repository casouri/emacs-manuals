<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.2.

Copyright Â© 1990-1996, 1998-2021 Free Software Foundation,
Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<title>Pure Storage (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Pure Storage (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Pure Storage (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="GNU-Emacs-Internals.html" rel="up" title="GNU Emacs Internals">
<link href="Garbage-Collection.html" rel="next" title="Garbage Collection">
<link href="Building-Emacs.html" rel="prev" title="Building Emacs">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
span:hover a.copiable-link {visibility: visible}
strong.def-name {font-family: monospace; font-weight: bold; font-size: larger}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<div class="section-level-extent" id="Pure-Storage">
<div class="nav-panel">
<p>
Next: <a href="Garbage-Collection.html" accesskey="n" rel="next">Garbage Collection</a>, Previous: <a href="Building-Emacs.html" accesskey="p" rel="prev">Building Emacs</a>, Up: <a href="GNU-Emacs-Internals.html" accesskey="u" rel="up">GNU Emacs Internals</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Pure-Storage-1"><span>E.2 Pure Storage<a class="copiable-link" href="#Pure-Storage-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-pure-storage"></a>

<p>Emacs Lisp uses two kinds of storage for user-created Lisp objects:
<em class="dfn">normal storage</em> and <em class="dfn">pure storage</em>.  Normal storage is where
all the new data created during an Emacs session are kept
(see <a class="pxref" href="Garbage-Collection.html">Garbage Collection</a>).  Pure storage is used for certain data
in the preloaded standard Lisp files&mdash;data that should never change
during actual use of Emacs.
</p>
<p>Pure storage is allocated only while <code class="command">temacs</code> is loading the
standard preloaded Lisp libraries.  In the file <samp class="file">emacs</samp>, it is
marked as read-only (on operating systems that permit this), so that
the memory space can be shared by all the Emacs jobs running on the
machine at once.  Pure storage is not expandable; a fixed amount is
allocated when Emacs is compiled, and if that is not sufficient for
the preloaded libraries, <samp class="file">temacs</samp> allocates dynamic memory for
the part that didn&rsquo;t fit.  If Emacs will be dumped using the
<code class="code">pdump</code> method (see <a class="pxref" href="Building-Emacs.html">Building Emacs</a>), the pure-space overflow
is of no special importance (it just means some of the preloaded stuff
cannot be shared with other Emacs jobs).  However, if Emacs will be
dumped using the now obsolete <code class="code">unexec</code> method, the resulting
image will work, but garbage collection (see <a class="pxref" href="Garbage-Collection.html">Garbage Collection</a>)
is disabled in this situation, causing a memory leak.  Such an
overflow normally won&rsquo;t happen unless you try to preload additional
libraries or add features to the standard ones.  Emacs will display a
warning about the overflow when it starts, if it was dumped using
<code class="code">unexec</code>.  If this happens, you should increase the compilation
parameter <code class="code">SYSTEM_PURESIZE_EXTRA</code> in the file
<samp class="file">src/puresize.h</samp> and rebuild Emacs.
</p>
<dl class="first-deffn first-defun-alias-first-deffn">
<dt class="deffn defun-alias-deffn" id="index-purecopy"><span class="category-def">Function: </span><span><strong class="def-name">purecopy</strong> <var class="def-var-arguments">object</var><a class="copiable-link" href="#index-purecopy"> &para;</a></span></dt>
<dd><p>This function makes a copy in pure storage of <var class="var">object</var>, and returns
it.  It copies a string by simply making a new string with the same
characters, but without text properties, in pure storage.  It
recursively copies the contents of vectors and cons cells.  It does
not make copies of other objects such as symbols, but just returns
them unchanged.  It signals an error if asked to copy markers.
</p>
<p>This function is a no-op except while Emacs is being built and dumped;
it is usually called only in preloaded Lisp files.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-pure_002dbytes_002dused"><span class="category-def">Variable: </span><span><strong class="def-name">pure-bytes-used</strong><a class="copiable-link" href="#index-pure_002dbytes_002dused"> &para;</a></span></dt>
<dd><p>The value of this variable is the number of bytes of pure storage
allocated so far.  Typically, in a dumped Emacs, this number is very
close to the total amount of pure storage available&mdash;if it were not,
we would preallocate less.
</p></dd></dl>

<dl class="first-defvr first-defvar-alias-first-defvr">
<dt class="defvr defvar-alias-defvr" id="index-purify_002dflag"><span class="category-def">Variable: </span><span><strong class="def-name">purify-flag</strong><a class="copiable-link" href="#index-purify_002dflag"> &para;</a></span></dt>
<dd><p>This variable determines whether <code class="code">defun</code> should make a copy of the
function definition in pure storage.  If it is non-<code class="code">nil</code>, then the
function definition is copied into pure storage.
</p>
<p>This flag is <code class="code">t</code> while loading all of the basic functions for
building Emacs initially (allowing those functions to be shareable and
non-collectible).  Dumping Emacs as an executable always writes
<code class="code">nil</code> in this variable, regardless of the value it actually has
before and after dumping.
</p>
<p>You should not change this flag in a running Emacs.
</p></dd></dl>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Garbage-Collection.html">Garbage Collection</a>, Previous: <a href="Building-Emacs.html">Building Emacs</a>, Up: <a href="GNU-Emacs-Internals.html">GNU Emacs Internals</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
